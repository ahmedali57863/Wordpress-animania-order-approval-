const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./TableContainer-1.0.35-BaHCfHCa.js","./cm-1.0.35--NMEhA6K.js","./redux-1.0.35-xa1uZ5t4.js","./vendor-1.0.35-CN03Eozo.js","./AdminTheme-1.0.35-BtyHaBRh.js","./Typography-1.0.35-DmbWmVEH.js","./lib-1.0.35-vCbYWOI3.js","./loglevel-1.0.35-BZ7XahX3.js","./lodash-1.0.35-CNe2eGU5.js","./moment-1.0.35-C5S46NFB.js","./useEnhancedEffect-1.0.35-gtlBTowv.js","./main-1.0.35.js","./notistack-1.0.35-C7EWtXAA.js","./tanstack-1.0.35-wJk0lVz7.js","./FallbackSpinner-1.0.35-CzYFJIrC.js","./Spinner-1.0.35-Dd1TcgqP.js","./RestApi-1.0.35-Bt-tzntO.js","./ActionsSettings-1.0.35-B25TLnTF.js","./TargetEnum-1.0.35-DPFnTxiX.js","./ConfirmDialog-1.0.35-5-r3Xts8.js","./iconBase-1.0.35-CEh1aNes.js","./cjs-1.0.35-B75n3jry.js","./DialogContent-1.0.35-B5TpMgZC.js","./ConfirmDialog-1.0.35--D4jr2go.css","./ScopeEnum-1.0.35-B4DDvIDj.js","./index-1.0.35-BtMPEpn4.js","./TabPanel-1.0.35-CQEcgw4y.js","./useTableUpdater-1.0.35-Du0YkN1k.js","./settings-1.0.35-CRkkJAih.js","./Menu-1.0.35-3APgaaPr.js","./MenuItem-1.0.35-DJ1Zxsyh.js","./settings-1.0.35-Bx2jvYL6.css","./useTheme-1.0.35-DvysJ9Pk.js","./index-1.0.35-CCys4hnd.js","./Row-1.0.35-DC9FFJYs.js","./useStoreTable-1.0.35-BoSxKhPI.js","./ActionsDml-1.0.35-BvngWXxi.js","./useScreenSize-1.0.35-D9QB3bUJ.js","./dompurify-1.0.35-DhD2mIk-.js","./Tooltip-1.0.35-DvHLxZ2q.js","./useControlled-1.0.35-Cu7qahuZ.js","./Popper-1.0.35-BZjTWtMm.js","./Alert-1.0.35-CqUFZJNz.js","./AlertTitle-1.0.35-t_Cdy-a_.js","./createSvgIcon-1.0.35-C47rBL-a.js","./Close-1.0.35-D-owgKS4.js","./Settings-1.0.35-HFJmJU1l.js","./useFormStore-1.0.35-TLrcUzfK.js","./TableChartDock-1.0.35-C4FS5jUK.js","./Chart-1.0.35-BfkC_RH6.js"])))=>i.map(i=>d[i]);
import{j as t}from"./cm-1.0.35--NMEhA6K.js";import{_ as ee}from"./main-1.0.35.js";import{r as i}from"./redux-1.0.35-xa1uZ5t4.js";import{l as r,K as P,P as $t,L as ft,v as Gt,M as Jt,N as de,S as I,O as Ee,Q as Qt,T as Ie,U as et,V as me,W as Xt,X as ye,Y as Ce,Z as gt,_ as fe,$ as qt,A as Fe,a0 as ge,a1 as xt,b as Zt,a2 as Se,a3 as tt,a4 as Kt,a5 as It,d as en,a6 as tn,a7 as nn,a8 as sn,a9 as rn,aa as on}from"./lib-1.0.35-vCbYWOI3.js";import{u as te,a as ht}from"./RestApi-1.0.35-Bt-tzntO.js";import{B as M,S as Me}from"./Spinner-1.0.35-Dd1TcgqP.js";import{a as ln,T as pt}from"./AdminTheme-1.0.35-BtyHaBRh.js";import{u as we}from"./useStoreTable-1.0.35-BoSxKhPI.js";import{s as an,u as nt,i as st}from"./ActionsDml-1.0.35-BvngWXxi.js";import{e as w}from"./notistack-1.0.35-C7EWtXAA.js";import{u as Oe,a as ke,A as cn,r as un,b as _t,c as he,d as jt,R as dn,C as mn,e as fn,D as J,B as gn,f as xn,g as hn,h as pn}from"./useTheme-1.0.35-DvysJ9Pk.js";import"./moment-1.0.35-C5S46NFB.js";import{G as _n,A as bt,T as Tt,H as rt,I as ot,B as ie,e as Et,M as yt,F as jn}from"./cjs-1.0.35-B75n3jry.js";import{u as bn}from"./useScreenSize-1.0.35-D9QB3bUJ.js";import"./dompurify-1.0.35-DhD2mIk-.js";import{g as Tn}from"./vendor-1.0.35-CN03Eozo.js";import{P as it,I as ue}from"./iconBase-1.0.35-CEh1aNes.js";import{F as ve}from"./FallbackSpinner-1.0.35-CzYFJIrC.js";import{T as lt}from"./Tooltip-1.0.35-DvHLxZ2q.js";const Re=e=>{const o=te(f=>{var c,p;return(p=(c=f.forms[e])==null?void 0:c.state)==null?void 0:p.data});return r.debug("data",o,e),o};var pe=(e=>(e[e.SELECT=0]="SELECT",e[e.INSERT=1]="INSERT",e[e.UPDATE=2]="UPDATE",e[e.DELETE=3]="DELETE",e[e.EXPORT=4]="EXPORT",e[e.IMPORT=5]="IMPORT",e[e.VIEW=6]="VIEW",e))(pe||{});i.lazy(()=>ee(()=>import("./TableContainer-1.0.35-BaHCfHCa.js").then(e=>e.T),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33]),import.meta.url));i.lazy(()=>ee(()=>import("./TableContainer-1.0.35-BaHCfHCa.js").then(e=>e.T),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33]),import.meta.url));const vt=e=>4,En=e=>{const o=te(f=>{var c;return((c=f.forms[e])==null?void 0:c.columns)??[]});return r.debug("storeColumns",o),o},at=e=>{const o=te(f=>f.forms[e]!==void 0?f.forms[e].columns.filter(c=>c.more).length>0:!1);return r.debug("hasMoreColumns",o),o},yn=e=>{const o=te(f=>{var c,p;return((p=(c=f.forms[e])==null?void 0:c.state)==null?void 0:p.more)??!1});return r.debug("moreState",o),o},vn=e=>{const o=te(f=>{var c,p;return(p=(c=f.forms[e])==null?void 0:c.state)==null?void 0:p.initialData});return r.debug("initialData",o),o},Fn=i.lazy(()=>ee(()=>import("./Row-1.0.35-DC9FFJYs.js"),__vite__mapDeps([34,11,1,2,3,12,6,7,8,9,16,32,33,5,21,20,10,15,4,35,36,37,38,14,39,40,41]),import.meta.url)),Sn=({appId:e,metaData:o,primaryKey:f,formMode:c,formUuid:p})=>{var a;r.debug(e,o,f,c,p);const C=ke(),O=Oe(e),j=Re(e),v=vn(e),[d,H]=i.useState("30px");return i.useEffect(()=>{},[C.spacing]),t.jsx("form",{id:p,className:"pp-form-content",onSubmit:k=>(k.preventDefault(),!1),children:t.jsx(M,{className:"pp-form-grid",sx:{display:"grid",gridTemplateColumns:{lg:`repeat(${C.cellsPerRow}, 1fr)`,md:"repeat("+Math.min(C.cellsPerRow,2)+", 1fr)",xs:"1fr"},gap:d,marginBottom:0,background:C.showGrid?((a=cn)==null?void 0:a.palette.mode)===$t.LIGHT?"repeating-linear-gradient( -45deg, transparent, transparent 10px, #eee 10px, #eee 20px )":"repeating-linear-gradient( -45deg, transparent, transparent 10px, #111 10px, #111 20px )":"","& p.MuiFormHelperText-root":{...c===P.VIEW&&!0&&{display:"none"}}},children:t.jsx(i.Suspense,{fallback:t.jsx(Me,{}),children:t.jsx(Fn,{appId:e,metaData:o,data:j,initialData:v,primaryKey:f,formMode:c,formSettings:C,language:O.language})})})})},Rn=e=>({}),Cn=e=>{const o=te(f=>{var c,p;return((p=(c=f.forms[e])==null?void 0:c.state)==null?void 0:p.m2mUpdate)??!1});return r.debug("m2mUpdate",o),o},Mn=({code:e,safeMode:o,isExpression:f,args:c})=>{const p=ft(e,o,f,c);return window.jQuery&&p instanceof window.jQuery&&p.html(),null};var wn=un();const xe=Tn(wn),ct=i.lazy(()=>ee(()=>import("./Alert-1.0.35-CqUFZJNz.js"),__vite__mapDeps([42,1,2,3,25,20,5,6,7,8,9,10,43,44,45]),import.meta.url)),ut=({appId:e,primaryKey:o,formMode:f,showTable:c,showForm:p,detailKey:C,children:O,relationAppId:j,relTab:v,joinTab:d,isEmbedded:H,masterAppId:a,isModal:k})=>{var He,We,Ye,ze,$e,Ge;r.debug(e,o,f,C,j,v,d,H,a,k);const T=ht(),ne=i.useRef(null),Q=En(e),b=_t(e),Y=vt(),U=we(e),D=Rn(),X=Oe(e),[z,$]=i.useState(f),A=i.useMemo(()=>Gt(),[]),[se,G]=i.useState(!1),[q,_e]=i.useState(""),s=he(e),Z=Re(e),u=Jt((He=s==null?void 0:s.app)==null?void 0:He.container[0]),R=Cn(e),N=he(a??""),le=Re(a??""),ae=jt(e),[je,be]=i.useState(null);i.useEffect(()=>{r.debug(R,e),R===!0&&(r.debug("setM2MUpdate: false"),ce(!1,()=>{},()=>{},()=>{T(Ie({appId:e,update:!1}))}))},[R]),i.useEffect(()=>{o===null?St():Object.keys(o).length>0?Ft():G(!0)},[o]);const Ft=()=>{an(e,o,s==null?void 0:s.media,n=>{if(r.debug(n),(n==null?void 0:n.code)==="ok"){if(Array.isArray(n.data)&&n.data.length>0){const m={...n.data[0]},_={...n.context};delete _.debug,T(Ee({appId:e,data:m,context:_})),n.data.length>1?be("Query returned more than one row. Check configuration."):be(null)}else{const m={...n.context};delete m.debug,T(Ee({appId:e,data:{},context:m})),be("Invalid primary key. Check configuration.")}G(!0)}else w(b.invalidResponse,{variant:"error"})},n=>{r.error("error",n),_e(n??b.invalidResponse)},!1,v)},St=()=>{var n,m;if(s.columns&&Array.isArray(s.columns)){const _={},y=de.getSelectors().selectFormColumns(I.getState().forms,e),l=Object.fromEntries(y.map(h=>[h.columnName,h.defaultValue]));r.debug("defaultValues",l);for(let h=0;h<s.columns.length;h++)_[s.columns[h].column_name]=null,l[s.columns[h].column_name]!==void 0&&(l[s.columns[h].column_name]==="@wpda_wp_user_id"?_[s.columns[h].column_name]=(m=(n=s==null?void 0:s.settings)==null?void 0:n.env)==null?void 0:m.id:l[s.columns[h].column_name]==="@now"?s.columns[h]==="date"?_[s.columns[h].column_name]=xe(Date.now()).format("YYYY-MM-DD"):_[s.columns[h].column_name]=xe(Date.now()).format("YYYY-MM-DD HH:mm:ss"):s.columns[h].column_default!==null&&s.columns[h].column_default!=="NULL"&&s.columns[h].column_default!==""?s.columns[h].column_default==="CURRENT_TIMESTAMP"?s.columns[h]==="date"?_[s.columns[h].column_name]=xe(Date.now()).format("YYYY-MM-DD"):_[s.columns[h].column_name]=xe(Date.now()).format("YYYY-MM-DD HH:mm:ss"):_[s.columns[h].column_name]=s.columns[h].column_default:_[s.columns[h].column_name]=l[s.columns[h].column_name]);r.debug(_),T(Ee({appId:e,data:_,context:{media:{}}})),r.debug("init"),G(!0)}},Ne=()=>{let n="";for(const m in s.columns)s.columns[m].extra==="auto_increment"&&(n=s.columns[m].column_name);return r.debug(n),n},Le=n=>{var h;const m=(h=de.getSelectors().selectFormState(I.getState().forms,e))==null?void 0:h.validation;r.debug("rowValidation",m);let _=!1;for(const g in m)if(m[g].error===!0&&m[g].type===me.COLUMN){_=!0;break}if(_)return r.debug("validateForm returned errors"),!1;let y=!0;const l=Ne();for(const g in n){const x=Xt(s,g);let F=!0;x.column_name!==l&&x.is_nullable==="NO"&&(n[g]===null||n[g]==="")&&(f===P.UPDATE||f===P.INSERT&&(x.column_default===null||x.column_default==="NULL"||x.column_default==="")||Pe.preserveSpacesOnUpdate===!1&&n[g]==="")&&(T(ye({appId:e,columnName:g,columnError:!0,columnText:b.mandatoryField,columnType:me.FORM})),F=!1,y=!1);const S=de.getSelectors().selectFormColumns(I.getState().forms,e);let V;for(let E=0;E<S.length;E++)S[E].columnName===g&&(V=S[E]);if(r.debug(V),F&&x.data_type==="time"){const E=n[g];if(E.length===6){let B=E.substring(2,3),L=E.substring(4,5);(Number(B)>5||Number(L)>5)&&(T(ye({appId:e,columnName:g,columnError:!0,columnText:b.mandatoryField,columnType:me.FORM})),F=!1,y=!1)}}F&&T(ye({appId:e,columnName:g,columnError:!1,columnText:"",columnType:me.FORM}))}return y},ce=(n,m,_,y)=>{var h;const l=(h=de.getSelectors().selectFormState(I.getState().forms,e))==null?void 0:h.data;if(r.debug(l),Le(l)){if(o!==null){const g={};Object.keys(l).map(x=>{Q.map(F=>{x===F.columnName&&F.updatable&&(g[x]=l[x])})}),r.debug(g),nt(e,o,g,x=>{var F;if(r.debug(x),x!=null&&x.code&&(x!=null&&x.message))switch(x.code){case"ok":w(b.updatedSuccessful,{variant:"success"}),((F=x.context)==null?void 0:F.updated)!==void 0&&Object.keys(x.context.updated).map(S=>{T(tt({appId:e,columnName:S,columnValue:x.context.updated[S]}))}),n&&(m!==void 0&&m(o),setTimeout(()=>{c(!0,j)},1e3)),y&&y();break;case"info":w(b.nothingToUpdate,{variant:"info"}),n&&(m!==void 0&&m(o),setTimeout(()=>{c(!0,j)},1e3)),y&&y();break;default:r.error(x),w(x.message??b.invalidResponse,{variant:"error"}),n&&c(!0,j)}else r.error(x),w(b.invalidResponse,{variant:"error"})},x=>{r.error("error",x),w(x??b.invalidResponse,{variant:"error"})},!1,d,v)}else T(Qt({appId:e,property:{isRowCountUpdated:!0}})),st(e,l,g=>{if(r.debug(g),g!=null&&g.code&&(g!=null&&g.message)){let x;const F={};switch(g.code){case"ok":w(b.insertSuccessful,{variant:"success"}),x=Ne();for(let S=0;S<s.primary_key.length;S++){const V=Kt(s,s.primary_key[S]);let E;V!==void 0&&(E=s==null?void 0:s.columns[V]),x!==""&&x===(E==null?void 0:E.column_name)?F[s.primary_key[S]]=g.context.insert_id:F[s.primary_key[S]]=l[s.primary_key[S]]}if((u==null?void 0:u.cardinality)===ge.ONE_TO_ONE){const S={};N!=null&&N.primary_key&&Array.isArray(N==null?void 0:N.primary_key)&&(N==null||N.primary_key.map(E=>S[E]=le[E]));const V={};if(u.join_condition!==void 0){const E=u.join_condition.split(",");for(let B=0;B<E.length;B++){const L=E[B].split("=");L.length===2&&(V[L[0]]=F[L[1]])}}nt(e,S,V,()=>{Object.keys(le).map(E=>{if(u.join_condition!==void 0){const B=u.join_condition.split(",");for(let L=0;L<B.length;L++){const oe=B[L].split("=");oe.length===2&&oe[0]===E&&T(tt({appId:a,columnName:E,columnValue:Z[oe[1]]}))}}})},()=>{})}if(n){m!==void 0&&m(F),c(!0,j);return}p(F,pe.UPDATE),_&&_(),y&&y();break;default:r.error(g),w(g.message??b.invalidResponse,{variant:"error"})}}else r.error(g),w(b.invalidResponse,{variant:"error"})},g=>{r.error("error",g),w(g??b.invalidResponse,{variant:"error"})},!1,d,v);r.debug(j),j!==void 0&&(r.debug("setM2MUpdate: true"),T(Ie({appId:j,update:!0})))}else r.error("Validate failed: ",l)},Rt=()=>je===null?null:t.jsx(i.Suspense,{children:t.jsx(M,{sx:{marginTop:"30px"},children:t.jsx(ct,{severity:"error",message:je,close:!1})})}),Ct=n=>{if(n!==null&&Le(Z)){const m=Se.getSelectors().selectTableById(I.getState().tables,e),_=m.state.relation.relation_join_condition.split(",").map(l=>l.split("=")),y={...m.state.detailKey};_.map(l=>{y[l[0]]=n[l[1]]}),st(e,y,l=>{if(r.debug(l),l!=null&&l.code&&(l!=null&&l.message))switch(l.code){case"ok":r.debug("Added relation to join table",l);break;default:r.error(l),w(l.message??b.invalidResponse,{variant:"error"})}else r.error(l),w(b.invalidResponse,{variant:"error"})},l=>{r.error(l),w(l??b.invalidResponse,{variant:"error"})},!1,!0,!1)}},[Mt,wt]=i.useState(void 0),Ot=()=>{try{ce(!1,()=>{},()=>{var m,_,y,l,h,g,x,F,S,V,E,B,L,oe,Je,Qe,Xe,qe,Ze,Ke;const n=JSON.parse((_=(m=s==null?void 0:s.app)==null?void 0:m.app[0])==null?void 0:_.app_settings);if(r.debug(n),((l=(y=n==null?void 0:n.settings)==null?void 0:y.app_registration)==null?void 0:l.showMessage)===!0&&((g=(h=n==null?void 0:n.settings)==null?void 0:h.app_registration)==null?void 0:g.message)!==void 0&&((F=(x=n==null?void 0:n.settings)==null?void 0:x.app_registration)==null?void 0:F.message)!==null&&((V=(S=n==null?void 0:n.settings)==null?void 0:S.app_registration)==null?void 0:V.message.trim())!==""&&wt((B=(E=n==null?void 0:n.settings)==null?void 0:E.app_registration)==null?void 0:B.message),((oe=(L=n==null?void 0:n.settings)==null?void 0:L.app_registration)==null?void 0:oe.allowUpdates)!==!0&&($(P.VIEW),((Qe=(Je=n==null?void 0:n.settings)==null?void 0:Je.app_registration)==null?void 0:Qe.showUrl)===!0&&((qe=(Xe=n==null?void 0:n.settings)==null?void 0:Xe.app_registration)==null?void 0:qe.url)!=="")){const zt=((Ke=(Ze=n==null?void 0:n.settings)==null?void 0:Ze.app_registration)==null?void 0:Ke.urlTime)??3;setTimeout(()=>{window.location.href=n.settings.app_registration.url},zt)}})}catch(n){r.error("Invalid JSON - app settings"),r.error(n),w(Zt.contactSupport,{variant:"error"})}},kt=()=>{ce(!1)},Nt=()=>{var m,_,y;const n=Se.getSelectors().selectTableById(I.getState().tables,e);r.debug((m=n==null?void 0:n.state)==null?void 0:m.relation),((y=(_=n==null?void 0:n.state)==null?void 0:_.relation)==null?void 0:y.cardinality)===ge.MANY_TO_MANY?ce(!0,Ct):ce(!0)},Te=()=>{c(!0,j)},Pe=ke(),Lt=at(e),Pt=at(j??""),K=yn(e),W=i.useRef(null),Ut=bn(),[re,Vt]=i.useState((We=W==null?void 0:W.current)==null?void 0:We.offsetWidth),[Bt,Dt]=i.useState({paddingTop:"50px",paddingBottom:"50px",paddingLeft:"50px",paddingRight:"50px"}),[At,Ue]=i.useState("30px"),[Ht,Ve]=i.useState("");if(i.useEffect(()=>{if(W.current!==null){Vt(W.current.offsetWidth);let n=re<600?.3:re<900?.6:1;(k??!1)===!0&&(n=1),Dt({paddingTop:`calc(${n} * 50px)`,paddingBottom:`calc(${n} * 50px)`,paddingLeft:`calc(${n} * 50px)`,paddingRight:`calc(${n} * 50px)`}),re<600?(Ue("10px"),Ve("10px")):re<900&&(Ue("20px"),Ve("20px"))}},[Ut.width,W.current,Pe.spacing]),q!=="")return t.jsx(i.Suspense,{children:t.jsx(ct,{severity:"error",message:q,close:!1})});const Be=()=>t.jsx(Sn,{appId:e,metaData:s,primaryKey:o,formMode:z,formUuid:A}),Wt=()=>t.jsxs(t.Fragment,{children:[t.jsx(ue,{color:"inherit",onClick:()=>{const n={appId:e};r.info(u),u!=null&&(n.hideThemeSettings=!0),j!==void 0&&(n.isRelationForm=!0),T(xt(n))},children:t.jsx(Et,{})}),t.jsx(ue,{color:"inherit",onClick:()=>{Te()},children:t.jsx(yt,{})})]}),Yt=i.useMemo(()=>{var n,m,_,y,l;return(n=s==null?void 0:s.src)!=null&&n.app_id&&((_=(m=s==null?void 0:s.app)==null?void 0:m.app[0])==null?void 0:_.app_title)!==""?s.app.app[0].app_title:(y=s==null?void 0:s.src)!=null&&y.dbs&&((l=s==null?void 0:s.src)!=null&&l.tbl)?s.src.dbs+" - "+s.src.tbl:"WP Data Access"},[]),De=(((ze=(Ye=U==null?void 0:U.table)==null?void 0:Ye.modal)==null?void 0:ze.maxHeight)??95)+(((Ge=($e=U==null?void 0:U.table)==null?void 0:$e.modal)==null?void 0:Ge.maxHeightUnit)??"vh"),Ae=()=>{var n,m;return t.jsxs(it,{elevation:Y,ref:ne,children:[(k??!1)===!0&&t.jsx(bt,{sx:{position:"unset",borderBottomRightRadius:0,borderBottomLeftRadius:0,boxShadow:"none"},children:t.jsxs(Tt,{sx:{display:"grid",gridTemplateColumns:"auto auto",justifyContent:"space-between",alignItems:"center"},children:[t.jsx(M,{sx:{display:"flex",alignItems:"center",cursor:"move",gap:"2px","& svg":{width:"2em",height:"2em"}},id:et(s,"title"),children:t.jsx(M,{sx:{display:"block",whiteSpace:"nowrap",fontSize:"18px",lineHeight:"18px",fontWeight:"bold",textOverflow:"ellipsis",overflow:"hidden",marginRight:"10px"},children:Yt})}),t.jsx(M,{children:(k??!1)===!0&&Ce(s)&&t.jsx(t.Fragment,{children:Wt()})})]})}),t.jsxs(M,{style:Bt,sx:{...(k??!1)===!0&&ae!==void 0&&{maxHeight:`calc(${De} - 240px)`,overflow:"auto",backgroundColor:"transparent",border:"none",borderRadius:0}},children:[t.jsxs(M,{sx:{margin:0,padding:"5px 0",...(k??!1)===!0&&ae===void 0&&{maxHeight:`calc(${De} - 240px)`,overflow:"auto"}},children:[Be(),O,Rt()]}),t.jsxs(M,{sx:{marginTop:{marginTop:At},paddingRight:{paddingRight:Ht},padding:0,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsxs(M,{sx:{display:"flex",gap:"8px"},children:[!1,(Lt||Pt)&&t.jsx(t.Fragment,{children:re<600?t.jsx(ue,{color:"primary",onClick:()=>{T(fe({appId:e,more:!K})),j!==void 0&&T(fe({appId:j,more:!K}))},children:K?t.jsx(rt,{}):t.jsx(ot,{})}):t.jsx(ie,{variant:"outlined",startIcon:K?t.jsx(rt,{}):t.jsx(ot,{}),onClick:()=>{T(fe({appId:e,more:!K})),j!==void 0&&T(fe({appId:j,more:!K}))},children:K?b.less:b.more})}),(D==null?void 0:D.customActionsBottom)!==void 0&&gt(s)&&t.jsx(t.Fragment,{children:t.jsx(Mn,{code:D.customActionsBottom.code??"",safeMode:X.safeMode,isExpression:!1,args:{log:r,row:Z,mode:qt[f]}})}),t.jsx(M,{className:"pp-registration-form-message",children:Mt})]}),t.jsx(M,{sx:{...re<600&&{marginLeft:"0 !important","& button":{marginLeft:"2px",padding:"6px"}}},children:f!==P.VIEW?t.jsx(t.Fragment,{children:((m=(n=s==null?void 0:s.app)==null?void 0:n.app[0])==null?void 0:m.app_type)==Fe.REGISTRATION&&U.state.masterDetailConditions===void 0?t.jsx(t.Fragment,{children:(z===P.INSERT||z===P.UPDATE)&&t.jsx(ie,{variant:"contained",onClick:Ot,type:"submit",form:A,sx:{marginLeft:"8px"},children:b.ok})}):t.jsxs(t.Fragment,{children:[t.jsx(ie,{variant:"contained",onClick:kt,type:"submit",form:A,disabled:je!==null,children:b.apply}),(u==null?void 0:u.cardinality)!==ge.ONE_TO_ONE&&t.jsxs(t.Fragment,{children:[t.jsx(ie,{variant:"outlined",onClick:Nt,sx:{marginLeft:"8px"},children:b.ok}),t.jsx(ie,{variant:"outlined",onClick:Te,sx:{marginLeft:"8px"},children:b.cancel})]})]})}):t.jsx(t.Fragment,{children:(u==null?void 0:u.cardinality)!==ge.ONE_TO_ONE&&t.jsx(ie,{variant:"contained",onClick:Te,children:b.back})})})]}),t.jsx(t.Fragment,{children:!1})]})]})};return H?Be():(i.useEffect(()=>{var n;W.current!==null&&((n=window.document.getElementById(`pp-app-${e}`))==null||n.scrollIntoView())},[W.current]),t.jsx("div",{className:`${e}_wrapper pp-form`,ref:W,style:{scrollMarginTop:"70px"},children:se&&Z!==null?t.jsx(t.Fragment,{children:(k??!1)===!0?t.jsx(t.Fragment,{children:t.jsx(_n,{handle:"#"+et(s,"title"),nodeRef:ne,offsetParent:document.body,children:Ae()})}):t.jsx(t.Fragment,{children:Ae()})}):t.jsx(it,{style:{padding:"50px"},elevation:Y,children:t.jsx(Me,{title:b.loadingData})})}))},On=i.lazy(()=>ee(()=>import("./Settings-1.0.35-HFJmJU1l.js"),__vite__mapDeps([46,11,1,2,3,12,6,7,8,9,16,4,5,10,17,18,24,19,20,21,22,23,25,26,47,15,28,29,30,31,32,33]),import.meta.url)),dt=({appId:e,primaryKey:o,formMode:f,showTable:c,showForm:p,metaData:C,detailKey:O,selectionForm:j,masterAppId:v})=>{r.debug(e,o,f,C,O,j,v);const d=ln(),a=we(e).table;r.debug("relationship",null);const T=i.useMemo(()=>{},[]);r.debug("relationAppId",T);const ne=()=>null,Q=()=>null,b=()=>null,Y=()=>{var D,X,z,$,A,se,G,q;return t.jsx(jn,{open:!0,className:"pp-form-modal",sx:{zIndex:9999990},children:t.jsx(M,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",minWidth:(((D=a==null?void 0:a.modal)==null?void 0:D.minWidth)??60)+(((X=a==null?void 0:a.modal)==null?void 0:X.minWidthUnit)??"vw"),maxWidth:(((z=a==null?void 0:a.modal)==null?void 0:z.maxWidth)??90)+((($=a==null?void 0:a.modal)==null?void 0:$.maxWidthUnit)??"vw"),minHeight:(((A=a==null?void 0:a.modal)==null?void 0:A.minHeight)??0)+(((se=a==null?void 0:a.modal)==null?void 0:se.minHeightUnit)??"vh"),maxHeight:(((G=a==null?void 0:a.modal)==null?void 0:G.maxHeight)??95)+(((q=a==null?void 0:a.modal)==null?void 0:q.maxHeightUnit)??"vh"),backgroundColor:"transparent"},children:t.jsx(ut,{appId:e,primaryKey:o,formMode:f,showTable:c,showForm:p,detailKey:O,relationAppId:T,masterAppId:v,isModal:!0,children:Q()})})})},U=()=>t.jsx(ut,{appId:e,primaryKey:o,formMode:f,showTable:c,showForm:p,detailKey:O,relationAppId:T,masterAppId:v,children:Q()});return t.jsxs(t.Fragment,{children:[j===!0?t.jsx(t.Fragment,{children:ne()}):t.jsx(t.Fragment,{children:a.formModal===!0?t.jsx(t.Fragment,{children:Y()}):t.jsx(t.Fragment,{children:U()})}),t.jsx(t.Fragment,{children:Ce(C)&&t.jsx(pt,{theme:d,children:t.jsx(i.Suspense,{fallback:t.jsx(Me,{}),children:t.jsx(On,{appId:e})})})}),b()]})},kn=e=>{const o=te(f=>{var c,p;return((p=(c=f.tables[e])==null?void 0:c.state)==null?void 0:p.fullScreen)??!1});return r.debug("fullScreen",o),o},Nn=i.lazy(()=>ee(()=>import("./TableContainer-1.0.35-BaHCfHCa.js").then(e=>e.T),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33]),import.meta.url));i.lazy(()=>ee(()=>import("./TableChartDock-1.0.35-C4FS5jUK.js"),__vite__mapDeps([48,1,2,3,49,11,12,6,7,8,9,32,16,33,5,21,20,10,15,39,4,40,41]),import.meta.url));const mt=({appId:e})=>{var s,Z;r.debug(e);const o=ht(),f=dn(),c=mn(),p=vt(),C=jt(e);fn(e),we(e).table;const j=_t(e),v="pp-remove-body-vertical-scrollbar",d=he(e),H=i.useMemo(()=>{var u,R,N,le,ae;return(u=d==null?void 0:d.src)!=null&&u.app_id&&((N=(R=d==null?void 0:d.app)==null?void 0:R.app[0])==null?void 0:N.app_title)!==""?d.app.app[0].app_title:(le=d==null?void 0:d.src)!=null&&le.dbs&&((ae=d==null?void 0:d.src)!=null&&ae.tbl)?d.src.dbs+" - "+d.src.tbl:"WP Data Access"},[]),a=kn(e);i.useEffect(()=>(r.debug(a),()=>{var u;(u=window.document.getElementById(v))==null||u.remove(),window.document.body.classList.remove("pp-fullscreen")}),[a]);const k=i.useMemo(()=>Se.getSelectors().selectTableExploring(I.getState().tables,e),[e]);r.debug("tableExploring",k);const[T,ne]=i.useState(((Z=(s=d==null?void 0:d.app)==null?void 0:s.app[0])==null?void 0:Z.app_type)==Fe.REGISTRATION?J.FORM:J.TABLE),[Q,b]=i.useState(!1),Y=u=>{o(sn({appId:e,mode:u})),ne(u)};i.useEffect(()=>{window.ppShowForm=function(u){r.debug(u),X(u),Y(J.FORM)}},[e]);const U=(u,R)=>{r.debug(u,R),rn(e)&&(c(e),R!==void 0&&(f(R),c(R))),u&&b(!Q),Y(J.TABLE)},[D,X]=i.useState(null),[z,$]=i.useState(P.VIEW),A=(u,R)=>{switch(r.debug(u,R),R){case pe.INSERT:$(P.INSERT);break;case pe.UPDATE:$(P.UPDATE);break;default:$(P.VIEW)}X(u),Y(J.FORM)};let se={};Oe(e);const G=()=>null,q=()=>t.jsx(i.Suspense,{fallback:t.jsx(ve,{title:j.loadingForm}),children:t.jsx(dt,{appId:e,primaryKey:D,formMode:P.INSERT,showTable:()=>{},showForm:A,metaData:d})}),_e=()=>{var u,R;return((R=(u=d==null?void 0:d.app)==null?void 0:u.app[0])==null?void 0:R.app_type)==Fe.REGISTRATION?q():t.jsxs(t.Fragment,{children:[t.jsxs(i.Suspense,{fallback:t.jsx(ve,{title:j.loadingTable}),children:[!1,t.jsx(Nn,{appId:e,display:T===J.TABLE,refresh:Q,showForm:A,metaData:d}),!1]}),T===J.FORM&&t.jsx(i.Suspense,{fallback:t.jsx(ve,{title:j.loadingForm}),children:t.jsx(dt,{appId:e,primaryKey:D,formMode:z,showTable:U,showForm:A,metaData:d})})]})};return t.jsxs(M,{className:"pp-component",sx:a?se:{},children:[t.jsx(bt,{className:"pp-header",elevation:p,position:"relative",sx:{margin:"0 0 5px 0"},children:t.jsxs(Tt,{sx:{display:"grid",gridTemplateColumns:"auto auto",justifyContent:"space-between",alignItems:"center"},children:[t.jsx(M,{sx:{display:"block",whiteSpace:"nowrap",fontSize:"18px",lineHeight:"18px",fontWeight:"bold",textOverflow:"ellipsis",overflow:"hidden",marginRight:"10px"},children:H}),t.jsxs(M,{sx:{display:"flex",gap:"10px",justifyContent:"center",alignItems:"center"},children:[Ce(d)&&t.jsx(lt,{title:t.jsx(gn,{details:C,mode:T}),className:"pp-builder-button",children:t.jsx(ue,{sx:{color:"inherit",padding:0},onClick:()=>{T===J.FORM?o(xt({appId:e})):o(It({appId:e}))},children:t.jsx(Et,{})})}),G(),k&&t.jsx(lt,{title:j.close,children:t.jsx(ue,{sx:{color:"inherit",padding:0},onClick:()=>{var u;(u=window.document.getElementById(v))==null||u.remove(),window.document.body.classList.remove("pp-fullscreen"),d.src.app_id?o(en({isActive:!1,appDbId:0})):o(tn({})),c(e),f(e),o(nn({}))},children:t.jsx(yt,{})})})]})]})}),_e()]})},Ln=e=>({}),Pn=({appId:e})=>{r.debug(e);const o=xn(e),f=ke(),c=pn(),p=he(e);let C;p.appRootId===void 0&&(C=hn(c,o,f));const O=Ln(),j=`pp-global-code-${e}`;return i.useEffect(()=>{r.debug("open app")},[]),i.useEffect(()=>()=>{var v;r.debug("close app"),ft(((v=O.onAppClose)==null?void 0:v.code)??"",on(p),!1)},[]),i.useEffect(()=>{var v,d,H;if(O!==void 0&&gt(p)){(v=window.document.getElementById(j))==null||v.remove();const a=window.document.createElement("script");a.id=j,a.innerHTML=((d=O.global)==null?void 0:d.code)??"",(H=window.document.getElementById(`pp-app-${e}`))==null||H.appendChild(a)}},[O]),C!==void 0?t.jsx(pt,{theme:C,children:t.jsx(mt,{appId:e})}):t.jsx(mt,{appId:e})},ts=Object.freeze(Object.defineProperty({__proto__:null,default:Pn},Symbol.toStringTag,{value:"Module"}));export{pe as R,ts as T,yn as a,kn as b,vt as c,Ln as d,Rn as e,Re as f,xe as g,En as u};
