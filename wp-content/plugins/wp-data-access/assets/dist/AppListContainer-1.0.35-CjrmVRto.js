const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./SettingsApp-1.0.35-_3_cJP2u.js","./cm-1.0.35--NMEhA6K.js","./redux-1.0.35-xa1uZ5t4.js","./vendor-1.0.35-CN03Eozo.js","./cjs-1.0.35-B75n3jry.js","./Typography-1.0.35-DmbWmVEH.js","./lib-1.0.35-vCbYWOI3.js","./loglevel-1.0.35-BZ7XahX3.js","./lodash-1.0.35-CNe2eGU5.js","./moment-1.0.35-C5S46NFB.js","./iconBase-1.0.35-CEh1aNes.js","./useEnhancedEffect-1.0.35-gtlBTowv.js","./notistack-1.0.35-C7EWtXAA.js","./TargetEnum-1.0.35-DPFnTxiX.js","./ConfirmDialog-1.0.35-5-r3Xts8.js","./AdminTheme-1.0.35-BtyHaBRh.js","./DialogContent-1.0.35-B5TpMgZC.js","./ConfirmDialog-1.0.35--D4jr2go.css","./ActionsSettings-1.0.35-B25TLnTF.js","./RestApi-1.0.35-Bt-tzntO.js","./AccordionSummary-1.0.35-Do5lpUEE.js","./useControlled-1.0.35-Cu7qahuZ.js","./Collapse-1.0.35-EVtTATBO.js","./AccordionDetails-1.0.35-CUwNn0VM.js","./FormHelperText-1.0.35-BubqYRHL.js","./useFormControl-1.0.35-gKEqvAy-.js","./PremiumFeature-1.0.35-BMopEtPl.js","./index-1.0.35-DHBDMhlb.js","./FormLabel-1.0.35-DqGGwQsT.js","./FormControlLabel-1.0.35-DFi_cuDq.js","./Switch-1.0.35-Z50HBuFJ.js","./SwitchBase-1.0.35-BN1QoK5P.js","./TextField-1.0.35-B1uB0pL3.js","./Menu-1.0.35-3APgaaPr.js","./createSvgIcon-1.0.35-C47rBL-a.js","./Spinner-1.0.35-Dd1TcgqP.js","./MenuItem-1.0.35-DJ1Zxsyh.js","./main-1.0.35.js","./TabPanel-1.0.35-CQEcgw4y.js","./index-1.0.35-BtMPEpn4.js","./settings-1.0.35-CRkkJAih.js","./settings-1.0.35-Bx2jvYL6.css","./ComponentColumn-1.0.35-UdBdi3SL.js","./ActionsExplorer-1.0.35-frLqGKOk.js","./Autocomplete-1.0.35-DKAFaob_.js","./Close-1.0.35-D-owgKS4.js","./Popper-1.0.35-BZjTWtMm.js","./ActionsApp-1.0.35-BVk_SN7N.js","./Checkbox-1.0.35-DB1d6Tfc.js","./Tooltip-1.0.35-DvHLxZ2q.js","./Link-1.0.35-CxbvVS8_.js","./FileSaver.min-1.0.35-Cpl1m5n7.js","./index-1.0.35-Duj-VvUw.js","./index-1.0.35-CCys4hnd.js","./useTheme-1.0.35-DvysJ9Pk.js","./RadioGroup-1.0.35-en0YSLOf.js","./Radio-1.0.35-Hf47vRci.js","./CardHeader-1.0.35-D45Y3ccE.js","./Divider-1.0.35-CstwCFXQ.js","./index-1.0.35-ChYeyr_I.js","./Stepper-1.0.35-B-Cu3w2D.js","./ListItemIcon-1.0.35-Cltcdraz.js","./ListItemText-1.0.35-DZW6eM22.js","./AppMetaData-1.0.35-CDiIW_9m.js","./StoreTypeEnum-1.0.35-BRKOiCKa.js","./Chart-1.0.35-BfkC_RH6.js","./Tabs-1.0.35-D_fzHWOP.js","./FallbackSpinner-1.0.35-CzYFJIrC.js","./Alert-1.0.35-CqUFZJNz.js","./AlertTitle-1.0.35-t_Cdy-a_.js","./index-1.0.35-Bey3P_99.js","./InputAdornment-1.0.35-CVHCdOjF.js","./main-1.0.35-DkGWeYUl.css","./SettingApps-1.0.35-CD_4K4DE.js","./SettingsData-1.0.35-meZLBoGQ.js","./SettingsAuthorization-1.0.35-kTpNELCN.js","./ResizableDrawer-1.0.35-Db0Upw2F.js","./useScreenSize-1.0.35-D9QB3bUJ.js"])))=>i.map(i=>d[i]);
import{j as e}from"./cm-1.0.35--NMEhA6K.js";import{r as u}from"./redux-1.0.35-xa1uZ5t4.js";import{l as n,P as mt,A as h,a as Ue,s as ht,u as st,b as R,c as ge,d as Ye,g as rt,e as $e,f as Je,h as gt,S as ft,R as Z,i as jt,j as Ze,k as z,C as Ae,m as Ke,n as bt,o as At,p as yt,q as at,v as Tt,r as J,t as Ct,w as Te,x as St}from"./lib-1.0.35-vCbYWOI3.js";import{A as ne,a as vt,T as It}from"./AdminTheme-1.0.35-BtyHaBRh.js";import{u as B,a as H,R as Rt}from"./RestApi-1.0.35-Bt-tzntO.js";import{_ as ce}from"./main-1.0.35.js";import{T as Ce,C as oe,a as le,b as ie}from"./ConfirmDialog-1.0.35-5-r3Xts8.js";import{B as Dt,a as wt,T as Nt,b as Se}from"./TabPanel-1.0.35-CQEcgw4y.js";import{A as nt,T as it,M as Ie,B as U,a as Mt,b as _t,c as Et,d as Lt,e as kt,f as Pt,g as Ot,h as pt,i as zt,j as Bt,k as Re,l as De,m as Ft,n as qt,o as Qt,p as Ht,q as Gt,r as Vt,s as Wt,t as Ut,u as Yt}from"./cjs-1.0.35-B75n3jry.js";import{B as $t,a as Jt,b as Zt,c as Kt,d as Xt}from"./index-1.0.35-BtMPEpn4.js";import{B as es}from"./settings-1.0.35-CRkkJAih.js";import{e as c}from"./notistack-1.0.35-C7EWtXAA.js";import{u as ye,C as ts,a as ss,b as rs}from"./ComponentColumn-1.0.35-UdBdi3SL.js";import{a as as,b as ns,c as is,d as ps,e as os,f as ls,g as ds,h as cs,i as us,j as xs}from"./ActionsApp-1.0.35-BVk_SN7N.js";import{B as p,S as ae}from"./Spinner-1.0.35-Dd1TcgqP.js";import{T as ve}from"./Typography-1.0.35-DmbWmVEH.js";import{I as Q,P as ms}from"./iconBase-1.0.35-CEh1aNes.js";import{F as hs,a as gs}from"./index-1.0.35-DHBDMhlb.js";import{F as fs}from"./FileSaver.min-1.0.35-Cpl1m5n7.js";import{C as js}from"./index-1.0.35-Duj-VvUw.js";import{u as fe}from"./index-1.0.35-CCys4hnd.js";import{T as O}from"./Tooltip-1.0.35-DvHLxZ2q.js";import{L as X}from"./Link-1.0.35-CxbvVS8_.js";import{M as bs}from"./Menu-1.0.35-3APgaaPr.js";import{M as K}from"./MenuItem-1.0.35-DJ1Zxsyh.js";import{F as ee,a as de}from"./FormHelperText-1.0.35-BubqYRHL.js";import{F as ot}from"./FormControlLabel-1.0.35-DFi_cuDq.js";import{C as As}from"./Checkbox-1.0.35-DB1d6Tfc.js";import{l as ys,D as P}from"./useTheme-1.0.35-DvysJ9Pk.js";import{R as Ts}from"./RadioGroup-1.0.35-en0YSLOf.js";import{F as Xe}from"./FormLabel-1.0.35-DqGGwQsT.js";import{R as et}from"./Radio-1.0.35-Hf47vRci.js";import{A as je,C as be}from"./Autocomplete-1.0.35-DKAFaob_.js";import{T as V,I as lt,S as we}from"./TextField-1.0.35-B1uB0pL3.js";import{S as Cs}from"./Switch-1.0.35-Z50HBuFJ.js";import{P as Ss}from"./PremiumFeature-1.0.35-BMopEtPl.js";import{C as Ne}from"./CardHeader-1.0.35-D45Y3ccE.js";import{D as vs}from"./Divider-1.0.35-CstwCFXQ.js";import{c as Is}from"./index-1.0.35-ChYeyr_I.js";import{S as Rs,a as Ds,b as ws}from"./Stepper-1.0.35-B-Cu3w2D.js";import{L as Ns}from"./ListItemIcon-1.0.35-Cltcdraz.js";import{L as Ms}from"./ListItemText-1.0.35-DZW6eM22.js";import{A as _s}from"./AppMetaData-1.0.35-CDiIW_9m.js";import{T as Es}from"./index-1.0.35-Bey3P_99.js";/* empty css                    */import{I as Ls}from"./InputAdornment-1.0.35-CVHCdOjF.js";const ks=()=>{const t=B(i=>i.apps.appApps);return n.debug("appApps",t),t},Ps=u.lazy(()=>ce(()=>import("./SettingsApp-1.0.35-_3_cJP2u.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72]),import.meta.url)),Os=u.lazy(()=>ce(()=>import("./SettingApps-1.0.35-CD_4K4DE.js"),__vite__mapDeps([73,1,2,3,20,5,6,7,8,9,10,11,21,22,4,12,15,19,37,14,16,17,38,39,40,35,33,36,41,42,43,24,25,44,32,28,34,45,46,47,29,48,31,49,50,27,51,52,53,54,55,56,30,26,57,58,59,60,61,62,63,64,65,18,13,66,67,68,69,70,71,72]),import.meta.url)),zs=u.lazy(()=>ce(()=>import("./SettingsData-1.0.35-meZLBoGQ.js"),__vite__mapDeps([74,1,2,3,42,19,6,7,8,9,12,43,24,5,25,44,32,10,11,33,15,4,28,21,34,45,46,47,35,29,48,31,49,50,26,27,20,22,23,55,56,36,37,14,16,17,38,39,40,41,51,52,53,54,30,57,58,59,60,61,62,63,64,65,18,13,66,67,68,69,70,71,72]),import.meta.url)),Bs=u.lazy(()=>ce(()=>import("./SettingsAuthorization-1.0.35-kTpNELCN.js"),__vite__mapDeps([75,1,2,3,19,6,7,8,9,4,5,10,11,12,35,29,25,30,31,21,24,50,32,33,15,28,34,52,49,46,20,22,23,37,14,16,17,38,39,40,36,41,42,43,44,45,47,48,27,51,53,54,55,56,26,57,58,59,60,61,62,63,64,65,18,13,66,67,68,69,70,71,72]),import.meta.url)),Fs=u.lazy(()=>ce(()=>import("./ResizableDrawer-1.0.35-Db0Upw2F.js"),__vite__mapDeps([76,1,2,3,77,6,7,8,9,19,5,15,11,10,4,12,33]),import.meta.url)),qs=({appDbId:t})=>{var F,q;n.debug(t);const i=H(),s=ye(),l=((F=ne)==null?void 0:F.palette.mode)===mt.LIGHT?(q=ne)==null?void 0:q.palette.primary.main:"",[j,d]=u.useState(!1);n.debug(j);const[x,f]=u.useState(!1);n.debug(x);const T=()=>{i(st({}))},r=()=>{j?f(!0):T()},o=()=>{if(!s.appName)return c("App name is required",{variant:"error"}),!1;if(!s.appTitle)return c("App title is required",{variant:"error"}),!1;if(s.appType==h.APPCONTAINER)s.appApps.length===0&&c("No apps added",{variant:"info"});else{if(!s.appDatabase)return c("Database is required",{variant:"error"}),!1;if(s.appType==h.CHART){if(!s.appQuery)return c("SQL query is required",{variant:"error"}),!1}else{if(!s.appTable)return c("Table is required",{variant:"error"}),!1;if(s.appColumns.filter(C=>C.isSelected).length===0)return c("At least one column must be selected",{variant:"error"}),!1}}return!0},g=()=>{o()&&as(s,C=>{if(n.debug(C),C!=null&&C.code&&(C==null?void 0:C.message)!==void 0)switch(C.code){case"ok":c(C.message,{variant:"success"}),i(ge({}));break;case"info":c(C.message,{variant:"info"});break;default:n.error(C),c(C.message??R.contactSupport,{variant:"error"})}else n.error(C),c(R.contactSupport,{variant:"error"})},C=>{n.error("error",C),c(C??R.contactSupport,{variant:"error"})})},I=()=>{o()&&(g(),T())},M=C=>{i(ht({anchor:C}))},[D,A]=u.useState(0),v=u.useMemo(()=>[{title:"App Info",icon:e.jsx($t,{})},{title:s.appType==h.APPCONTAINER?"Apps":"Data Source",icon:s.appType==h.APPCONTAINER?e.jsx(Jt,{}):e.jsx(Zt,{})},{title:"Access",icon:e.jsx(Kt,{})}],[]);return e.jsxs(e.Fragment,{children:[e.jsx(u.Suspense,{fallback:e.jsx(ae,{}),children:e.jsxs(Fs,{closeDrawer:r,children:[e.jsxs(nt,{position:"static",elevation:4,sx:{borderRadius:0},children:[e.jsxs(it,{className:"pp-setting-toolbar",sx:{borderRadius:0},children:[e.jsxs(p,{sx:{flexGrow:1},children:[e.jsx(ve,{variant:"h5",noWrap:!0,component:"div",className:"unselectable",sx:{paddingLeft:"6px"},children:"Manage App"}),e.jsx(ve,{sx:{fontSize:"10px",paddingLeft:"10px"},children:s.appName})]}),e.jsx(Ce,{title:"Dock to left",position:"bottom",children:e.jsx(Q,{onClick:()=>{M(Ue.LEFT)},size:"large",color:"inherit",sx:{fontSize:"1em"},children:e.jsx(Dt,{})})}),e.jsx(Ce,{title:"Dock to right",position:"bottom",children:e.jsx(Q,{onClick:()=>{M(Ue.RIGHT)},size:"large",color:"inherit",sx:{fontSize:"1em"},children:e.jsx(wt,{})})}),e.jsx(Ce,{title:"Close",position:"bottom",children:e.jsx(Q,{onClick:r,size:"large",color:"inherit",sx:{fontSize:"1.4em"},children:e.jsx(Ie,{})})})]}),e.jsx(es,{menuItems:v,menuIndex:D,setMenu:A})]}),e.jsx(oe,{className:"pp-settings-container",children:e.jsx(le,{sx:{padding:0,margin:0},children:e.jsx(Nt,{value:D,children:e.jsxs(p,{sx:{margin:0,padding:0,overflowX:"hidden",overflowY:"auto",height:"calc(100vh - 232px)","& > div.MuiTabPanel-root":{padding:0}},children:[e.jsx(Se,{value:0,children:e.jsx(u.Suspense,{fallback:e.jsx(ae,{}),children:e.jsx(Ps,{app:s,setIsUpdated:d})})}),e.jsx(Se,{value:1,children:s.appType==h.APPCONTAINER?e.jsx(u.Suspense,{fallback:e.jsx(ae,{}),children:e.jsx(Os,{app:s,setIsUpdated:d})}):e.jsx(u.Suspense,{fallback:e.jsx(ae,{}),children:e.jsx(zs,{app:s,setIsUpdated:d})})}),e.jsx(Se,{value:2,children:e.jsx(u.Suspense,{fallback:e.jsx(ae,{}),children:e.jsx(Bs,{app:s,setIsUpdated:d})})})]})})})}),e.jsx(oe,{className:"pp-setting-footer",sx:{borderRadius:0,backgroundColor:l},children:e.jsxs(le,{className:"pp-setting-footer-buttons",sx:{borderRadius:0},children:[e.jsx(U,{variant:"outlined",className:"footer_action_button_apply",onClick:g,children:"Apply"}),e.jsx(U,{variant:"outlined",className:"footer_action_button",onClick:I,children:"OK"}),e.jsx(U,{variant:"outlined",className:"footer_action_button",onClick:r,children:"Cancel"})]})})]})}),e.jsx(ie,{title:"Close App Manager?",message:"All uncommitted changes will be lost!",open:x,setOpen:f,onConfirm:()=>{T()},onKeep:()=>{T()}})]})},Qs=()=>{const t=B(i=>i.apps.showAppStructure);return n.debug("showAppStructure",t),t},dt=({appType:t})=>t==h.APPCONTAINER?e.jsx(p,{sx:{fontSize:"26px",display:"flex",width:"28px",justifyContent:"center",alignContent:"center",marginRight:"5px"},children:e.jsx(Mt,{})}):t==h.DATAENTRY?e.jsx(p,{sx:{fontSize:"22px",display:"flex",width:"28px",justifyContent:"center",alignContent:"center",marginRight:"5px"},children:e.jsx(_t,{})}):t==h.CHART?e.jsx(p,{sx:{fontSize:"22px",display:"flex",width:"28px",justifyContent:"center",alignContent:"center",marginRight:"5px"},children:e.jsx(Et,{})}):t==h.REGISTRATION?e.jsx(p,{sx:{fontSize:"22px",display:"flex",width:"28px",justifyContent:"center",alignContent:"center",marginRight:"5px"},children:e.jsx(hs,{})}):e.jsx(p,{sx:{fontSize:"20px",display:"flex",width:"28px",justifyContent:"center",alignContent:"center",marginRight:"5px"},children:e.jsx(gs,{})}),tt=({app:t,density:i})=>{var $,G,ue,xe;n.debug(t);const s=H(),[l,j]=u.useState(!1),[d,x]=u.useState(!1),[f,T]=u.useState(!1),[r,o]=u.useState(!1),g=a=>{let y={};try{y=JSON.parse(a.app_settings)}catch(w){y.rest_api={authorization:Z.AUTHORIZED,authorized_roles:[],authorized_users:[]},n.error("Invalid JSON - app settings"),n.error(w),c("Invalid JSON, check console",{variant:"error"})}return y},I=a=>{ns(a,y=>{var te,m,S,k,W,se,_,me,re,he,Me,_e,Ee,Le,ke,Pe,Oe,ze,Be,Fe,qe,Qe,He,Ge,Ve,We;const w=y==null?void 0:y.data;if(n.debug("response data",w),w.app&&w.app.app&&Array.isArray(w.app.app)&&w.app.container&&Array.isArray(w.app.container)&&w.app.apps&&Array.isArray(w.app.apps)){const L=w.app.app[0];if(n.debug(L),L.app_type==h.APPCONTAINER){const N=g(L),pe=w.app.apps;n.debug(pe),s($e({appDbId:a,appId:Je(a),appName:L.app_name,appTitle:L.app_title,appType:L.app_type,appCntId:0,appCntSeqNr:0,appDatabase:null,appTable:null,appColumns:[],appQuery:"",appRelationTable:null,appRelationColumns:[],appRestApi:N==null?void 0:N.rest_api,appAddToMenu:L.app_add_to_menu!=="0",appMenuTitle:((te=N==null?void 0:N.settings)==null?void 0:te.app_menu_title)??L.app_title,appMetaData:w,appLanguage:(m=N==null?void 0:N.settings)==null?void 0:m.app_language,fullScreen:((S=N==null?void 0:N.settings)==null?void 0:S.app_fullscreen)??!0,safeMode:((k=N==null?void 0:N.settings)==null?void 0:k.app_safe_mode)??!1,appApps:pe}))}else{const N=w.app.container[0];n.debug(N);let pe=[];try{pe=JSON.parse(N.cnt_cls)}catch(xt){n.error("Invalid JSON - app columns"),n.error(xt),c("Invalid JSON, check console",{variant:"error"})}const b=g(L);s($e({appDbId:a,appId:Je(a),appName:L.app_name,appTitle:L.app_title,appType:L.app_type,appCntId:N.cnt_id,appCntSeqNr:N.cnt_seq_nr,appDatabase:N.cnt_dbs,appTable:N.cnt_tbl,appColumns:pe,appQuery:N.cnt_query??"",appRelationTable:null,appRelationColumns:[],appRestApi:b==null?void 0:b.rest_api,appAddToMenu:L.app_add_to_menu!=="0",appMenuTitle:((W=b==null?void 0:b.settings)==null?void 0:W.app_menu_title)??L.app_title,appMetaData:w,appLanguage:(se=b==null?void 0:b.settings)==null?void 0:se.app_language,fullScreen:((_=b==null?void 0:b.settings)==null?void 0:_.app_fullscreen)??!0,safeMode:((me=b==null?void 0:b.settings)==null?void 0:me.app_safe_mode)??!1,registrationMessage:((he=(re=b==null?void 0:b.settings)==null?void 0:re.app_registration)==null?void 0:he.message)??void 0,registrationShowMessage:((_e=(Me=b==null?void 0:b.settings)==null?void 0:Me.app_registration)==null?void 0:_e.showMessage)??!1,registrationUrl:((Le=(Ee=b==null?void 0:b.settings)==null?void 0:Ee.app_registration)==null?void 0:Le.url)??"",registrationShowUrl:((Pe=(ke=b==null?void 0:b.settings)==null?void 0:ke.app_registration)==null?void 0:Pe.showUrl)??!1,registrationUrlTime:((ze=(Oe=b==null?void 0:b.settings)==null?void 0:Oe.app_registration)==null?void 0:ze.urlTime)??3,registrationAllowUpdates:((Fe=(Be=b==null?void 0:b.settings)==null?void 0:Be.app_registration)==null?void 0:Fe.allowUpdates)??!0,cacheData:((Qe=(qe=b==null?void 0:b.settings)==null?void 0:qe.app_chart)==null?void 0:Qe.cacheData)??!1,updateValue:((Ge=(He=b==null?void 0:b.settings)==null?void 0:He.app_chart)==null?void 0:Ge.updateValue)??12,updateUnit:((We=(Ve=b==null?void 0:b.settings)==null?void 0:Ve.app_chart)==null?void 0:We.updateUnit)??"h"}))}}else c(R.contactSupport,{variant:"error"})},y=>{n.error("error",y),c(y??R.contactSupport,{variant:"error"})})},M=()=>{is(t.appId,a=>{if(n.debug(a),a!=null&&a.code&&(a==null?void 0:a.message)!==void 0)switch(a.code){case"ok":c(a.message,{variant:"success"}),s(ge({}));break;case"info":c(a.message,{variant:"info"});break;default:n.error(a),c(a.message??R.contactSupport,{variant:"error"})}else n.error(a),c(R.contactSupport,{variant:"error"});j(!1)},a=>{n.error("error",a),c(a??R.contactSupport,{variant:"error"}),j(!1)})},D=()=>{ps(t.appId,a=>{n.debug(a),a!=null&&a.code&&(a==null?void 0:a.message)!==void 0?a.data.data?fs(new Blob([a.data.data],{type:"text/json;charset=utf-8"}),"wpda-export-"+t.appName+".sql"):(n.error(a),c(a.message??R.contactSupport,{variant:"error"})):(n.error(a),c(R.contactSupport,{variant:"error"})),j(!1)},a=>{n.error("error",a),c(a??R.contactSupport,{variant:"error"}),j(!1)})},A=a=>{os(a,y=>{if(n.debug(y),y!=null&&y.code&&(y==null?void 0:y.message)!==void 0)switch(y.code){case"ok":c(y.message,{variant:"success"}),s(ge({}));break;case"info":c(y.message,{variant:"info"});break;default:n.error(y),c(y.message??R.contactSupport,{variant:"error"})}else n.error(y),c(R.contactSupport,{variant:"error"});T(!1)},y=>{n.error("error",y),c(y??R.contactSupport,{variant:"error"}),T(!1)})},v=()=>{if(A(t.appId),t.appType==h.APPCONTAINER&&r===!0){const a=gt.getSelectors().selectAppAppsList(ft.getState().apps);a[t.appId]!==void 0&&Array.isArray(a[t.appId])&&(n.debug("start deleting detail apps",a[t.appId]),a[t.appId].map(y=>{n.debug("delete detail app",y),A(y)}))}},F=fe("(max-width:700px)"),q=fe("(max-width:900px)"),[C,E]=u.useState(null),Y=!!C;return e.jsxs(e.Fragment,{children:[e.jsxs(p,{"data-testid":t.appName+"-"+t.appType,sx:{display:"grid",gridTemplateColumns:"auto auto",justifyContent:"space-between",alignItems:"center",padding:i==="small"?"8px 8px 8px 12px":i==="medium"?"16px":"24px",...q&&{".pp-row-actions":{width:0}},"&:hover":{".pp-row-title":{display:q?"inline-block":"none"},".pp-row-actions":{visibility:q?"hidden":"visible"}}},children:[e.jsxs(p,{sx:{display:"grid",gridTemplateColumns:"auto auto",alignItems:"center"},children:[e.jsxs(p,{sx:{width:"100%",display:"grid",gridTemplateColumns:"auto 1fr",gridGap:i==="small"?"3px":i==="medium"?"6px":"9px",justifyContent:"center",alignItems:"center"},children:[e.jsx(dt,{appType:t.appType}),e.jsxs(p,{sx:{textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"},children:[t.appName,e.jsxs(p,{className:"pp-row-title",sx:{display:"inline-block",marginLeft:"5px",fontSize:"80%"},children:["−",e.jsx(p,{sx:{display:"inline-block",width:"5px"}}),`${t.appTitle} (App ID: ${t.appId})`]})]})]}),e.jsxs(p,{sx:{display:"grid",visibility:"hidden",gridTemplateColumns:"auto auto auto auto",gridGap:"10px",marginLeft:"10px",alignItems:"center"},className:"pp-row-actions",children:[e.jsx(p,{sx:{borderLeft:"1px solid black",height:"100%"}}),e.jsx(O,{title:"Manage App",children:e.jsx(X,{sx:{cursor:"pointer"},underline:"none",onClick:a=>{I(t.appId),a.preventDefault(),a.stopPropagation()},children:"Manage"})}),e.jsx(p,{sx:{borderLeft:"1px solid black",height:"100%"}}),e.jsx(O,{title:"Run & Build App",children:e.jsx(X,{sx:{cursor:"pointer"},underline:"none",onClick:a=>{s(Ye({isActive:!0,appDbId:t.appId})),a.preventDefault(),a.stopPropagation()},children:"Run & Build"})})]})]}),e.jsxs(p,{sx:{display:"grid",gridTemplateColumns:"auto auto auto auto auto auto auto",justifyContent:F?"end":"space-evenly",alignItems:"center"},children:[e.jsx(p,{sx:{paddingRight:"10px"},children:F?"":rt(t.appType)}),e.jsx(O,{title:"Manage App",children:e.jsx(Q,{sx:{color:($=ne)==null?void 0:$.palette.primary.main},onClick:a=>{I(t.appId),a.preventDefault(),a.stopPropagation()},children:e.jsx(Lt,{})})}),e.jsx(O,{title:"Run & Build App",children:e.jsx(Q,{sx:{color:(G=ne)==null?void 0:G.palette.primary.main},onClick:a=>{s(Ye({isActive:!0,appDbId:t.appId})),a.preventDefault(),a.stopPropagation()},children:e.jsx(kt,{})})}),e.jsx(O,{title:"More App actions",children:e.jsx(Q,{sx:{color:(ue=ne)==null?void 0:ue.palette.primary.main},onClick:a=>{E(a.currentTarget),a.preventDefault(),a.stopPropagation()},children:e.jsx(Pt,{})})}),e.jsxs(bs,{id:"pp-app-builder-more-actions",anchorEl:C,open:Y,onClose:()=>{E(null)},MenuListProps:{"aria-labelledby":"pp-app-builder-more-actions"},sx:{zIndex:9999999999},anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"right"},children:[e.jsxs(K,{onClick:a=>{E(null),j(!0),a.preventDefault(),a.stopPropagation()},children:[e.jsx(Ot,{}),e.jsx("span",{style:{margin:"0 10px"},children:"Copy"})]}),e.jsxs(K,{onClick:a=>{E(null),x(!0),a.preventDefault(),a.stopPropagation()},children:[e.jsx(pt,{}),e.jsx("span",{style:{margin:"0 10px"},children:"Export"})]}),e.jsx(js,{text:`[wpda_app app_id="${t.appId}"]`,onCopy:()=>{c(`Shortcode [wpda_app app_id="${t.appId}"] was copied to your clipboard`,{variant:"info"})},children:e.jsxs(K,{onClick:a=>{E(null),a.preventDefault(),a.stopPropagation()},children:[e.jsx(zt,{}),e.jsx("span",{style:{margin:"0 10px"},children:"Shortcode"})]})}),e.jsxs(K,{onClick:a=>{E(null),T(!0),o(!1),a.preventDefault(),a.stopPropagation()},sx:{color:(xe=ne)==null?void 0:xe.palette.error.main},children:[e.jsx(Bt,{}),e.jsx("span",{style:{margin:"0 10px"},children:"Delete"})]})]})]})]}),l&&e.jsx(ie,{title:"Please confirm",message:t.appType==h.APPCONTAINER?"Copy app including detail apps?":"Copy app?",open:l,setOpen:j,onConfirm:()=>M()}),d&&e.jsx(ie,{title:"Please confirm",message:t.appType==h.APPCONTAINER?"Export app including detail apps?":"Export app?",open:d,setOpen:x,onConfirm:()=>D()}),f&&e.jsx(ie,{title:"Delete App?",message:e.jsxs("div",{children:["Are you sure you want to delete app ",t.appName,"?",e.jsx("br",{}),e.jsx("strong",{children:"This action cannot be undone!"}),t.appType==h.APPCONTAINER&&e.jsxs(e.Fragment,{children:[e.jsx("br",{}),e.jsx("br",{}),e.jsx(ee,{children:e.jsx(ot,{control:e.jsx(As,{checked:r,onChange:(a,y)=>{o(y)}}),label:"Delete detail app?"})})]})]}),open:f,setOpen:T,onConfirm:()=>v()})]})},Hs=({apps:t,appApps:i,search:s,types:l,isLoading:j,density:d})=>{n.debug(t,i,s,l);const x=Qs(),f=o=>{if(l.length===0&&s.trim()==="")return!0;if(x&&i[o.appId]){let g=!1;if(i[o.appId].map(I=>{const M=t.filter(D=>D.appId==I)[0];M?(s.trim()!==""&&Ze(M.appName+" "+M.appTitle,s)&&(g=!0),l.filter(D=>D.id===Number(M.appType)).length>0&&(g=!0)):n.error(`Detail app lost? Data App ${o.appId} cannot find detail app ${I}!`)}),g)return!0}return!(!Ze(o.appName+" "+o.appTitle,s)||l.length>0&&l.filter(g=>g.id===Number(o.appType)).length===0)},T=t.filter(o=>f(o)?o:null),r=o=>i[o]?e.jsxs(p,{sx:{marginLeft:d==="small"?"48px":d==="medium"?"56px":"64px","& > div":{borderTop:"1px solid #ddd",borderRadius:"0 !important"}},children:[...i[o].map(g=>{const I=t.filter(M=>M.appId==g);return I.length>0?e.jsx(tt,{app:I[0],density:d}):null})]}):null;return e.jsx(ms,{elevation:4,children:e.jsxs(p,{sx:{backgroundColor:"#fff",borderRadius:"4px",overflow:"hidden","& .MuiBox-root:first-of-type":{borderTopLeftRadius:"4px",borderTopRightRadius:"4px"},"& .MuiBox-root:hover":{backgroundColor:"rgb(242, 242, 242)"},"& .pp-app-details:nth-of-type(odd)":{backgroundColor:"#f9f9f9"}},children:[...t.map(o=>{const g=f(o);return x&&Object.keys(i).filter(I=>i[I].includes(Number(o.appId))).length>0?null:e.jsxs(p,{className:"pp-app-details"+(g?" pp-app-details-visible":""),sx:{visibility:g?"visible":"hidden",position:g?"relative":"fixed",borderTop:"1px solid #ddd","&:first-of-type":{borderTop:"unset"}},children:[e.jsx(tt,{app:o,density:d}),x&&r(o.appId)]})}),T.length===0&&e.jsx(p,{sx:{padding:"35px",borderRadius:"4px"},children:j?e.jsx(ae,{title:"Loading apps...",align:jt.LEFT}):e.jsx(p,{children:"No apps found"})})]})})},ct=()=>{const t=B(i=>i.apps.appList);return n.debug("apps",t),t},Gs=()=>{const t=B(i=>i.apps.app.appDbId);return n.debug("appDbId",t),t},Vs=()=>{const t=B(i=>i.apps.dbSearch);return n.debug("dbSearch",t),t},Ws=()=>{const t=B(i=>i.apps.dbTypes);return n.debug("dbTypes",t),t},Us=()=>{const t=B(i=>i.apps.designMode);return n.debug("designMode",t),t},Ys=()=>{const t=B(i=>i.apps.reload);return n.debug("reload",t),t},ut=()=>{const t=B(i=>i.apps.appMetaData);return n.debug("appMetaData",t),t},$s=({setIsUpdated:t})=>{const i=H(),s=ye(),l=ut(),j=u.useMemo(()=>{const o=[];if((l==null?void 0:l.roles)!==void 0)for(const g in l.roles)o.push({key:g,value:l.roles[g]});return o},[l.roles]);n.debug(j);const d=u.useMemo(()=>{const o=[];if((l==null?void 0:l.users)!==void 0)for(const g in l.users)o.push({key:g,value:l.users[g]});return o},[l.users]);n.debug(d);const x=u.useMemo(()=>j.filter(o=>s.appRestApi.authorized_roles.includes(o.key)),[s.appRestApi.authorized_roles,j]),f=u.useMemo(()=>d.filter(o=>s.appRestApi.authorized_users.includes(o.key)),[s.appRestApi.authorized_users,d]),[T,r]=u.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs("fieldset",{className:"pp-fieldset",children:[e.jsx("legend",{children:"Authorization"}),e.jsx(ee,{sx:{width:"100%"},children:e.jsxs(Ts,{children:[e.jsxs(Xe,{className:"align-label-radio",sx:{cursor:"pointer"},children:[e.jsx(et,{checked:s.appRestApi.authorization===Z.AUTHORIZED,onChange:o=>{i(z({property:{appRestApi:{...s.appRestApi,authorization:Z.AUTHORIZED}}})),t&&t(!0),o.stopPropagation()}}),"Authorized access only"]}),e.jsxs(p,{sx:{display:"grid",gridGap:"10px",margin:"20px 20px 15px 42px"},children:[e.jsx(je,{multiple:!0,options:j,disableCloseOnSelect:!0,getOptionLabel:o=>o.value,value:x,onChange:(o,g)=>{i(z({property:{appRestApi:{...s.appRestApi,authorized_roles:g.map(I=>I.key)}}})),t&&t(!0),o.stopPropagation()},renderInput:o=>e.jsx(V,{...o,label:"Roles"}),renderTags:(o,g)=>o.map((I,M)=>{const{key:D,...A}=g({index:M});return e.jsx(be,{variant:"outlined",label:I.value,...A},D)})}),e.jsx(je,{multiple:!0,options:d,disableCloseOnSelect:!0,getOptionLabel:o=>o.value,value:f,onChange:(o,g)=>{i(z({property:{appRestApi:{...s.appRestApi,authorized_users:g.map(I=>I.key)}}})),t&&t(!0),o.stopPropagation()},renderInput:o=>e.jsx(V,{...o,label:"Users"}),renderTags:(o,g)=>o.map((I,M)=>{const{key:D,...A}=g({index:M});return e.jsx(be,{variant:"outlined",label:I.value,...A},D)})})]}),e.jsxs(Xe,{className:"align-label-radio",sx:{cursor:"pointer"},children:[e.jsx(et,{checked:s.appRestApi.authorization===Z.ANONYMOUS,onChange:o=>{i(z({property:{appRestApi:{...s.appRestApi,authorization:Z.ANONYMOUS}}})),t&&t(!0),o.stopPropagation()}}),"Anonymous access"]})]})})]}),e.jsx(ee,{children:e.jsxs(de,{component:"div",sx:{marginLeft:0},children:[e.jsx(p,{sx:{marginTop:"25px"},children:e.jsxs(X,{sx:{textDecoration:"none",cursor:"pointer",display:"inline-flex","& svg":{fontSize:"1rem",marginRight:"2px"}},onClick:()=>r(!T),children:[e.jsx(Re,{}),"What is the difference between authorized and anonymous access?"]})}),T&&e.jsxs(e.Fragment,{children:[e.jsxs(p,{sx:{marginTop:"20px"},children:[e.jsx("strong",{children:"Authorized access:"}),e.jsxs("ul",{style:{listStyle:"disc",padding:"0 40px"},children:[e.jsx("li",{children:"Users with the selected roles can access this app"}),e.jsx("li",{children:"Selected users can access this app"}),e.jsx("li",{children:"Other registered users cannot access this app"}),e.jsx("li",{children:"Anonymous users cannot access this app"})]})]}),e.jsxs(p,{sx:{marginTop:"20px"},children:[e.jsx("strong",{children:"Anonymous access:"}),e.jsx("ul",{style:{listStyle:"disc",padding:"0 40px"},children:e.jsx("li",{children:"Any user can access this app"})})]}),e.jsx(p,{sx:{marginTop:"20px"},children:"App authorization is applied to both back-end and front-end usage. Back-end access is restricted to registered users only. A Data Table app displayed on the front-end typically allows anonymous access, enabling visitors to view the table. In contrast, Data Management apps usually require authorized access to prevent unauthorized users from altering table data."})]})]})})]})},Js=({app:t,setIsUpdated:i})=>{const s=H(),[l,j]=u.useState(!1),d=ct(),x=d.filter(r=>t.appDbId!==r.appId&&r.appType!=h.APPCONTAINER),f=[];t.appApps.map(r=>{const o=d.filter(g=>g.appId===r);o.length===1&&f.push(o[0])});const T=r=>r.appName+(l?" ("+r.appTitle+")":"");return e.jsxs(ee,{sx:{width:"100%",marginTop:"8px"},children:[e.jsx(je,{multiple:!0,options:x,value:f,disableCloseOnSelect:!0,getOptionLabel:r=>T(r),onChange:(r,o)=>{s(z({property:{appApps:o.map(g=>g.appId)}})),i&&i(!0),r.stopPropagation()},renderInput:r=>e.jsx(V,{...r,label:"Apps"}),renderTags:(r,o)=>r.map((g,I)=>{const{key:M,...D}=o({index:I});return e.jsx(be,{variant:"outlined",label:T(g),...D},M)})}),e.jsxs(de,{component:"div",sx:{display:"grid",gridTemplateColumns:"auto auto",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{children:"Apps will be added in the order they are entered here."}),e.jsx(ot,{sx:{"& span.MuiFormControlLabel-label":{fontSize:"0.75rem"}},control:e.jsx(Cs,{checked:l,onChange:r=>{j(!l),r.stopPropagation()}}),label:"Show title",labelPlacement:"end"})]})]})},Zs=({app:t,hasErrors:i,setIsUpdated:s})=>{n.debug(t,i);const l=H();return e.jsx(V,{type:"text",label:"App Name",error:i,fullWidth:!0,required:!0,helperText:"App name must be unique.",value:t.appName,autoFocus:!0,autoComplete:"off",onChange:j=>{l(z({property:{appName:j.target.value}})),s&&s(!0)}})},Ks=({app:t,hasErrors:i,setIsUpdated:s})=>{n.debug(t,i);const l=H();return e.jsx(V,{type:"text",label:"App Title",error:i,fullWidth:!0,required:!0,helperText:"App title describes the purpose of the app.",value:t.appTitle,autoComplete:"off",onChange:j=>{l(z({property:{appTitle:j.target.value}})),s&&s(!0)}})},Xs=()=>{const t=B(i=>Ae.defaultLanguage.code);return n.debug("appLanguage",t),t},er=({app:t,setIsUpdated:i})=>{n.debug(t);const s=H();ut();const l=Xs(),j=B(f=>{var T,r;return(r=(T=f==null?void 0:f.apps)==null?void 0:T.app)==null?void 0:r.updateSiteLanguage});n.debug("updateSiteLanguage",j),u.useEffect(()=>{const f={appLanguage:Ae.defaultLanguage.code};s(z({property:{appLanguage:f.appLanguage}}))},[]);const[d,x]=u.useState(!1);return e.jsxs(p,{sx:{width:"100%"},children:[e.jsxs(ee,{fullWidth:!0,disabled:!0,children:[e.jsx(lt,{variant:"outlined",children:"App Language"}),e.jsxs(we,{MenuProps:{id:"pp-select-menu"},label:"App Language",value:l,onChange:f=>{},children:[...ys.map(f=>e.jsx(K,{value:f.code,children:f.language},f.code))]}),e.jsx(de,{children:"Selected app language is applied to all (master and detail) tables and forms."})]}),!1,e.jsx(ee,{children:e.jsxs(de,{component:"div",sx:{marginLeft:0},children:[e.jsx(p,{sx:{marginTop:"20px"},children:e.jsxs(X,{sx:{textDecoration:"none",cursor:"pointer",display:"inline-flex","& svg":{fontSize:"1rem",marginRight:"2px"}},onClick:()=>x(!d),children:[e.jsx(Re,{}),"Which app information is localized?"]})}),d&&e.jsxs(e.Fragment,{children:[e.jsxs(p,{sx:{marginTop:"20px"},children:[e.jsx("strong",{children:"Information provided in the selected app language:"}),e.jsxs("ul",{style:{listStyle:"disc",padding:"0 40px"},children:[e.jsx("li",{children:"Tooltips"}),e.jsx("li",{children:"Field labels"}),e.jsx("li",{children:"Field hints"}),e.jsx("li",{children:"Info and success messages"}),e.jsx("li",{children:"Most error messages"})]})]}),e.jsxs(p,{sx:{marginTop:"20px"},children:[e.jsx("strong",{children:"Information not provided in the selected language:"}),e.jsxs("ul",{style:{listStyle:"disc",padding:"0 40px"},children:[e.jsx("li",{children:"Builders, Wizards and Managers are provided in English"}),e.jsx("li",{children:"Database and server errors are not translated"})]})]}),e.jsx(p,{sx:{marginTop:"20px"},children:"If you discover any translation errors, please let us know. We are committed to improving our translations."})]})]})}),e.jsx(Ss,{})]})},tr=()=>{const t=B(i=>i.apps.app.appQuery);return n.debug("appQuery",t),t},sr=({setIsUpdated:t})=>{const i=H(),s=tr(),[l,j]=u.useState({}),[d,x]=u.useState(!1),f=()=>{l!=null&&Object.keys(l).length===0?Rt(Ae.appUrlQueryBuilderList,{},r=>{n.debug(r),r.data!==void 0&&Array.isArray(r.data)?(j(r.data[0]),x(!0)):j({})},()=>{n.error("Error loading Query Builder list."),j({})}):x(!0)},T=r=>{i(bt({appDatabase:l[r].schema_name})),i(z({property:{appQuery:Ke(l[r].query)}})),t&&t(!0)};return e.jsxs(p,{sx:{width:"100%"},children:[e.jsxs(p,{sx:{display:"flex",justifyContent:"flex-end",marginBottom:"5px",position:"relative"},children:[e.jsxs(U,{variant:"contained",onClick:()=>{f()},children:["Import from Query Builder  ",e.jsx(pt,{})]}),d===!0&&l!==void 0&&l!==null&&Object.keys(l).length>0&&e.jsx(p,{sx:{position:"absolute",top:0,right:0},children:e.jsxs(we,{MenuProps:{id:"pp-qb-list"},value:"",variant:"standard",open:d===!0,onClose:()=>{x(!1)},children:[...Object.keys(l).map(r=>e.jsx(K,{value:r,onClick:()=>{x(!1)},sx:{maxWidth:"600px"},children:e.jsxs(oe,{sx:{width:"100%",position:"relative"},children:[e.jsx(Ne,{title:e.jsxs(p,{sx:{width:"100%"},children:[e.jsx("span",{children:r}),e.jsxs(U,{variant:"contained",color:"primary",sx:{position:"absolute",top:"13px",right:"20px",fontWeight:"bold"},onClick:()=>{T(r)},children:["Select  ",e.jsx(De,{})]})]})}),e.jsxs(le,{children:[e.jsxs(ve,{variant:"subtitle1",sx:{display:"grid",gridTemplateColumns:"auto auto",justifyContent:"start",alignItems:"center",gap:"5px",fontWeight:"bold"},children:[e.jsx(Xt,{}),e.jsx("span",{children:l[r].schema_name})]}),e.jsx(vs,{sx:{margin:"20px 0"}}),e.jsx(p,{sx:{whiteSpace:"pre-wrap"},children:Ke(l[r].query)})]})]})}))]})})]}),e.jsx(V,{fullWidth:!0,label:"SQL Query",value:s,required:!0,multiline:!0,minRows:5,maxRows:10,helperText:"Enter a valid SQL query. Test your query in Query Builder before submitting.",variant:"outlined",onChange:r=>{i(z({property:{appQuery:r.target.value}})),t&&t(!0)}})]})},rr=({setMode:t})=>{const i=H(),s=ye(),l=()=>s.appType==h.APPCONTAINER,j=l()?["App info","Apps","Authorization"]:["App info","Data source","Authorization"],[d,x]=u.useState(0);u.useEffect(()=>{let A=null;switch(s.appType){case h.DATATABLE:case h.CHART:A=Z.ANONYMOUS;break;case h.DATAENTRY:case h.MASTERDETAIL:case h.REGISTRATION:case h.UPDATEFORM:case h.APPCONTAINER:A=Z.AUTHORIZED;break}A!==null?i(z({property:{appRestApi:At(A)}})):c(R.contactSupport,{variant:"error"})},[s.appType]);const[f,T]=u.useState({appName:!1,appTitle:!1,appDatabase:!1,appTable:!1,appColumns:!1});n.debug(f);const r=()=>{const A=Is(yt);A.table.transactions.insert=Number(s.appType)===h.DATAENTRY||Number(s.appType)===h.MASTERDETAIL||Number(s.appType)===h.REGISTRATION,A.table.transactions.update=Number(s.appType)===h.DATAENTRY||Number(s.appType)===h.MASTERDETAIL||Number(s.appType)===h.UPDATEFORM||Number(s.appType)===h.REGISTRATION,A.table.transactions.delete=Number(s.appType)===h.DATAENTRY||Number(s.appType)===h.MASTERDETAIL,ls(s,A,v=>{if(n.debug(v),v!=null&&v.code&&(v==null?void 0:v.message)!==void 0)switch(v.code){case"ok":c(v.message,{variant:"success"}),t(P.TABLE),i(ge({}));break;case"info":c(v.message,{variant:"info"});break;default:n.error(v),c(v.message??R.contactSupport,{variant:"error"})}else n.error(v),c(R.contactSupport,{variant:"error"})},v=>{n.error("error",v),c(v??R.contactSupport,{variant:"error"})}),s.updateSiteLanguage&&s.appLanguage!==void 0&&ds(s.appLanguage,()=>{},()=>{})},o=()=>{var v,F,q;let A=!0;if(d===0){let C=!1,E=!1;s.appName.trim()===""&&(c("App name is required",{variant:"error"}),C=!0,A=!1),s.appTitle.trim()===""&&(c("App title is required",{variant:"error"}),E=!0,A=!1),T({...f,appName:C,appTitle:E})}if(d===1){let C=!1,E=!1,Y=!1,$=!1;l()?s.appApps.length===0&&c("No apps added",{variant:"info"}):(((v=s.appDatabase)==null?void 0:v.trim())===""&&(c("Database is required",{variant:"error"}),C=!0,A=!1),s.appType==h.CHART?((F=s.appQuery)==null?void 0:F.trim())===""&&(c("SQL query is required",{variant:"error"}),$=!0,A=!1):(((q=s.appTable)==null?void 0:q.trim())===""&&(c("Table is required",{variant:"error"}),E=!0,A=!1),s.appColumns.filter(G=>G.isSelected===!0).length===0&&(c("No columns selected",{variant:"error"}),Y=!0,A=!1))),T({...f,appDatabase:C,appTable:E,appQuery:$,appColumns:Y})}return d===j.length-1&&r(),n.debug(A),A},g=()=>e.jsxs(p,{sx:{textAlign:"right",display:"grid",gridTemplateColumns:"auto auto",justifyContent:"space-between",alignItems:"center"},children:[d>0?e.jsx(U,{variant:"outlined",size:"medium",sx:{width:"160px",marginRight:"10px"},onClick:()=>{x(d-1)},startIcon:e.jsx(Ft,{}),children:e.jsx(p,{children:"Back"})}):e.jsx(p,{}),e.jsx(U,{variant:"contained",size:"medium",sx:{width:"160px"},onClick:()=>{o()&&d<j.length-1&&x(d+1)},startIcon:d>=j.length-1&&e.jsx(qt,{}),endIcon:d<j.length-1&&e.jsx(De,{}),children:e.jsx(p,{children:d<j.length-1?"Next":"Finish"})})]}),I=()=>e.jsxs(e.Fragment,{children:[e.jsx(Zs,{app:s,hasErrors:f.appName}),e.jsx(Ks,{app:s,hasErrors:f.appName}),e.jsx(er,{app:s}),g()]}),M=()=>l()?e.jsxs(e.Fragment,{children:[e.jsx(Js,{app:s}),g()]}):e.jsxs(e.Fragment,{children:[e.jsx(ts,{}),e.jsx(p,{sx:{display:s.appDatabase?"block":"none"},children:s.appType==h.CHART?e.jsx(sr,{}):e.jsx(ss,{})}),s.appType!=h.CHART&&e.jsx(p,{sx:{display:s.appTable?"block":"none"},children:e.jsx(rs,{app:s})}),g()]}),D=()=>e.jsxs(e.Fragment,{children:[e.jsx(p,{children:e.jsx($s,{})}),g()]});return e.jsxs(e.Fragment,{children:[e.jsx(Rs,{activeStep:d,sx:{margin:"10px 0 30px 0"},children:j.map((A,v)=>(n.debug(A,v),e.jsx(Ds,{children:e.jsx(ws,{children:A})},A)))}),e.jsxs("form",{onSubmit:A=>(A.preventDefault(),o()&&x(d+1),!1),style:{display:"grid",gridGap:"40px"},children:[d===0&&I(),d===1&&M(),d===2&&D(),e.jsx("input",{type:"submit",style:{display:"none"}})]})]})},ar=({app:t,isNew:i,setIsUpdated:s})=>{n.debug(t);const l=H(),j=at(),d=i?"Select App Type *":"App Type *";return e.jsxs(ee,{fullWidth:!0,children:[e.jsx(lt,{variant:"outlined",children:d}),e.jsxs(we,{MenuProps:{id:"pp-select-menu"},label:d,value:t.appType,disabled:i!==!0&&(t.appType==h.APPCONTAINER||t.appType==h.REGISTRATION||t.appType==h.CHART),onChange:x=>{l(z({property:{appType:x.target.value}})),s&&s(!0)},sx:{"& .MuiSelect-select":{display:"flex",alignItems:"center"}},children:[...j.map(x=>{let f=x.id==h.DATATABLE||x.id==h.DATAENTRY||x.id==h.REGISTRATION||x.id==h.APPCONTAINER||x.id==h.CHART;return i!==!0&&(x.id==h.APPCONTAINER||x.id==h.REGISTRATION||x.id==h.CHART)&&(f=!1),e.jsxs(K,{value:x.id,disabled:!f,children:[e.jsx(Ns,{sx:{minWidth:"unset"},children:e.jsx(dt,{appType:x.id})}),e.jsx(Ms,{children:x.text})]})})]}),e.jsxs(de,{children:["Select ",e.jsx("strong",{children:"Data Table"})," to create a read-only app, or ",e.jsx("strong",{children:"Data Administration"})," to enable transactions. To create an app that contains one or more other apps, select ",e.jsx("strong",{children:"Data App"}),"."]})]})},nr=({setMode:t})=>{const i=ye();n.debug(i);const[s,l]=u.useState(!1),[j,d]=u.useState(!1),x=s?`Add new ${rt(i.appType)} app`:"Add new app";return e.jsxs(e.Fragment,{children:[e.jsxs(oe,{sx:{padding:"50px 70px 40px 70px",display:"grid",gridGap:"40px"},elevation:4,children:[e.jsxs(p,{sx:{display:"grid",gridTemplateColumns:"auto auto",justifyContent:"space-between",alignItems:"start"},children:[e.jsx(Ne,{title:"App Wizard",subheader:x,sx:{padding:0}}),e.jsx(p,{children:e.jsx(O,{title:"Close",children:e.jsx(X,{sx:{cursor:"pointer"},underline:"none",onClick:f=>{d(!0),f.preventDefault(),f.stopPropagation()},children:e.jsx(p,{sx:{fontSize:"1.5rem",color:"#000"},children:e.jsx(Ie,{})})})})})]}),e.jsx(le,{sx:{padding:0,display:"grid",gridGap:"30px"},children:s?e.jsx(rr,{setMode:t}):e.jsxs(p,{sx:{display:"grid",gap:"10px"},children:[e.jsx(ar,{app:i,isNew:!0}),e.jsx(p,{sx:{textAlign:"end"},children:e.jsx(U,{variant:"contained",size:"medium",endIcon:e.jsx(De,{}),onClick:()=>{l(!0)},sx:{width:"160px"},children:"Start Wizard"})})]})})]}),e.jsx(ie,{title:"Close App Wizard?",message:"All uncommitted changes will be lost!",open:j,setOpen:d,onConfirm:()=>{t(P.TABLE)}})]})},ir=({close:t})=>{const[i,s]=u.useState(""),[l,j]=u.useState(""),[d,x]=u.useState(!1),[f,T]=u.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs(oe,{sx:{padding:"50px 70px 40px 70px",display:"grid",gridGap:"40px"},elevation:4,children:[e.jsxs(p,{sx:{display:"grid",gridTemplateColumns:"auto auto",justifyContent:"space-between",alignItems:"start"},children:[e.jsx(Ne,{title:"Rename Database",sx:{padding:0}}),e.jsx(p,{children:e.jsx(O,{title:"Close",children:e.jsx(X,{sx:{cursor:"pointer"},underline:"none",onClick:r=>{t(),r.preventDefault(),r.stopPropagation()},children:e.jsx(p,{sx:{fontSize:"1.5rem",color:"#000"},children:e.jsx(Ie,{})})})})})]}),e.jsxs(le,{sx:{padding:0,display:"grid",gridGap:"30px"},children:[e.jsx(V,{type:"text",label:"Old Database Name",fullWidth:!0,required:!0,value:i,onChange:r=>{s(r.target.value)}}),e.jsx(V,{type:"text",label:"New Database Name",fullWidth:!0,required:!0,value:l,onChange:r=>{j(r.target.value)}}),e.jsxs(p,{sx:{display:"grid",gridTemplateColumns:"auto auto",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(X,{sx:{textDecoration:"none",cursor:"pointer",display:"inline-flex","& svg":{fontSize:"1rem",marginRight:"2px"}},onClick:()=>x(!d),children:[e.jsx(Re,{}),"Manually updating database names"]}),e.jsx(U,{disabled:i.trim()===""||l.trim()==="",variant:"contained",sx:{width:"120px"},onClick:()=>{T(!0)},children:"Rename"})]}),d&&e.jsxs(p,{children:[e.jsx(p,{children:"When databases or tables are renamed or transferred using external tools, the stored database name in the repository may need updating. The Rename Database feature automatically updates all instances of the old database name to the new one across all app types and legacy tools."}),e.jsxs(p,{sx:{"& ul":{listStyleType:"disc",paddingLeft:"30px"}},children:[e.jsx("h3",{children:"Usage"}),e.jsxs("ul",{children:[e.jsx("li",{children:"After exporting a WordPress website to a new server"}),e.jsx("li",{children:"After renaming or moving databases or tables with external tools"})]})]})]})]})]}),f&&e.jsx(ie,{title:"Rename Database?",message:e.jsxs(p,{children:["Are you sure you want to replace all occurrences of ",e.jsxs("strong",{children:["`",i,"`"]})," with ",e.jsxs("strong",{children:["`",l,"`"]}),"?",e.jsx("br",{}),e.jsx("br",{}),e.jsx("strong",{children:"This action cannot be undone!"})]}),open:f,setOpen:T,onConfirm:()=>cs(i,l,r=>{if(r!=null&&r.code&&(r==null?void 0:r.message)!==void 0)switch(r.code){case"ok":c(r.message,{variant:"success"});break;case"info":c(r.message,{variant:"info"});break;default:n.error(r),c(r.message??R.contactSupport,{variant:"error"})}else n.error(r),c(R.contactSupport,{variant:"error"})},r=>{n.error(r),c(r??R.contactSupport,{variant:"error"})})})]})},pr=()=>{const t=H(),i=u.useMemo(()=>Tt(),[]),[s,l]=u.useState(P.TABLE);n.debug(s),u.useEffect(()=>{try{const m=localStorage.getItem("ppAppsDbsSearch");m!==null&&t(J({property:"dbSearch",propertyValue:m}));const S=localStorage.getItem("ppAppsDbsSearchType");if(S!==null){const W=JSON.parse(S);t(J({property:"dbTypes",propertyValue:W}))}localStorage.getItem("ppAppsShowStructure")==="false"&&t(J({property:"showAppStructure",propertyValue:!1}))}catch(m){n.debug(m)}window.ppActionRenameDatabase=function(){A(!0)}},[]);const j=ct(),d=ks(),x=Gs(),f=Vs(),T=Ws(),r=Us(),o=Ys(),g=m=>{m?(window.document.documentElement.style.setProperty("--addRenameDatabaseVisibility","visible"),window.document.documentElement.style.setProperty("--addAppIconVisibility","visible")):(window.document.documentElement.style.setProperty("--addRenameDatabaseVisibility","hidden"),window.document.documentElement.style.setProperty("--addAppIconVisibility","hidden"))},[I,M]=u.useState(!0),[D,A]=u.useState(!1);u.useEffect(()=>{g(!D)},[D]),u.useEffect(()=>{F(),v()},[o]);const v=()=>{us(function(m){const S=m==null?void 0:m.data;n.debug("response data",S);const k=m==null?void 0:m.context;if(n.debug("response context",k),Array.isArray(S)){const W=[];for(let _=0;_<S.length;_++)W.push({appId:S[_].app_id,appName:S[_].app_name,appTitle:S[_].app_title,appType:S[_].app_type,appSettings:S[_].app_settings,appAddToMenu:S[_].app_add_to_menu});const se=k.reduce((_,me)=>{const{app_id:re,app_id_detail:he}=me;return _[re]=_[re]??[],_[re].push(Number(he)),_},{});t(Te({appList:W,appApps:se}))}else n.error(S),c((S==null?void 0:S.message)??R.contactSupport,{variant:"error"}),t(Te({appList:[],appApps:[]}));M(!1)},m=>{n.error("error",m),c(m??R.contactSupport,{variant:"error"}),t(Te({appList:[],appApps:[]})),M(!1)})},F=()=>{xs(function(m){const S=m==null?void 0:m.data;n.debug("response data",S),t(St({appMetaData:S}))},m=>{n.error("error",m),c(m??R.contactSupport,{variant:"error"})})};u.useEffect(()=>{s===P.TABLE&&F()},[s]),u.useEffect(()=>{Ae.appPlugin&&(window.ppActionCreateApp=function(){s===0&&!(r.isActive===!0&&r.appDbId>0)&&l(P.FORM)},g(!(s===1||r.isActive===!0&&r.appDbId>0)))},[s,r]);const q=fe("(max-width: 600px)"),C=fe("(max-width: 900px)"),E=vt(),Y=at();n.debug(Y);const $=u.useRef(),G=()=>r.isActive===!0&&r.appDbId>0,ue=()=>e.jsx(O,{title:"Add new app",children:e.jsx(Q,{sx:{color:"inherit"},onClick:()=>{t(st({})),l(P.FORM)},children:e.jsx(Yt,{})})}),xe=()=>e.jsx(O,{title:"Rename Database",children:e.jsx(Q,{sx:{color:"inherit"},onClick:()=>{A(!D)},children:e.jsx(Es,{})})}),a={};G()&&(a.visibility="hidden");let y="smell";try{y=localStorage.getItem("ppAppsDensity")}catch(m){n.debug(m)}const[w,te]=u.useState(y==="large"||y==="medium"?y:"small");return u.useEffect(()=>{try{localStorage.setItem("ppAppsDensity",w)}catch(m){n.debug(m)}},[w]),e.jsxs(It,{theme:E,children:[e.jsxs(p,{className:"pp-applist",sx:{width:"100%",visibility:G()?"hidden":"visible",position:G()?"fixed":"auto",height:G()?0:"auto",...G()&&{visibility:"hidden",position:"absolute",left:-99999,top:-99999},"& .pp-app-details":{...a}},children:[e.jsx(nt,{position:"relative",elevation:4,sx:{margin:"0 0 5px 0"},children:e.jsxs(it,{className:"pp-applist-toolbar",sx:{display:"grid",gap:"12px",paddingRight:"12px !important",...q?{gap:0,paddingRight:"10px",paddingBottom:"10px",paddingLeft:"10px","& .pp-applist-search":{gridTemplateColumns:"1fr",gridGap:"2px"}}:{...C?{gap:0,paddingRight:"10px",paddingBottom:"10px",paddingLeft:"10px","& .pp-applist-search":{justifyContent:"end",gridTemplateColumns:"auto auto auto"}}:{justifyContent:"space-between",gridTemplateColumns:"auto 1fr"}}},children:[e.jsxs(p,{className:"pp-applist-title",sx:{display:"inline-grid",gridTemplateColumns:"auto auto auto",justifyContent:"start",alignItems:"center",gridGap:"10px"},children:[e.jsx(p,{sx:{fontSize:"18px",lineHeight:"18px",fontWeight:"bold",whiteSpace:"nowrap"},children:"Apps"}),e.jsxs(p,{sx:{display:"inline-grid",gridTemplateColumns:"auto auto",justifyContent:"start",alignItems:"center"},children:[e.jsx(p,{children:s===P.TABLE&&!D&&e.jsx(e.Fragment,{children:ue()})}),e.jsx(p,{children:s===P.TABLE&&!D&&e.jsx(e.Fragment,{children:xe()})})]})]}),e.jsxs(p,{className:"pp-applist-search",sx:{display:"grid",gridTemplateColumns:"auto auto auto",gridGap:"10px",justifyContent:"end",alignItems:"center"},children:[e.jsxs(p,{children:[e.jsx(O,{title:"App View",children:e.jsx(Q,{onClick:()=>{t(J({property:"showAppStructure",propertyValue:!0}));try{localStorage.setItem("ppAppsShowStructure","true")}catch(m){n.debug(m)}},sx:{color:"#fff"},children:e.jsx(Qt,{})})}),e.jsx(O,{title:"List View",children:e.jsx(Q,{onClick:()=>{t(J({property:"showAppStructure",propertyValue:!1}));try{localStorage.setItem("ppAppsShowStructure","false")}catch(m){n.debug(m)}},sx:{color:"#fff"},children:e.jsx(Ht,{})})}),e.jsx(O,{title:"Toggle density",children:e.jsx(Q,{onClick:()=>{te(w==="large"?"medium":w==="medium"?"small":"large")},sx:{color:"#fff"},children:w==="small"?e.jsx(Gt,{}):w==="medium"?e.jsx(Vt,{}):e.jsx(Wt,{})})})]}),e.jsx(V,{value:f,type:"search",placeholder:"Search",disabled:s===P.FORM,onChange:m=>{t(J({property:"dbSearch",propertyValue:m.target.value}));try{localStorage.setItem("ppAppsDbsSearch",m.target.value)}catch(S){n.debug(S)}},sx:{backgroundColor:"#fff",fontSize:"1em",margin:0,padding:0,borderRadius:"4px","&.MuiFormControl-root.MuiTextField-root .MuiInputBase-root":{paddingRight:0},"&.MuiFormControl-root.MuiTextField-root input":{padding:"8px"}},slotProps:{input:{startAdornment:e.jsx(Ls,{position:"end",sx:{fontSize:"1.5rem",padding:0,margin:0},children:e.jsx(Ut,{})})}}}),e.jsx(je,{multiple:!0,size:"small",options:Y,getOptionLabel:m=>m.text,isOptionEqualToValue:(m,S)=>m.id===S.id,value:T,disableCloseOnSelect:!0,disabled:s===P.FORM,onChange:(m,S)=>{t(J({property:"dbTypes",propertyValue:S.map(k=>({id:k.id,text:Object.values(Ct)[k.id]}))}));try{localStorage.setItem("ppAppsDbsSearchType",JSON.stringify(S))}catch(k){n.debug(k)}},renderInput:m=>e.jsx(p,{ref:$,children:e.jsx(V,{...m,sx:{minWidth:"250px","& .MuiInputBase-root":{backgroundColor:"#fff",padding:"0",maxHeight:"39px",overflow:"hidden"},"& .MuiButtonBase-root.MuiChip-root.MuiAutocomplete-tag":{height:"auto"}},placeholder:T.length===0?"Select app types":""})}),renderTags:(m,S)=>m.map((k,W)=>{const{key:se,..._}=S({index:W});return e.jsx(be,{variant:"outlined",label:k.text,..._},se)})})]})]})}),D?e.jsx(ir,{close:()=>A(!1)}):e.jsxs(e.Fragment,{children:[s===P.TABLE&&e.jsx(Hs,{apps:j,appApps:d,search:f,types:T,isLoading:I,density:w}),s===P.FORM&&e.jsx(nr,{setMode:l}),x!==0&&x!==void 0&&e.jsx(qs,{appDbId:x})]})]}),r.isActive===!0&&r.appDbId>0&&e.jsx(_s,{appId:i,appDbId:r.appDbId,designMode:!0,isExploring:!0})]})},ea=Object.freeze(Object.defineProperty({__proto__:null,default:pr},Symbol.toStringTag,{value:"Module"}));export{Zs as A,sr as C,Ks as a,ar as b,er as c,Js as d,$s as e,ea as f};
