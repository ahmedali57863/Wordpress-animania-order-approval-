import{j as s}from"./cm-1.0.35--NMEhA6K.js";import{B as $,ad as Jn,an as Qn,f as Zn,M as er,l as Ae,m as nt,w as tr,n as nr,k as jt,j as rr,v as fn}from"./cjs-1.0.35-B75n3jry.js";import{D as ot}from"./useTheme-1.0.35-DvysJ9Pk.js";import{l as L,bu as sr,a2 as or,N as ir,S as Rt,b as Et,a9 as hn,bB as qt,aB as lr}from"./lib-1.0.35-vCbYWOI3.js";import{r as a,R as X}from"./redux-1.0.35-xa1uZ5t4.js";import{u as ar}from"./useStoreTable-1.0.35-BoSxKhPI.js";import{r as Ue,e as xt}from"./notistack-1.0.35-C7EWtXAA.js";import{u as cr}from"./useFormStore-1.0.35-TLrcUzfK.js";import{u as pn}from"./RestApi-1.0.35-Bt-tzntO.js";import{B as R}from"./Spinner-1.0.35-Dd1TcgqP.js";import{A as Dt}from"./AdminTheme-1.0.35-BtyHaBRh.js";import{e as dr,f as ur}from"./index-1.0.35-Bey3P_99.js";import{a as fr,b as hr,c as pr}from"./ActionsDml-1.0.35-BvngWXxi.js";import{s as gr,p as br,q as xr,t as mr}from"./index-1.0.35-DHBDMhlb.js";import{S as $e,T as ve}from"./TextField-1.0.35-B1uB0pL3.js";import{M as fe}from"./MenuItem-1.0.35-DJ1Zxsyh.js";import{I as vr}from"./iconBase-1.0.35-CEh1aNes.js";import{M as yr}from"./Menu-1.0.35-3APgaaPr.js";import{c as mt}from"./index-1.0.35-ChYeyr_I.js";import{u as gn}from"./useTableUpdater-1.0.35-Du0YkN1k.js";import{S as wr,a as Cr,b as Sr}from"./Stepper-1.0.35-B-Cu3w2D.js";import{S as jr}from"./StepContent-1.0.35-D2uWS0po.js";import{F as Ie,a as ie}from"./FormHelperText-1.0.35-BubqYRHL.js";import{F as bn}from"./FormControlLabel-1.0.35-DFi_cuDq.js";import{C as Rr}from"./Checkbox-1.0.35-DB1d6Tfc.js";import{F as Jt}from"./FormLabel-1.0.35-DqGGwQsT.js";import{b as Er}from"./ConfirmDialog-1.0.35-5-r3Xts8.js";import{L as kt}from"./Link-1.0.35-CxbvVS8_.js";import{A as xn,a as mn}from"./AccordionSummary-1.0.35-Do5lpUEE.js";import{A as vn}from"./AccordionDetails-1.0.35-CUwNn0VM.js";import{S as Dr}from"./Switch-1.0.35-Z50HBuFJ.js";function kr(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return a.useMemo(()=>r=>{t.forEach(o=>o(r))},t)}const ut=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Oe(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function Lt(e){return"nodeType"in e}function H(e){var t,n;return e?Oe(e)?e:Lt(e)&&(t=(n=e.ownerDocument)==null?void 0:n.defaultView)!=null?t:window:window}function Mt(e){const{Document:t}=H(e);return e instanceof t}function qe(e){return Oe(e)?!1:e instanceof H(e).HTMLElement}function yn(e){return e instanceof H(e).SVGElement}function Le(e){return e?Oe(e)?e.document:Lt(e)?Mt(e)?e:qe(e)||yn(e)?e.ownerDocument:document:document:document}const le=ut?a.useLayoutEffect:a.useEffect;function Ft(e){const t=a.useRef(e);return le(()=>{t.current=e}),a.useCallback(function(){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t.current==null?void 0:t.current(...r)},[])}function Tr(){const e=a.useRef(null),t=a.useCallback((r,o)=>{e.current=setInterval(r,o)},[]),n=a.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,n]}function Ke(e,t){t===void 0&&(t=[e]);const n=a.useRef(e);return le(()=>{n.current!==e&&(n.current=e)},t),n}function Je(e,t){const n=a.useRef();return a.useMemo(()=>{const r=e(n.current);return n.current=r,r},[...t])}function it(e){const t=Ft(e),n=a.useRef(null),r=a.useCallback(o=>{o!==n.current&&(t==null||t(o,n.current)),n.current=o},[]);return[n,r]}function Tt(e){const t=a.useRef();return a.useEffect(()=>{t.current=e},[e]),t.current}let vt={};function Qe(e,t){return a.useMemo(()=>{if(t)return t;const n=vt[e]==null?0:vt[e]+1;return vt[e]=n,e+"-"+n},[e,t])}function wn(e){return function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return r.reduce((i,l)=>{const c=Object.entries(l);for(const[d,u]of c){const h=i[d];h!=null&&(i[d]=h+e*u)}return i},{...t})}}const Ne=wn(1),lt=wn(-1);function Ar(e){return"clientX"in e&&"clientY"in e}function Pt(e){if(!e)return!1;const{KeyboardEvent:t}=H(e.target);return t&&e instanceof t}function Ir(e){if(!e)return!1;const{TouchEvent:t}=H(e.target);return t&&e instanceof t}function At(e){if(Ir(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:n}=e.touches[0];return{x:t,y:n}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:n}=e.changedTouches[0];return{x:t,y:n}}}return Ar(e)?{x:e.clientX,y:e.clientY}:null}const Ge=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:n}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:n}=e;return"scaleX("+t+") scaleY("+n+")"}},Transform:{toString(e){if(e)return[Ge.Translate.toString(e),Ge.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:n,easing:r}=e;return t+" "+n+"ms "+r}}}),Qt="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function Nr(e){return e.matches(Qt)?e:e.querySelector(Qt)}const Or={display:"none"};function Lr(e){let{id:t,value:n}=e;return X.createElement("div",{id:t,style:Or},n)}function Mr(e){let{id:t,announcement:n,ariaLiveType:r="assertive"}=e;const o={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return X.createElement("div",{id:t,style:o,role:"status","aria-live":r,"aria-atomic":!0},n)}function Fr(){const[e,t]=a.useState("");return{announce:a.useCallback(r=>{r!=null&&t(r)},[]),announcement:e}}const Cn=a.createContext(null);function Pr(e){const t=a.useContext(Cn);a.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function Br(){const[e]=a.useState(()=>new Set),t=a.useCallback(r=>(e.add(r),()=>e.delete(r)),[e]);return[a.useCallback(r=>{let{type:o,event:i}=r;e.forEach(l=>{var c;return(c=l[o])==null?void 0:c.call(l,i)})},[e]),t]}const Wr={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},_r={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was moved over droppable area "+n.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was dropped over droppable area "+n.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function zr(e){let{announcements:t=_r,container:n,hiddenTextDescribedById:r,screenReaderInstructions:o=Wr}=e;const{announce:i,announcement:l}=Fr(),c=Qe("DndLiveRegion"),[d,u]=a.useState(!1);if(a.useEffect(()=>{u(!0)},[]),Pr(a.useMemo(()=>({onDragStart(f){let{active:b}=f;i(t.onDragStart({active:b}))},onDragMove(f){let{active:b,over:g}=f;t.onDragMove&&i(t.onDragMove({active:b,over:g}))},onDragOver(f){let{active:b,over:g}=f;i(t.onDragOver({active:b,over:g}))},onDragEnd(f){let{active:b,over:g}=f;i(t.onDragEnd({active:b,over:g}))},onDragCancel(f){let{active:b,over:g}=f;i(t.onDragCancel({active:b,over:g}))}}),[i,t])),!d)return null;const h=X.createElement(X.Fragment,null,X.createElement(Lr,{id:r,value:o.draggable}),X.createElement(Mr,{id:c,announcement:l}));return n?Ue.createPortal(h,n):h}var B;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(B||(B={}));function at(){}function yt(e,t){return a.useMemo(()=>({sensor:e,options:{}}),[e,t])}function Ur(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return a.useMemo(()=>[...t].filter(r=>r!=null),[...t])}const te=Object.freeze({x:0,y:0});function $r(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function Yr(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return n-r}function Xr(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return r-n}function Hr(e,t){if(!e||e.length===0)return null;const[n]=e;return n[t]}function Zt(e,t,n){return t===void 0&&(t=e.left),n===void 0&&(n=e.top),{x:t+e.width*.5,y:n+e.height*.5}}const Kr=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const o=Zt(t,t.left,t.top),i=[];for(const l of r){const{id:c}=l,d=n.get(c);if(d){const u=$r(Zt(d),o);i.push({id:c,data:{droppableContainer:l,value:u}})}}return i.sort(Yr)};function Gr(e,t){const n=Math.max(t.top,e.top),r=Math.max(t.left,e.left),o=Math.min(t.left+t.width,e.left+e.width),i=Math.min(t.top+t.height,e.top+e.height),l=o-r,c=i-n;if(r<o&&n<i){const d=t.width*t.height,u=e.width*e.height,h=l*c,f=h/(d+u-h);return Number(f.toFixed(4))}return 0}const Vr=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const o=[];for(const i of r){const{id:l}=i,c=n.get(l);if(c){const d=Gr(c,t);d>0&&o.push({id:l,data:{droppableContainer:i,value:d}})}}return o.sort(Xr)};function qr(e,t,n){return{...e,scaleX:t&&n?t.width/n.width:1,scaleY:t&&n?t.height/n.height:1}}function Sn(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:te}function Jr(e){return function(n){for(var r=arguments.length,o=new Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];return o.reduce((l,c)=>({...l,top:l.top+e*c.y,bottom:l.bottom+e*c.y,left:l.left+e*c.x,right:l.right+e*c.x}),{...n})}}const Qr=Jr(1);function Zr(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function es(e,t,n){const r=Zr(t);if(!r)return e;const{scaleX:o,scaleY:i,x:l,y:c}=r,d=e.left-l-(1-o)*parseFloat(n),u=e.top-c-(1-i)*parseFloat(n.slice(n.indexOf(" ")+1)),h=o?e.width/o:e.width,f=i?e.height/i:e.height;return{width:h,height:f,top:u,right:d+h,bottom:u+f,left:d}}const ts={ignoreTransform:!1};function Me(e,t){t===void 0&&(t=ts);let n=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:u,transformOrigin:h}=H(e).getComputedStyle(e);u&&(n=es(n,u,h))}const{top:r,left:o,width:i,height:l,bottom:c,right:d}=n;return{top:r,left:o,width:i,height:l,bottom:c,right:d}}function en(e){return Me(e,{ignoreTransform:!0})}function ns(e){const t=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:t,bottom:n,width:t,height:n}}function rs(e,t){return t===void 0&&(t=H(e).getComputedStyle(e)),t.position==="fixed"}function ss(e,t){t===void 0&&(t=H(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(o=>{const i=t[o];return typeof i=="string"?n.test(i):!1})}function Bt(e,t){const n=[];function r(o){if(t!=null&&n.length>=t||!o)return n;if(Mt(o)&&o.scrollingElement!=null&&!n.includes(o.scrollingElement))return n.push(o.scrollingElement),n;if(!qe(o)||yn(o)||n.includes(o))return n;const i=H(e).getComputedStyle(o);return o!==e&&ss(o,i)&&n.push(o),rs(o,i)?n:r(o.parentNode)}return e?r(e):n}function jn(e){const[t]=Bt(e,1);return t??null}function wt(e){return!ut||!e?null:Oe(e)?e:Lt(e)?Mt(e)||e===Le(e).scrollingElement?window:qe(e)?e:null:null}function Rn(e){return Oe(e)?e.scrollX:e.scrollLeft}function En(e){return Oe(e)?e.scrollY:e.scrollTop}function It(e){return{x:Rn(e),y:En(e)}}var W;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(W||(W={}));function Dn(e){return!ut||!e?!1:e===document.scrollingElement}function kn(e){const t={x:0,y:0},n=Dn(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},r={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height},o=e.scrollTop<=t.y,i=e.scrollLeft<=t.x,l=e.scrollTop>=r.y,c=e.scrollLeft>=r.x;return{isTop:o,isLeft:i,isBottom:l,isRight:c,maxScroll:r,minScroll:t}}const os={x:.2,y:.2};function is(e,t,n,r,o){let{top:i,left:l,right:c,bottom:d}=n;r===void 0&&(r=10),o===void 0&&(o=os);const{isTop:u,isBottom:h,isLeft:f,isRight:b}=kn(e),g={x:0,y:0},p={x:0,y:0},m={height:t.height*o.y,width:t.width*o.x};return!u&&i<=t.top+m.height?(g.y=W.Backward,p.y=r*Math.abs((t.top+m.height-i)/m.height)):!h&&d>=t.bottom-m.height&&(g.y=W.Forward,p.y=r*Math.abs((t.bottom-m.height-d)/m.height)),!b&&c>=t.right-m.width?(g.x=W.Forward,p.x=r*Math.abs((t.right-m.width-c)/m.width)):!f&&l<=t.left+m.width&&(g.x=W.Backward,p.x=r*Math.abs((t.left+m.width-l)/m.width)),{direction:g,speed:p}}function ls(e){if(e===document.scrollingElement){const{innerWidth:i,innerHeight:l}=window;return{top:0,left:0,right:i,bottom:l,width:i,height:l}}const{top:t,left:n,right:r,bottom:o}=e.getBoundingClientRect();return{top:t,left:n,right:r,bottom:o,width:e.clientWidth,height:e.clientHeight}}function Tn(e){return e.reduce((t,n)=>Ne(t,It(n)),te)}function as(e){return e.reduce((t,n)=>t+Rn(n),0)}function cs(e){return e.reduce((t,n)=>t+En(n),0)}function ds(e,t){if(t===void 0&&(t=Me),!e)return;const{top:n,left:r,bottom:o,right:i}=t(e);jn(e)&&(o<=0||i<=0||n>=window.innerHeight||r>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const us=[["x",["left","right"],as],["y",["top","bottom"],cs]];class Wt{constructor(t,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=Bt(n),o=Tn(r);this.rect={...t},this.width=t.width,this.height=t.height;for(const[i,l,c]of us)for(const d of l)Object.defineProperty(this,d,{get:()=>{const u=c(r),h=o[i]-u;return this.rect[d]+h},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class Ye{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var r;return(r=this.target)==null?void 0:r.removeEventListener(...n)})},this.target=t}add(t,n,r){var o;(o=this.target)==null||o.addEventListener(t,n,r),this.listeners.push([t,n,r])}}function fs(e){const{EventTarget:t}=H(e);return e instanceof t?e:Le(e)}function Ct(e,t){const n=Math.abs(e.x),r=Math.abs(e.y);return typeof t=="number"?Math.sqrt(n**2+r**2)>t:"x"in t&&"y"in t?n>t.x&&r>t.y:"x"in t?n>t.x:"y"in t?r>t.y:!1}var Z;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(Z||(Z={}));function tn(e){e.preventDefault()}function hs(e){e.stopPropagation()}var A;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(A||(A={}));const An={start:[A.Space,A.Enter],cancel:[A.Esc],end:[A.Space,A.Enter,A.Tab]},ps=(e,t)=>{let{currentCoordinates:n}=t;switch(e.code){case A.Right:return{...n,x:n.x+25};case A.Left:return{...n,x:n.x-25};case A.Down:return{...n,y:n.y+25};case A.Up:return{...n,y:n.y-25}}};class In{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:n}}=t;this.props=t,this.listeners=new Ye(Le(n)),this.windowListeners=new Ye(H(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(Z.Resize,this.handleCancel),this.windowListeners.add(Z.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(Z.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:n}=this.props,r=t.node.current;r&&ds(r),n(te)}handleKeyDown(t){if(Pt(t)){const{active:n,context:r,options:o}=this.props,{keyboardCodes:i=An,coordinateGetter:l=ps,scrollBehavior:c="smooth"}=o,{code:d}=t;if(i.end.includes(d)){this.handleEnd(t);return}if(i.cancel.includes(d)){this.handleCancel(t);return}const{collisionRect:u}=r.current,h=u?{x:u.left,y:u.top}:te;this.referenceCoordinates||(this.referenceCoordinates=h);const f=l(t,{active:n,context:r.current,currentCoordinates:h});if(f){const b=lt(f,h),g={x:0,y:0},{scrollableAncestors:p}=r.current;for(const m of p){const y=t.code,{isTop:S,isRight:j,isLeft:C,isBottom:k,maxScroll:v,minScroll:E}=kn(m),D=ls(m),w={x:Math.min(y===A.Right?D.right-D.width/2:D.right,Math.max(y===A.Right?D.left:D.left+D.width/2,f.x)),y:Math.min(y===A.Down?D.bottom-D.height/2:D.bottom,Math.max(y===A.Down?D.top:D.top+D.height/2,f.y))},M=y===A.Right&&!j||y===A.Left&&!C,P=y===A.Down&&!k||y===A.Up&&!S;if(M&&w.x!==f.x){const O=m.scrollLeft+b.x,x=y===A.Right&&O<=v.x||y===A.Left&&O>=E.x;if(x&&!b.y){m.scrollTo({left:O,behavior:c});return}x?g.x=m.scrollLeft-O:g.x=y===A.Right?m.scrollLeft-v.x:m.scrollLeft-E.x,g.x&&m.scrollBy({left:-g.x,behavior:c});break}else if(P&&w.y!==f.y){const O=m.scrollTop+b.y,x=y===A.Down&&O<=v.y||y===A.Up&&O>=E.y;if(x&&!b.x){m.scrollTo({top:O,behavior:c});return}x?g.y=m.scrollTop-O:g.y=y===A.Down?m.scrollTop-v.y:m.scrollTop-E.y,g.y&&m.scrollBy({top:-g.y,behavior:c});break}}this.handleMove(t,Ne(lt(f,this.referenceCoordinates),g))}}}handleMove(t,n){const{onMove:r}=this.props;t.preventDefault(),r(n)}handleEnd(t){const{onEnd:n}=this.props;t.preventDefault(),this.detach(),n()}handleCancel(t){const{onCancel:n}=this.props;t.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}In.activators=[{eventName:"onKeyDown",handler:(e,t,n)=>{let{keyboardCodes:r=An,onActivation:o}=t,{active:i}=n;const{code:l}=e.nativeEvent;if(r.start.includes(l)){const c=i.activatorNode.current;return c&&e.target!==c?!1:(e.preventDefault(),o==null||o({event:e.nativeEvent}),!0)}return!1}}];function nn(e){return!!(e&&"distance"in e)}function rn(e){return!!(e&&"delay"in e)}class _t{constructor(t,n,r){var o;r===void 0&&(r=fs(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=n;const{event:i}=t,{target:l}=i;this.props=t,this.events=n,this.document=Le(l),this.documentListeners=new Ye(this.document),this.listeners=new Ye(r),this.windowListeners=new Ye(H(l)),this.initialCoordinates=(o=At(i))!=null?o:te,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:n,bypassActivationConstraint:r}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(Z.Resize,this.handleCancel),this.windowListeners.add(Z.DragStart,tn),this.windowListeners.add(Z.VisibilityChange,this.handleCancel),this.windowListeners.add(Z.ContextMenu,tn),this.documentListeners.add(Z.Keydown,this.handleKeydown),n){if(r!=null&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(rn(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(nn(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,n){const{active:r,onPending:o}=this.props;o(r,t,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:t}=this,{onStart:n}=this.props;t&&(this.activated=!0,this.documentListeners.add(Z.Click,hs,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(Z.SelectionChange,this.removeTextSelection),n(t))}handleMove(t){var n;const{activated:r,initialCoordinates:o,props:i}=this,{onMove:l,options:{activationConstraint:c}}=i;if(!o)return;const d=(n=At(t))!=null?n:te,u=lt(o,d);if(!r&&c){if(nn(c)){if(c.tolerance!=null&&Ct(u,c.tolerance))return this.handleCancel();if(Ct(u,c.distance))return this.handleStart()}if(rn(c)&&Ct(u,c.tolerance))return this.handleCancel();this.handlePending(c,u);return}t.cancelable&&t.preventDefault(),l(d)}handleEnd(){const{onAbort:t,onEnd:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleCancel(){const{onAbort:t,onCancel:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleKeydown(t){t.code===A.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const gs={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class zt extends _t{constructor(t){const{event:n}=t,r=Le(n.target);super(t,gs,r)}}zt.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return!n.isPrimary||n.button!==0?!1:(r==null||r({event:n}),!0)}}];const bs={move:{name:"mousemove"},end:{name:"mouseup"}};var Nt;(function(e){e[e.RightClick=2]="RightClick"})(Nt||(Nt={}));class Nn extends _t{constructor(t){super(t,bs,Le(t.event.target))}}Nn.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return n.button===Nt.RightClick?!1:(r==null||r({event:n}),!0)}}];const St={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class On extends _t{constructor(t){super(t,St)}static setup(){return window.addEventListener(St.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(St.move.name,t)};function t(){}}}On.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;const{touches:o}=n;return o.length>1?!1:(r==null||r({event:n}),!0)}}];var Xe;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(Xe||(Xe={}));var ct;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(ct||(ct={}));function xs(e){let{acceleration:t,activator:n=Xe.Pointer,canScroll:r,draggingRect:o,enabled:i,interval:l=5,order:c=ct.TreeOrder,pointerCoordinates:d,scrollableAncestors:u,scrollableAncestorRects:h,delta:f,threshold:b}=e;const g=vs({delta:f,disabled:!i}),[p,m]=Tr(),y=a.useRef({x:0,y:0}),S=a.useRef({x:0,y:0}),j=a.useMemo(()=>{switch(n){case Xe.Pointer:return d?{top:d.y,bottom:d.y,left:d.x,right:d.x}:null;case Xe.DraggableRect:return o}},[n,o,d]),C=a.useRef(null),k=a.useCallback(()=>{const E=C.current;if(!E)return;const D=y.current.x*S.current.x,w=y.current.y*S.current.y;E.scrollBy(D,w)},[]),v=a.useMemo(()=>c===ct.TreeOrder?[...u].reverse():u,[c,u]);a.useEffect(()=>{if(!i||!u.length||!j){m();return}for(const E of v){if((r==null?void 0:r(E))===!1)continue;const D=u.indexOf(E),w=h[D];if(!w)continue;const{direction:M,speed:P}=is(E,w,j,t,b);for(const O of["x","y"])g[O][M[O]]||(P[O]=0,M[O]=0);if(P.x>0||P.y>0){m(),C.current=E,p(k,l),y.current=P,S.current=M;return}}y.current={x:0,y:0},S.current={x:0,y:0},m()},[t,k,r,m,i,l,JSON.stringify(j),JSON.stringify(g),p,u,v,h,JSON.stringify(b)])}const ms={x:{[W.Backward]:!1,[W.Forward]:!1},y:{[W.Backward]:!1,[W.Forward]:!1}};function vs(e){let{delta:t,disabled:n}=e;const r=Tt(t);return Je(o=>{if(n||!r||!o)return ms;const i={x:Math.sign(t.x-r.x),y:Math.sign(t.y-r.y)};return{x:{[W.Backward]:o.x[W.Backward]||i.x===-1,[W.Forward]:o.x[W.Forward]||i.x===1},y:{[W.Backward]:o.y[W.Backward]||i.y===-1,[W.Forward]:o.y[W.Forward]||i.y===1}}},[n,t,r])}function ys(e,t){const n=t!=null?e.get(t):void 0,r=n?n.node.current:null;return Je(o=>{var i;return t==null?null:(i=r??o)!=null?i:null},[r,t])}function ws(e,t){return a.useMemo(()=>e.reduce((n,r)=>{const{sensor:o}=r,i=o.activators.map(l=>({eventName:l.eventName,handler:t(l.handler,r)}));return[...n,...i]},[]),[e,t])}var Ve;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(Ve||(Ve={}));var Ot;(function(e){e.Optimized="optimized"})(Ot||(Ot={}));const sn=new Map;function Cs(e,t){let{dragging:n,dependencies:r,config:o}=t;const[i,l]=a.useState(null),{frequency:c,measure:d,strategy:u}=o,h=a.useRef(e),f=y(),b=Ke(f),g=a.useCallback(function(S){S===void 0&&(S=[]),!b.current&&l(j=>j===null?S:j.concat(S.filter(C=>!j.includes(C))))},[b]),p=a.useRef(null),m=Je(S=>{if(f&&!n)return sn;if(!S||S===sn||h.current!==e||i!=null){const j=new Map;for(let C of e){if(!C)continue;if(i&&i.length>0&&!i.includes(C.id)&&C.rect.current){j.set(C.id,C.rect.current);continue}const k=C.node.current,v=k?new Wt(d(k),k):null;C.rect.current=v,v&&j.set(C.id,v)}return j}return S},[e,i,n,f,d]);return a.useEffect(()=>{h.current=e},[e]),a.useEffect(()=>{f||g()},[n,f]),a.useEffect(()=>{i&&i.length>0&&l(null)},[JSON.stringify(i)]),a.useEffect(()=>{f||typeof c!="number"||p.current!==null||(p.current=setTimeout(()=>{g(),p.current=null},c))},[c,f,g,...r]),{droppableRects:m,measureDroppableContainers:g,measuringScheduled:i!=null};function y(){switch(u){case Ve.Always:return!1;case Ve.BeforeDragging:return n;default:return!n}}}function Ln(e,t){return Je(n=>e?n||(typeof t=="function"?t(e):e):null,[t,e])}function Ss(e,t){return Ln(e,t)}function js(e){let{callback:t,disabled:n}=e;const r=Ft(t),o=a.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:i}=window;return new i(r)},[r,n]);return a.useEffect(()=>()=>o==null?void 0:o.disconnect(),[o]),o}function ft(e){let{callback:t,disabled:n}=e;const r=Ft(t),o=a.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:i}=window;return new i(r)},[n]);return a.useEffect(()=>()=>o==null?void 0:o.disconnect(),[o]),o}function Rs(e){return new Wt(Me(e),e)}function on(e,t,n){t===void 0&&(t=Rs);const[r,o]=a.useState(null);function i(){o(d=>{if(!e)return null;if(e.isConnected===!1){var u;return(u=d??n)!=null?u:null}const h=t(e);return JSON.stringify(d)===JSON.stringify(h)?d:h})}const l=js({callback(d){if(e)for(const u of d){const{type:h,target:f}=u;if(h==="childList"&&f instanceof HTMLElement&&f.contains(e)){i();break}}}}),c=ft({callback:i});return le(()=>{i(),e?(c==null||c.observe(e),l==null||l.observe(document.body,{childList:!0,subtree:!0})):(c==null||c.disconnect(),l==null||l.disconnect())},[e]),r}function Es(e){const t=Ln(e);return Sn(e,t)}const ln=[];function Ds(e){const t=a.useRef(e),n=Je(r=>e?r&&r!==ln&&e&&t.current&&e.parentNode===t.current.parentNode?r:Bt(e):ln,[e]);return a.useEffect(()=>{t.current=e},[e]),n}function ks(e){const[t,n]=a.useState(null),r=a.useRef(e),o=a.useCallback(i=>{const l=wt(i.target);l&&n(c=>c?(c.set(l,It(l)),new Map(c)):null)},[]);return a.useEffect(()=>{const i=r.current;if(e!==i){l(i);const c=e.map(d=>{const u=wt(d);return u?(u.addEventListener("scroll",o,{passive:!0}),[u,It(u)]):null}).filter(d=>d!=null);n(c.length?new Map(c):null),r.current=e}return()=>{l(e),l(i)};function l(c){c.forEach(d=>{const u=wt(d);u==null||u.removeEventListener("scroll",o)})}},[o,e]),a.useMemo(()=>e.length?t?Array.from(t.values()).reduce((i,l)=>Ne(i,l),te):Tn(e):te,[e,t])}function an(e,t){t===void 0&&(t=[]);const n=a.useRef(null);return a.useEffect(()=>{n.current=null},t),a.useEffect(()=>{const r=e!==te;r&&!n.current&&(n.current=e),!r&&n.current&&(n.current=null)},[e]),n.current?lt(e,n.current):te}function Ts(e){a.useEffect(()=>{if(!ut)return;const t=e.map(n=>{let{sensor:r}=n;return r.setup==null?void 0:r.setup()});return()=>{for(const n of t)n==null||n()}},e.map(t=>{let{sensor:n}=t;return n}))}function As(e,t){return a.useMemo(()=>e.reduce((n,r)=>{let{eventName:o,handler:i}=r;return n[o]=l=>{i(l,t)},n},{}),[e,t])}function Mn(e){return a.useMemo(()=>e?ns(e):null,[e])}const cn=[];function Is(e,t){t===void 0&&(t=Me);const[n]=e,r=Mn(n?H(n):null),[o,i]=a.useState(cn);function l(){i(()=>e.length?e.map(d=>Dn(d)?r:new Wt(t(d),d)):cn)}const c=ft({callback:l});return le(()=>{c==null||c.disconnect(),l(),e.forEach(d=>c==null?void 0:c.observe(d))},[e]),o}function Ns(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return qe(t)?t:e}function Os(e){let{measure:t}=e;const[n,r]=a.useState(null),o=a.useCallback(u=>{for(const{target:h}of u)if(qe(h)){r(f=>{const b=t(h);return f?{...f,width:b.width,height:b.height}:b});break}},[t]),i=ft({callback:o}),l=a.useCallback(u=>{const h=Ns(u);i==null||i.disconnect(),h&&(i==null||i.observe(h)),r(h?t(h):null)},[t,i]),[c,d]=it(l);return a.useMemo(()=>({nodeRef:c,rect:n,setRef:d}),[n,c,d])}const Ls=[{sensor:zt,options:{}},{sensor:In,options:{}}],Ms={current:{}},st={draggable:{measure:en},droppable:{measure:en,strategy:Ve.WhileDragging,frequency:Ot.Optimized},dragOverlay:{measure:Me}};class He extends Map{get(t){var n;return t!=null&&(n=super.get(t))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:n}=t;return!n})}getNodeFor(t){var n,r;return(n=(r=this.get(t))==null?void 0:r.node.current)!=null?n:void 0}}const Fs={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new He,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:at},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:st,measureDroppableContainers:at,windowRect:null,measuringScheduled:!1},Ps={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:at,draggableNodes:new Map,over:null,measureDroppableContainers:at},ht=a.createContext(Ps),Fn=a.createContext(Fs);function Bs(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new He}}}function Ws(e,t){switch(t.type){case B.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case B.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case B.DragEnd:case B.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case B.RegisterDroppable:{const{element:n}=t,{id:r}=n,o=new He(e.droppable.containers);return o.set(r,n),{...e,droppable:{...e.droppable,containers:o}}}case B.SetDroppableDisabled:{const{id:n,key:r,disabled:o}=t,i=e.droppable.containers.get(n);if(!i||r!==i.key)return e;const l=new He(e.droppable.containers);return l.set(n,{...i,disabled:o}),{...e,droppable:{...e.droppable,containers:l}}}case B.UnregisterDroppable:{const{id:n,key:r}=t,o=e.droppable.containers.get(n);if(!o||r!==o.key)return e;const i=new He(e.droppable.containers);return i.delete(n),{...e,droppable:{...e.droppable,containers:i}}}default:return e}}function _s(e){let{disabled:t}=e;const{active:n,activatorEvent:r,draggableNodes:o}=a.useContext(ht),i=Tt(r),l=Tt(n==null?void 0:n.id);return a.useEffect(()=>{if(!t&&!r&&i&&l!=null){if(!Pt(i)||document.activeElement===i.target)return;const c=o.get(l);if(!c)return;const{activatorNode:d,node:u}=c;if(!d.current&&!u.current)return;requestAnimationFrame(()=>{for(const h of[d.current,u.current]){if(!h)continue;const f=Nr(h);if(f){f.focus();break}}})}},[r,t,o,l,i]),null}function zs(e,t){let{transform:n,...r}=t;return e!=null&&e.length?e.reduce((o,i)=>i({transform:o,...r}),n):n}function Us(e){return a.useMemo(()=>({draggable:{...st.draggable,...e==null?void 0:e.draggable},droppable:{...st.droppable,...e==null?void 0:e.droppable},dragOverlay:{...st.dragOverlay,...e==null?void 0:e.dragOverlay}}),[e==null?void 0:e.draggable,e==null?void 0:e.droppable,e==null?void 0:e.dragOverlay])}function $s(e){let{activeNode:t,measure:n,initialRect:r,config:o=!0}=e;const i=a.useRef(!1),{x:l,y:c}=typeof o=="boolean"?{x:o,y:o}:o;le(()=>{if(!l&&!c||!t){i.current=!1;return}if(i.current||!r)return;const u=t==null?void 0:t.node.current;if(!u||u.isConnected===!1)return;const h=n(u),f=Sn(h,r);if(l||(f.x=0),c||(f.y=0),i.current=!0,Math.abs(f.x)>0||Math.abs(f.y)>0){const b=jn(u);b&&b.scrollBy({top:f.y,left:f.x})}},[t,l,c,r,n])}const Pn=a.createContext({...te,scaleX:1,scaleY:1});var ye;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(ye||(ye={}));const Ys=a.memo(function(t){var n,r,o,i;let{id:l,accessibility:c,autoScroll:d=!0,children:u,sensors:h=Ls,collisionDetection:f=Vr,measuring:b,modifiers:g,...p}=t;const m=a.useReducer(Ws,void 0,Bs),[y,S]=m,[j,C]=Br(),[k,v]=a.useState(ye.Uninitialized),E=k===ye.Initialized,{draggable:{active:D,nodes:w,translate:M},droppable:{containers:P}}=y,O=D!=null?w.get(D):null,x=a.useRef({initial:null,translated:null}),T=a.useMemo(()=>{var U;return D!=null?{id:D,data:(U=O==null?void 0:O.data)!=null?U:Ms,rect:x}:null},[D,O]),I=a.useRef(null),[F,q]=a.useState(null),[z,ne]=a.useState(null),ee=Ke(p,Object.values(p)),we=Qe("DndDescribedBy",l),Ce=a.useMemo(()=>P.getEnabled(),[P]),Y=Us(b),{droppableRects:ae,measureDroppableContainers:Se,measuringScheduled:Fe}=Cs(Ce,{dragging:E,dependencies:[M.x,M.y],config:Y.droppable}),J=ys(w,D),Ze=a.useMemo(()=>z?At(z):null,[z]),he=qn(),ce=Ss(J,Y.draggable.measure);$s({activeNode:D!=null?w.get(D):null,config:he.layoutShiftCompensation,initialRect:ce,measure:Y.draggable.measure});const N=on(J,Y.draggable.measure,ce),Pe=on(J?J.parentElement:null),re=a.useRef({activatorEvent:null,active:null,activeNode:J,collisionRect:null,collisions:null,droppableRects:ae,draggableNodes:w,draggingNode:null,draggingNodeRect:null,droppableContainers:P,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),je=P.getNodeFor((n=re.current.over)==null?void 0:n.id),de=Os({measure:Y.dragOverlay.measure}),Re=(r=de.nodeRef.current)!=null?r:J,Ee=E?(o=de.rect)!=null?o:N:null,Ut=!!(de.nodeRef.current&&de.rect),$t=Es(Ut?null:N),pt=Mn(Re?H(Re):null),pe=Ds(E?je??J:null),et=Is(pe),tt=zs(g,{transform:{x:M.x-$t.x,y:M.y-$t.y,scaleX:1,scaleY:1},activatorEvent:z,active:T,activeNodeRect:N,containerNodeRect:Pe,draggingNodeRect:Ee,over:re.current.over,overlayNodeRect:de.rect,scrollableAncestors:pe,scrollableAncestorRects:et,windowRect:pt}),Yt=Ze?Ne(Ze,M):null,Xt=ks(pe),$n=an(Xt),Yn=an(Xt,[N]),De=Ne(tt,$n),ke=Ee?Qr(Ee,tt):null,Be=T&&ke?f({active:T,collisionRect:ke,droppableRects:ae,droppableContainers:Ce,pointerCoordinates:Yt}):null,Ht=Hr(Be,"id"),[ge,Kt]=a.useState(null),Xn=Ut?tt:Ne(tt,Yn),Hn=qr(Xn,(i=ge==null?void 0:ge.rect)!=null?i:null,N),gt=a.useRef(null),Gt=a.useCallback((U,K)=>{let{sensor:G,options:be}=K;if(I.current==null)return;const Q=w.get(I.current);if(!Q)return;const V=U.nativeEvent,se=new G({active:I.current,activeNode:Q,event:V,options:be,context:re,onAbort(_){if(!w.get(_))return;const{onDragAbort:oe}=ee.current,ue={id:_};oe==null||oe(ue),j({type:"onDragAbort",event:ue})},onPending(_,xe,oe,ue){if(!w.get(_))return;const{onDragPending:_e}=ee.current,me={id:_,constraint:xe,initialCoordinates:oe,offset:ue};_e==null||_e(me),j({type:"onDragPending",event:me})},onStart(_){const xe=I.current;if(xe==null)return;const oe=w.get(xe);if(!oe)return;const{onDragStart:ue}=ee.current,We={activatorEvent:V,active:{id:xe,data:oe.data,rect:x}};Ue.unstable_batchedUpdates(()=>{ue==null||ue(We),v(ye.Initializing),S({type:B.DragStart,initialCoordinates:_,active:xe}),j({type:"onDragStart",event:We}),q(gt.current),ne(V)})},onMove(_){S({type:B.DragMove,coordinates:_})},onEnd:Te(B.DragEnd),onCancel:Te(B.DragCancel)});gt.current=se;function Te(_){return async function(){const{active:oe,collisions:ue,over:We,scrollAdjustedTranslate:_e}=re.current;let me=null;if(oe&&_e){const{cancelDrop:ze}=ee.current;me={activatorEvent:V,active:oe,collisions:ue,delta:_e,over:We},_===B.DragEnd&&typeof ze=="function"&&await Promise.resolve(ze(me))&&(_=B.DragCancel)}I.current=null,Ue.unstable_batchedUpdates(()=>{S({type:_}),v(ye.Uninitialized),Kt(null),q(null),ne(null),gt.current=null;const ze=_===B.DragEnd?"onDragEnd":"onDragCancel";if(me){const bt=ee.current[ze];bt==null||bt(me),j({type:ze,event:me})}})}}},[w]),Kn=a.useCallback((U,K)=>(G,be)=>{const Q=G.nativeEvent,V=w.get(be);if(I.current!==null||!V||Q.dndKit||Q.defaultPrevented)return;const se={active:V};U(G,K.options,se)===!0&&(Q.dndKit={capturedBy:K.sensor},I.current=be,Gt(G,K))},[w,Gt]),Vt=ws(h,Kn);Ts(h),le(()=>{N&&k===ye.Initializing&&v(ye.Initialized)},[N,k]),a.useEffect(()=>{const{onDragMove:U}=ee.current,{active:K,activatorEvent:G,collisions:be,over:Q}=re.current;if(!K||!G)return;const V={active:K,activatorEvent:G,collisions:be,delta:{x:De.x,y:De.y},over:Q};Ue.unstable_batchedUpdates(()=>{U==null||U(V),j({type:"onDragMove",event:V})})},[De.x,De.y]),a.useEffect(()=>{const{active:U,activatorEvent:K,collisions:G,droppableContainers:be,scrollAdjustedTranslate:Q}=re.current;if(!U||I.current==null||!K||!Q)return;const{onDragOver:V}=ee.current,se=be.get(Ht),Te=se&&se.rect.current?{id:se.id,rect:se.rect.current,data:se.data,disabled:se.disabled}:null,_={active:U,activatorEvent:K,collisions:G,delta:{x:Q.x,y:Q.y},over:Te};Ue.unstable_batchedUpdates(()=>{Kt(Te),V==null||V(_),j({type:"onDragOver",event:_})})},[Ht]),le(()=>{re.current={activatorEvent:z,active:T,activeNode:J,collisionRect:ke,collisions:Be,droppableRects:ae,draggableNodes:w,draggingNode:Re,draggingNodeRect:Ee,droppableContainers:P,over:ge,scrollableAncestors:pe,scrollAdjustedTranslate:De},x.current={initial:Ee,translated:ke}},[T,J,Be,ke,w,Re,Ee,ae,P,ge,pe,De]),xs({...he,delta:M,draggingRect:ke,pointerCoordinates:Yt,scrollableAncestors:pe,scrollableAncestorRects:et});const Gn=a.useMemo(()=>({active:T,activeNode:J,activeNodeRect:N,activatorEvent:z,collisions:Be,containerNodeRect:Pe,dragOverlay:de,draggableNodes:w,droppableContainers:P,droppableRects:ae,over:ge,measureDroppableContainers:Se,scrollableAncestors:pe,scrollableAncestorRects:et,measuringConfiguration:Y,measuringScheduled:Fe,windowRect:pt}),[T,J,N,z,Be,Pe,de,w,P,ae,ge,Se,pe,et,Y,Fe,pt]),Vn=a.useMemo(()=>({activatorEvent:z,activators:Vt,active:T,activeNodeRect:N,ariaDescribedById:{draggable:we},dispatch:S,draggableNodes:w,over:ge,measureDroppableContainers:Se}),[z,Vt,T,N,S,we,w,ge,Se]);return X.createElement(Cn.Provider,{value:C},X.createElement(ht.Provider,{value:Vn},X.createElement(Fn.Provider,{value:Gn},X.createElement(Pn.Provider,{value:Hn},u)),X.createElement(_s,{disabled:(c==null?void 0:c.restoreFocus)===!1})),X.createElement(zr,{...c,hiddenTextDescribedById:we}));function qn(){const U=(F==null?void 0:F.autoScrollEnabled)===!1,K=typeof d=="object"?d.enabled===!1:d===!1,G=E&&!U&&!K;return typeof d=="object"?{...d,enabled:G}:{enabled:G}}}),Xs=a.createContext(null),dn="button",Hs="Draggable";function Bn(e){let{id:t,data:n,disabled:r=!1,attributes:o}=e;const i=Qe(Hs),{activators:l,activatorEvent:c,active:d,activeNodeRect:u,ariaDescribedById:h,draggableNodes:f,over:b}=a.useContext(ht),{role:g=dn,roleDescription:p="draggable",tabIndex:m=0}=o??{},y=(d==null?void 0:d.id)===t,S=a.useContext(y?Pn:Xs),[j,C]=it(),[k,v]=it(),E=As(l,t),D=Ke(n);le(()=>(f.set(t,{id:t,key:i,node:j,activatorNode:k,data:D}),()=>{const M=f.get(t);M&&M.key===i&&f.delete(t)}),[f,t]);const w=a.useMemo(()=>({role:g,tabIndex:m,"aria-disabled":r,"aria-pressed":y&&g===dn?!0:void 0,"aria-roledescription":p,"aria-describedby":h.draggable}),[r,g,m,y,p,h.draggable]);return{active:d,activatorEvent:c,activeNodeRect:u,attributes:w,isDragging:y,listeners:r?void 0:E,node:j,over:b,setNodeRef:C,setActivatorNodeRef:v,transform:S}}function Ks(){return a.useContext(Fn)}const Gs="Droppable",Vs={timeout:25};function qs(e){let{data:t,disabled:n=!1,id:r,resizeObserverConfig:o}=e;const i=Qe(Gs),{active:l,dispatch:c,over:d,measureDroppableContainers:u}=a.useContext(ht),h=a.useRef({disabled:n}),f=a.useRef(!1),b=a.useRef(null),g=a.useRef(null),{disabled:p,updateMeasurementsFor:m,timeout:y}={...Vs,...o},S=Ke(m??r),j=a.useCallback(()=>{if(!f.current){f.current=!0;return}g.current!=null&&clearTimeout(g.current),g.current=setTimeout(()=>{u(Array.isArray(S.current)?S.current:[S.current]),g.current=null},y)},[y]),C=ft({callback:j,disabled:p||!l}),k=a.useCallback((w,M)=>{C&&(M&&(C.unobserve(M),f.current=!1),w&&C.observe(w))},[C]),[v,E]=it(k),D=Ke(t);return a.useEffect(()=>{!C||!v.current||(C.disconnect(),f.current=!1,C.observe(v.current))},[v,C]),a.useEffect(()=>(c({type:B.RegisterDroppable,element:{id:r,key:i,disabled:n,node:v,rect:b,data:D}}),()=>c({type:B.UnregisterDroppable,key:i,id:r})),[r]),a.useEffect(()=>{n!==h.current.disabled&&(c({type:B.SetDroppableDisabled,id:r,key:i,disabled:n}),h.current.disabled=n)},[r,i,n,c]),{active:l,rect:b,isOver:(d==null?void 0:d.id)===r,node:v,over:d,setNodeRef:E}}function dt(e,t,n){const r=e.slice();return r.splice(n<0?r.length+n:n,0,r.splice(t,1)[0]),r}function Js(e,t){return e.reduce((n,r,o)=>{const i=t.get(r);return i&&(n[o]=i),n},Array(e.length))}function rt(e){return e!==null&&e>=0}function Qs(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function Zs(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const Wn=e=>{let{rects:t,activeIndex:n,overIndex:r,index:o}=e;const i=dt(t,r,n),l=t[o],c=i[o];return!c||!l?null:{x:c.left-l.left,y:c.top-l.top,scaleX:c.width/l.width,scaleY:c.height/l.height}},_n="Sortable",zn=X.createContext({activeIndex:-1,containerId:_n,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:Wn,disabled:{draggable:!1,droppable:!1}});function eo(e){let{children:t,id:n,items:r,strategy:o=Wn,disabled:i=!1}=e;const{active:l,dragOverlay:c,droppableRects:d,over:u,measureDroppableContainers:h}=Ks(),f=Qe(_n,n),b=c.rect!==null,g=a.useMemo(()=>r.map(E=>typeof E=="object"&&"id"in E?E.id:E),[r]),p=l!=null,m=l?g.indexOf(l.id):-1,y=u?g.indexOf(u.id):-1,S=a.useRef(g),j=!Qs(g,S.current),C=y!==-1&&m===-1||j,k=Zs(i);le(()=>{j&&p&&h(g)},[j,g,p,h]),a.useEffect(()=>{S.current=g},[g]);const v=a.useMemo(()=>({activeIndex:m,containerId:f,disabled:k,disableTransforms:C,items:g,overIndex:y,useDragOverlay:b,sortedRects:Js(g,d),strategy:o}),[m,f,k.draggable,k.droppable,C,g,y,d,b,o]);return X.createElement(zn.Provider,{value:v},t)}const to=e=>{let{id:t,items:n,activeIndex:r,overIndex:o}=e;return dt(n,r,o).indexOf(t)},no=e=>{let{containerId:t,isSorting:n,wasDragging:r,index:o,items:i,newIndex:l,previousItems:c,previousContainerId:d,transition:u}=e;return!u||!r||c!==i&&o===l?!1:n?!0:l!==o&&t===d},ro={duration:200,easing:"ease"},Un="transform",so=Ge.Transition.toString({property:Un,duration:0,easing:"linear"}),oo={roleDescription:"sortable"};function io(e){let{disabled:t,index:n,node:r,rect:o}=e;const[i,l]=a.useState(null),c=a.useRef(n);return le(()=>{if(!t&&n!==c.current&&r.current){const d=o.current;if(d){const u=Me(r.current,{ignoreTransform:!0}),h={x:d.left-u.left,y:d.top-u.top,scaleX:d.width/u.width,scaleY:d.height/u.height};(h.x||h.y)&&l(h)}}n!==c.current&&(c.current=n)},[t,n,r,o]),a.useEffect(()=>{i&&l(null)},[i]),i}function lo(e){let{animateLayoutChanges:t=no,attributes:n,disabled:r,data:o,getNewIndex:i=to,id:l,strategy:c,resizeObserverConfig:d,transition:u=ro}=e;const{items:h,containerId:f,activeIndex:b,disabled:g,disableTransforms:p,sortedRects:m,overIndex:y,useDragOverlay:S,strategy:j}=a.useContext(zn),C=ao(r,g),k=h.indexOf(l),v=a.useMemo(()=>({sortable:{containerId:f,index:k,items:h},...o}),[f,o,k,h]),E=a.useMemo(()=>h.slice(h.indexOf(l)),[h,l]),{rect:D,node:w,isOver:M,setNodeRef:P}=qs({id:l,data:v,disabled:C.droppable,resizeObserverConfig:{updateMeasurementsFor:E,...d}}),{active:O,activatorEvent:x,activeNodeRect:T,attributes:I,setNodeRef:F,listeners:q,isDragging:z,over:ne,setActivatorNodeRef:ee,transform:we}=Bn({id:l,data:v,attributes:{...oo,...n},disabled:C.draggable}),Ce=kr(P,F),Y=!!O,ae=Y&&!p&&rt(b)&&rt(y),Se=!S&&z,Fe=Se&&ae?we:null,Ze=ae?Fe??(c??j)({rects:m,activeNodeRect:T,activeIndex:b,overIndex:y,index:k}):null,he=rt(b)&&rt(y)?i({id:l,items:h,activeIndex:b,overIndex:y}):k,ce=O==null?void 0:O.id,N=a.useRef({activeId:ce,items:h,newIndex:he,containerId:f}),Pe=h!==N.current.items,re=t({active:O,containerId:f,isDragging:z,isSorting:Y,id:l,index:k,items:h,newIndex:N.current.newIndex,previousItems:N.current.items,previousContainerId:N.current.containerId,transition:u,wasDragging:N.current.activeId!=null}),je=io({disabled:!re,index:k,node:w,rect:D});return a.useEffect(()=>{Y&&N.current.newIndex!==he&&(N.current.newIndex=he),f!==N.current.containerId&&(N.current.containerId=f),h!==N.current.items&&(N.current.items=h)},[Y,he,f,h]),a.useEffect(()=>{if(ce===N.current.activeId)return;if(ce!=null&&N.current.activeId==null){N.current.activeId=ce;return}const Re=setTimeout(()=>{N.current.activeId=ce},50);return()=>clearTimeout(Re)},[ce]),{active:O,activeIndex:b,attributes:I,data:v,rect:D,index:k,newIndex:he,items:h,isOver:M,isSorting:Y,isDragging:z,listeners:q,node:w,overIndex:y,over:ne,setNodeRef:Ce,setActivatorNodeRef:ee,setDroppableNodeRef:P,setDraggableNodeRef:F,transform:je??Ze,transition:de()};function de(){if(je||Pe&&N.current.newIndex===k)return so;if(!(Se&&!Pt(x)||!u)&&(Y||re))return Ge.Transition.toString({...u,property:Un})}}function ao(e,t){var n,r;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(n=e==null?void 0:e.draggable)!=null?n:t.draggable,droppable:(r=e==null?void 0:e.droppable)!=null?r:t.droppable}}A.Down,A.Right,A.Up,A.Left;const co=e=>{const{setNodeRef:t,transform:n,transition:r}=lo({id:e.id}),o={transform:Ge.Transform.toString(n),transition:r};return s.jsx("div",{ref:t,style:o,children:e.children},e.id)},uo=e=>{const t=pn(n=>{var r,o;return((o=(r=n.tables[e])==null?void 0:r.state)==null?void 0:o.computedFieldIndex)??-1});return L.debug("tableComputedFieldIndex",t),t},fo=e=>{const t=pn(n=>{var r,o;return((o=(r=n.forms[e])==null?void 0:r.state)==null?void 0:o.computedFieldIndex)??-1});return L.debug("computedFieldIndex",t),t},Vo=({appId:e,target:t})=>{L.debug(e,t);const n=ar(e),r=uo(e),o=cr(e),i=fo(e);t===ot.TABLE?n==null||n.columns:o==null||o.columns;const l=t===ot.TABLE?r:i,c={label:"",type:sr.TEXT,expression:""},[d,u]=a.useState(-1),[h,f]=a.useState(c),[b,g]=a.useState(!1);return a.useEffect(()=>{},[e,l,t]),s.jsxs(R,{children:[s.jsx(R,{sx:{padding:"15px 15px 10px 5px",marginBottom:"5px",textAlign:"right"},children:s.jsx($,{variant:"contained",startIcon:s.jsx(Jn,{}),disabled:!0,onClick:()=>{},children:"Computed Field"})}),!1]})},ho=({id:e,enabled:t})=>{const{attributes:n,listeners:r,setNodeRef:o}=Bn({id:e}),i={margin:"auto",marginRight:"12px",cursor:"move"};return t||(i.pointerEvents="none",i.opacity="0.4"),s.jsx("div",{ref:o,...r,...n,style:i,children:s.jsx(gr,{})})},qo=({checked:e,children:t,alignRight:n,disabled:r,forceOff:o})=>{var l,c;const i={width:"13px",height:"13px",top:"unset",backgroundColor:(l=Dt)==null?void 0:l.palette.background.paper};return n===!1?i.right="unset":i.left="unset",s.jsxs(R,{sx:{position:"relative",width:"24px",height:"24px","& svg":{position:"absolute",width:"24px",height:"24px",top:0,bottom:0,left:0,right:0},"& svg.off":i},children:[t,(!e&&r!==!0||o===!0)&&s.jsx(Qn,{className:"off",color:(c=Dt)==null?void 0:c.palette.error.main})]})},un=({column:e,columnIndex:t,lookupColumns:n,wizardLookup:r,addActions:o,enableAddAction:i,target:l,appId:c,onUpdate:d,onActions:u})=>{L.debug(e,t,n,r,o,i,l,c);const h=a.useMemo(()=>l===ot.TABLE?or.getSelectors().selectTableColumnsById(Rt.getState().tables,c):ir.getSelectors().selectFormColumns(Rt.getState().forms,c),[]),[f,b]=a.useState(t===null?"":r.dynamicConditions[t].lookupColumnName);L.debug("stateLookupColumnName",f);const[g,p]=a.useState(t===null?"":r.dynamicConditions[t].tableColumnName);L.debug("stateTableColumnName",g);const[m,y]=a.useState(null),S=!!m,j=v=>{y(v.currentTarget),v.stopPropagation()},C=()=>{y(null)},k=v=>{v.lookupColumnName!==""&&v.tableColumnName!==""&&d(v)};return s.jsxs(R,{sx:{display:"grid",gridTemplateColumns:o?"1fr auto 1fr auto":"1fr auto 1fr",alignItems:"center",gridGap:"5px"},children:[s.jsxs($e,{MenuProps:{id:"pp-select-menu"},value:f,onChange:v=>{b(v.target.value),k({lookupColumnName:v.target.value,tableColumnName:g})},children:[s.jsx(fe,{value:""}),...n.map(v=>s.jsx(fe,{value:v,children:v}))]}),s.jsx("span",{children:"="}),s.jsxs($e,{MenuProps:{id:"pp-select-menu"},value:g,onChange:v=>{p(v.target.value),k({lookupColumnName:f,tableColumnName:v.target.value})},children:[s.jsx(fe,{value:""}),...h.map(v=>v.columnName===e.columnName||v.computedField!==void 0?null:s.jsx(fe,{value:v.columnName,children:v.columnName}))]}),o&&s.jsxs(s.Fragment,{children:[s.jsx(vr,{color:"primary",onClick:j,children:s.jsx(Zn,{})}),s.jsxs(yr,{anchorEl:m,open:S,onClose:C,sx:{zIndex:9999999999},anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},children:[i&&s.jsxs(fe,{onClick:()=>{u("add"),C()},children:[s.jsx(br,{}),s.jsx("span",{style:{marginLeft:"10px"},children:"Add column"})]}),s.jsxs(fe,{onClick:()=>{u("delete"),C()},children:[s.jsx(xr,{}),s.jsx("span",{style:{marginLeft:"10px"},children:"Delete column"})]})]})]})]})},po=({column:e,appId:t,columnIndex:n,databases:r,defaultDatabase:o,wpDatabase:i,target:l,setLookup:c,enableWizard:d})=>{L.debug(e,t,n,r,o,i,l);const u=Ur(yt(zt),yt(Nn),yt(On)),h=gn(t),f=["Select database","Select lookup table","Select lookup column","Select lookup column values","Lookup conditions"],[b,g]=a.useState(0),[p,m]=a.useState(e.lookup!==void 0?{dbs:o,tbl:"",key:"",value:"",delimiter:"",defaultWhere:"",dynamicConditions:[],loadOnStartup:!0,rerender:!1,...e.lookup}:{dbs:o,tbl:"",key:"",value:"",delimiter:"",defaultWhere:"",dynamicConditions:[],loadOnStartup:!0,rerender:!1});L.debug("wizardLookup",p);const[y,S]=a.useState(p.dynamicConditions.length===0),[j,C]=a.useState(!1);L.debug("wizardError",j);const[k,v]=a.useState([]);L.debug("tables",k);const[E,D]=a.useState([]);L.debug("lookupColumns",E);const w=M=>{m({...p,...M})};return s.jsxs(s.Fragment,{children:[b!==f.length&&s.jsx(R,{sx:{textAlign:"right"},children:s.jsx($,{variant:"outlined",startIcon:s.jsx(er,{}),onClick:()=>{d(!1)},children:"Cancel"})}),s.jsx(wr,{activeStep:b,orientation:"vertical",sx:{marginBottom:0},children:f.map((M,P)=>{var O;return L.debug(M,P),s.jsxs(Cr,{children:[s.jsx(Sr,{children:M}),s.jsx(jr,{children:s.jsxs(R,{sx:{marginTop:"20px",display:"grid",gridGap:"10px","& > :nth-of-type(2)":{display:"grid",gridTemplateColumns:"1fr 1fr",gridGap:"5px",justifyContent:"space-between"}},children:[P===0&&s.jsxs(s.Fragment,{children:[s.jsxs($e,{MenuProps:{id:"pp-select-menu"},value:p==null?void 0:p.dbs,onChange:x=>{w({dbs:x.target.value,tbl:"",key:"",value:"",defaultWhere:"",dynamicConditions:[]})},children:[...r.map(x=>s.jsx(fe,{value:x,children:i===x?x+" (WordPress database)":x}))]}),s.jsxs(R,{children:[s.jsx(R,{}),s.jsx($,{variant:"contained",endIcon:s.jsx(Ae,{}),onClick:()=>{fr(t,(p==null?void 0:p.dbs)??"",x=>{const T=x==null?void 0:x.data;L.debug("response data",T),v(T),T.includes(p==null?void 0:p.tbl)||w({tbl:T[0]})},x=>{L.error("error",x),xt(x??Et.contactSupport,{variant:"error"})}),g(b+1)},children:"Next"})]})]}),P===1&&s.jsxs(s.Fragment,{children:[s.jsxs($e,{MenuProps:{id:"pp-select-menu"},value:p==null?void 0:p.tbl,onChange:x=>{w({tbl:x.target.value,key:"",value:"",defaultWhere:"",dynamicConditions:[]})},children:[...k.map(x=>s.jsx(fe,{value:x,children:x}))]}),s.jsxs(R,{children:[s.jsx($,{variant:"contained",startIcon:s.jsx(nt,{}),onClick:()=>{g(b-1)},children:"Previous"}),s.jsx($,{variant:"contained",endIcon:s.jsx(Ae,{}),onClick:()=>{hr(t,(p==null?void 0:p.dbs)??"",(p==null?void 0:p.tbl)??"",x=>{const T=x==null?void 0:x.data;L.debug("response data",T);const I=T.map(F=>F.column_name);if(p.value!==""){const F=p.value.split(",");I.map(q=>{F.includes(q)||F.push(q)}),D(F)}else D(I);I.includes(p.key)||w({key:T[0].column_name})},x=>{L.error("error",x),xt(x??Et.contactSupport,{variant:"error"})}),g(b+1)},children:"Next"})]})]}),P===2&&s.jsxs(s.Fragment,{children:[s.jsxs(Ie,{children:[s.jsxs($e,{MenuProps:{id:"pp-select-menu"},value:p==null?void 0:p.key,onChange:x=>{w({key:x.target.value,value:"",defaultWhere:"",dynamicConditions:[]})},children:[...E.map(x=>s.jsx(fe,{value:x,children:x}))]}),s.jsx(ie,{children:"Column selected from lookup table."})]}),s.jsxs(R,{children:[s.jsx($,{variant:"contained",startIcon:s.jsx(nt,{}),onClick:()=>{g(b-1)},children:"Previous"}),s.jsx($,{variant:"contained",endIcon:s.jsx(Ae,{}),onClick:()=>{g(b+1)},children:"Next"})]})]}),P===3&&s.jsxs(s.Fragment,{children:[s.jsxs(R,{children:[s.jsxs(Ie,{fullWidth:!0,children:[s.jsx(Ys,{autoScroll:!0,sensors:u,collisionDetection:Kr,onDragEnd:x=>{const{active:T,over:I}=x;if((T==null?void 0:T.id)!==(I==null?void 0:I.id)){L.debug(T,I);const F=E.indexOf(T.id.toString()),q=E.indexOf(I.id.toString()),z=dt(E,F,q);L.debug(z),D(z);let ne=[];p.value!==""&&(ne=p.value.split(",")),L.debug(ne);const ee=ne.indexOf(T.id.toString()),we=ne.indexOf(I.id.toString()),Ce=dt(ne,ee,we);L.debug(Ce),w({value:Ce.join()})}},children:s.jsx(eo,{items:E,children:s.jsxs(R,{sx:{width:"100%",margin:0,padding:0,"& > div:first-of-type > div":{borderTopLeftRadius:"4px",borderTopRightRadius:"4px"},"& > :last-of-type > div":{borderBottomLeftRadius:"4px",borderBottomRightRadius:"4px",borderBottom:"1px solid rgba(0, 0, 0, 0.23)"}},children:[...E.map(x=>s.jsx(co,{id:x,style:{borderRadius:"10px"},children:s.jsxs(R,{sx:{display:"grid",gridTemplateColumns:"1fr auto",alignItems:"center",padding:"12px 20px",borderTop:"1px solid rgba(0, 0, 0, 0.23)",borderLeft:"1px solid rgba(0, 0, 0, 0.23)",borderRight:"1px solid rgba(0, 0, 0, 0.23)"},children:[s.jsx(bn,{control:s.jsx(Rr,{id:x,checked:p.value.split(",").includes(x),onChange:(T,I)=>{let F=[];if(p.value!==""&&(F=p.value.split(",")),I)F.push(x);else{const q=F.indexOf(x);q!==-1&&F.splice(q,1)}w({value:F.join(),defaultWhere:"",dynamicConditions:[]})}}),label:x}),s.jsx(ho,{id:x,enabled:!0})]})},x))]})})}),s.jsx(ie,{children:"Columns shown in lookup."}),j&&s.jsxs(ie,{sx:{color:(O=Dt)==null?void 0:O.palette.error.main,display:"inline-grid",gridTemplateColumns:"auto auto",justifyContent:"start",alignItems:"center",gap:"5px","& svg":{fontSize:"20px"}},children:[s.jsx(tr,{}),s.jsx("span",{children:"Select at least one column."})]})]}),s.jsx(ve,{value:p==null?void 0:p.delimiter,onChange:x=>{w({delimiter:x.target.value})},fullWidth:!0,type:"text",placeholder:"Column delimiter",sx:{marginTop:"10px"}})]}),s.jsxs(R,{children:[s.jsx($,{variant:"contained",startIcon:s.jsx(nt,{}),onClick:()=>{g(b-1)},children:"Previous"}),s.jsx($,{variant:"contained",endIcon:s.jsx(Ae,{}),onClick:()=>{p.value===""?xt("Select at least one column",{variant:"error"}):g(b+1)},children:"Next"})]})]}),P===4&&s.jsxs(s.Fragment,{children:[s.jsxs(R,{sx:{display:"grid",gridGap:"20px"},children:[s.jsxs(Ie,{fullWidth:!0,children:[s.jsx(Jt,{children:"Default where"}),s.jsx(ve,{value:p==null?void 0:p.defaultWhere,multiline:!0,fullWidth:!0,minRows:2,maxRows:4,variant:"outlined",onClick:x=>{x.stopPropagation()},onChange:x=>{w({defaultWhere:x.target.value,dynamicConditions:[]})}}),s.jsx(ie,{children:"Enter a valid SQL where clause or leave empty."})]}),s.jsxs(R,{children:[s.jsx(Jt,{children:"Dynamic conditions"}),s.jsxs(R,{sx:{display:"grid",gridGap:"5px"},children:[...p.dynamicConditions.map((x,T)=>s.jsx(un,{appId:t,column:e,columnIndex:T,lookupColumns:E,wizardLookup:p,addActions:!0,target:l,enableAddAction:p.dynamicConditions.length===T+1&&!y,onUpdate:I=>{const F=mt(p);F.dynamicConditions[n]={...I},w(F)},onActions:I=>{if(I==="add")S(!0);else if(I==="delete"){const F=mt(p);F.dynamicConditions.splice(T,1),w(F),S(F.dynamicConditions.length===0)}}})),y&&s.jsx(un,{appId:t,column:e,columnIndex:null,lookupColumns:E,wizardLookup:p,addActions:p.dynamicConditions.length>0,target:l,enableAddAction:!1,onUpdate:x=>{const T=mt(p);T.dynamicConditions.push(x),w(T),S(!1)},onActions:x=>{x==="delete"&&S(!1)}})]}),s.jsx(Ie,{children:s.jsx(ie,{children:"Rebuilds lookup when conditions change."})})]})]}),s.jsxs(R,{children:[s.jsx($,{variant:"contained",startIcon:s.jsx(nt,{}),onClick:()=>{g(b-1)},children:"Previous"}),s.jsx($,{variant:"contained",startIcon:s.jsx(nr,{}),onClick:()=>{p.value===""?C(!0):(c(n,p),C(!1),h(!0),g(b+1))},children:"Finish"})]})]})]})})]},M)})}),b===f.length&&s.jsxs(R,{sx:{marginTop:"20px"},children:["Lookup wizard successfully completed. Please save changes to enable.",s.jsx($,{onClick:()=>{d(!1),g(b+1)},children:"Close wizard"})]})]})},go=()=>{const[e,t]=a.useState(!1);return s.jsxs(ie,{component:"div",children:[s.jsx(R,{children:s.jsxs(kt,{sx:{textDecoration:"none",cursor:"pointer",display:"inline-flex","& svg":{fontSize:"1rem",marginRight:"2px"}},onClick:()=>t(!e),children:[s.jsx(jt,{}),"Known limitations with lookups"]})}),e&&s.jsxs(R,{sx:{marginTop:"20px",display:"grid",gap:"20px",ul:{listStyleType:"disc",paddingLeft:"40px"}},children:[s.jsx(R,{children:"Autocomplete is NOT available for lookups. It is automatically disabled."}),s.jsx(R,{children:"Some filter types require lookups to be loaded on startup. If lookups are not preloaded, the following filter types may not function correctly or will have limitations."}),s.jsx(R,{children:s.jsx("strong",{children:"With client-side processing enabled"})}),s.jsxs("ul",{children:[s.jsx("li",{children:"Lookups that are not preloaded will be excluded from the global filter"}),s.jsx("li",{children:"Drop-down lists will display lookup keys instead of lookup values"}),s.jsx("li",{children:"Multi-select drop-down lists will display lookup keys instead of lookup values"})]}),s.jsx(R,{children:s.jsx("strong",{children:"With server-side processing enabled"})}),s.jsxs("ul",{children:[s.jsx("li",{children:"Drop-down lists will be empty"}),s.jsx("li",{children:"Multi-select drop-down lists will be empty"}),s.jsx("li",{children:"Search panes will be empty"})]})]})]})},bo=({column:e,appId:t,columnIndex:n,databases:r,defaultDatabase:o,wpDatabase:i,target:l,setLookup:c})=>{var S,j;L.debug(e,t,n,r,o,i,l);const[d,u]=a.useState(!1),h=()=>{c(n,void 0),u(!1)},[f,b]=a.useState(!1);L.debug("wizardOn",f);const[g,p]=a.useState(!1),[m,y]=a.useState(!1);return s.jsxs(s.Fragment,{children:[e.lookup!==void 0&&!f?s.jsxs(R,{sx:{display:"grid",gridGap:"10px"},children:[s.jsx(ve,{fullWidth:!0,label:"Database",value:e.lookup.dbs,disabled:!0}),s.jsx(ve,{fullWidth:!0,label:"Table",value:e.lookup.tbl,disabled:!0}),s.jsx(ve,{fullWidth:!0,label:"Lookup column",value:e.lookup.key,disabled:!0}),s.jsx(ve,{fullWidth:!0,label:"Values shown in lookup",value:e.lookup.value.split(",").join(e.lookup.delimiter),disabled:!0}),s.jsx(ve,{fullWidth:!0,label:"Default where",value:e.lookup.defaultWhere,disabled:!0}),s.jsx(ve,{fullWidth:!0,multiline:!0,label:"Dynamic conditions",value:(j=(S=e.lookup)==null?void 0:S.dynamicConditions)==null?void 0:j.map(C=>C.lookupColumnName+" = "+C.tableColumnName).join(`
`),disabled:!0}),s.jsxs(R,{sx:{display:"grid",gridTemplateColumns:"1fr 1fr",alignItems:"center",gap:"10px"},children:[s.jsx($,{variant:"contained",fullWidth:!0,startIcon:s.jsx(rr,{}),onClick:()=>{u(!0)},children:"Delete"}),s.jsx($,{variant:"contained",fullWidth:!0,endIcon:s.jsx(Ae,{}),onClick:()=>{b(!0)},children:"Update"})]})]}):s.jsx(s.Fragment,{children:f?s.jsx(po,{column:e,appId:t,columnIndex:n,databases:r,defaultDatabase:o,wpDatabase:i,target:l,setLookup:c,enableWizard:b}):s.jsx($,{variant:"contained",fullWidth:!0,endIcon:s.jsx(Ae,{}),onClick:()=>{b(!0)},children:"Start lookup wizard"})}),s.jsxs(ie,{component:"div",sx:{marginTop:"30px"},children:[s.jsx(R,{children:s.jsxs(kt,{sx:{textDecoration:"none",cursor:"pointer",display:"inline-flex","& svg":{fontSize:"1rem",marginRight:"2px"}},onClick:()=>p(!g),children:[s.jsx(jt,{}),"What is a lookup?"]})}),g&&s.jsxs(R,{sx:{marginTop:"20px",marginBottom:"30px",display:"grid",gap:"20px"},children:[s.jsx(R,{children:"A lookup is a list of possible allowed values for a specific column. For a fixed number of values, this can be achieved using the enum data type."}),s.jsx(R,{children:"To create a lookup, start the lookup wizard and follow the instructions. A lookup must return a single unique column value."}),s.jsx(R,{children:"Lookups support single selections only. For multiple value selections, use the set data type."})]})]}),s.jsxs(ie,{component:"div",children:[s.jsx(R,{children:s.jsxs(kt,{sx:{textDecoration:"none",cursor:"pointer",display:"inline-flex","& svg":{fontSize:"1rem",marginRight:"2px"}},onClick:()=>y(!m),children:[s.jsx(jt,{}),"Example"]})}),m&&s.jsxs(R,{sx:{marginTop:"20px",display:"grid",marginBottom:"20px"},children:[s.jsxs(R,{children:["Consider table ",s.jsx("strong",{children:"products"})," containing a product type column. Available product types are stored in a table ",s.jsx("strong",{children:"product_types"}),".",s.jsxs("pre",{children:["create table product_types",s.jsx("br",{}),"(product_type varchar(10) NOT NULL",s.jsx("br",{}),",product_info varchar(255) NOT NULL",s.jsx("br",{}),",...",s.jsx("br",{}),",PRIMARY KEY (product_type)",s.jsx("br",{}),")",s.jsx("br",{}),s.jsx("br",{}),"create table products",s.jsx("br",{}),"(product_id int NOT NULL",s.jsx("br",{}),",product_type varchar(10) NOT NULL",s.jsx("br",{}),",...",s.jsx("br",{}),",PRIMARY KEY (product_id)",s.jsx("br",{}),",FOREIGN KEY (product_type)",s.jsx("br",{})," REFERENCES product_types(product_type)",s.jsx("br",{}),")"]})]}),s.jsxs(R,{children:["Start the lookup wizard",s.jsxs("ol",{style:{padding:"0 40px"},children:[s.jsx("li",{children:"Select your database"}),s.jsxs("li",{children:["Select lookup table ",s.jsx("strong",{children:"`product_types`"})]}),s.jsxs("li",{children:["Select lookup column ",s.jsx("strong",{children:"`product_type`"})]}),s.jsxs("li",{children:["Select ",s.jsx("strong",{children:"`product_info`"})," (or other(s))"]}),s.jsx("li",{children:"Add lookup conditions (if applicable)"})]})]}),s.jsxs(R,{children:["Notes",s.jsxs("ul",{style:{listStyle:"disc",padding:"0 40px"},children:[s.jsx("li",{children:"Step 4 allows you to add multiple lookup columns to the list. A column delimiter can be added between the selected columns. Columns added in step 4 are included in the search on the lookup table."}),s.jsxs("li",{children:["Additional lookup conditions are not necessary if you want to show all available lookup values. Use the ",s.jsx("strong",{children:"Default where"})," clause if you want to show a subset of the lookup values."]}),s.jsxs("li",{children:[s.jsx("strong",{children:"Dynamic conditions"})," can be used to make the list output depend on other form values. Use dynamic conditions to create cascading drop-down lists."]})]})]})]})]}),s.jsx(go,{}),d&&s.jsx(Er,{title:"Please confirm",message:"Are you sure you want to delete this lookup? This action cannot be undone once you click APPLY!",open:d,setOpen:u,onConfirm:()=>h()})]})},xo=e=>{const[t,n]=a.useState({databases:[],defaultDatabase:"",wpDatabase:""});return L.debug("databases",t),a.useEffect(()=>{hn(e)&&t.databases.length===0&&pr(e,r=>{const o=r==null?void 0:r.data;L.debug("response data",o);const i=[];let l="",c="";o.map(d=>{var u;L.debug(d),(d==null?void 0:d.dbs)!==void 0&&(i.push(d.dbs),((u=d==null?void 0:d.dbs_type)==null?void 0:u.toLocaleLowerCase())==="wp"&&(c=d.dbs,l=d.dbs))}),i.sort((d,u)=>d.localeCompare(u,void 0,{sensitivity:"base"})),n({databases:i,defaultDatabase:l,wpDatabase:c})},r=>{L.error("error",r)})},[e,t]),t},Jo=({appId:e,columnIndex:t,tableColumn:n,columnMetaData:r,setLookup:o})=>{var d;const i=xo(e),l=gn(e),c=()=>typeof n.inlineEditing=="boolean";return!hn(e)||r===null||n.computedField!==void 0||t===void 0||qt(r==null?void 0:r.data_type)!=="string"&&qt(r==null?void 0:r.data_type)!=="number"||(r==null?void 0:r.data_type)==="enum"||(r==null?void 0:r.data_type)==="set"?null:s.jsxs(xn,{disableGutters:!0,children:[s.jsxs(mn,{expandIcon:s.jsx(fn,{}),sx:{fontSize:"1rem","& .MuiAccordionSummary-content":{padding:"1rem",alignItems:"center"}},children:[s.jsx(dr,{}),s.jsx("span",{style:{paddingLeft:"0.5rem"},children:"Lookup"})]}),s.jsxs(vn,{sx:{marginTop:"10px"},children:[s.jsx(bo,{appId:e,column:n,columnIndex:t,databases:i.databases,defaultDatabase:i.defaultDatabase,wpDatabase:i.wpDatabase,target:ot.TABLE,setLookup:o}),c()&&n.lookup!==void 0&&s.jsx(R,{sx:{marginTop:"20px"},children:s.jsxs(Ie,{children:[s.jsx(bn,{control:s.jsx(Dr,{checked:((d=n.lookup)==null?void 0:d.loadOnStartup)||r.is_nullable==="NO"&&n.inlineEditing===!0,disabled:r.is_nullable==="NO"&&n.inlineEditing,onChange:(u,h)=>{const f=n.lookup;f!==void 0&&(o(t,{...f,loadOnStartup:h}),l(!0)),u.stopPropagation()}}),label:"Load full lookup table on startup",labelPlacement:"end"}),s.jsx(ie,{component:"div",sx:{"& ul":{margin:0,padding:"5px"}},children:s.jsxs("ul",{style:{listStyle:"disc",padding:"0 10px"},children:[s.jsx("li",{children:"Improves performance by loading lookup table into memory"}),s.jsx("li",{children:"When disabled, lookup values are cached instead"}),s.jsx("li",{children:"Automatically enabled when inline editing is on"}),s.jsxs("li",{children:["Disabling may affect global and column filters ",s.jsx("strong",{children:"(see limitations)"})]}),s.jsx("li",{children:"Restart your app after making changes"})]})})]})})]})]})},Qo=({columnMetaData:e,metaData:t})=>{const n=()=>String(e.column_type).toLocaleLowerCase().includes("text")?`(${e==null?void 0:e.character_maximum_length})`:"";return e===void 0?null:s.jsxs(xn,{disableGutters:!0,children:[s.jsxs(mn,{expandIcon:s.jsx(fn,{}),sx:{fontSize:"1rem","& .MuiAccordionSummary-content":{padding:"1rem",alignItems:"center"}},children:[s.jsx(ur,{}),s.jsx("span",{style:{paddingLeft:"0.5rem"},children:"Column metadata"})]}),s.jsxs(vn,{sx:{display:"grid"},children:[s.jsxs(R,{sx:{marginTop:"1rem",display:"grid",gridTemplateColumns:"auto auto",gap:"10px",justifyContent:"left",alignItems:"center"},children:[s.jsx("div",{children:"Column name"}),s.jsxs("div",{style:{display:"flex",gap:"10px"},children:[s.jsx("strong",{children:e.column_name}),t!=null&&t.primary_key&&Array.isArray(t==null?void 0:t.primary_key)&&(t!=null&&t.primary_key.includes(e.column_name))?s.jsx(mr,{}):s.jsx(s.Fragment,{})]}),s.jsx("div",{children:"Data type"}),s.jsx("div",{children:s.jsxs("strong",{children:[e.column_type,n()]})}),s.jsx("div",{children:"Is nullable"}),s.jsx("div",{children:s.jsx("strong",{children:e.is_nullable})}),s.jsx("div",{children:"Default value"}),s.jsx("div",{children:s.jsx("strong",{children:e.column_default==="NULL"?"null":e.column_default??"null"})}),e.extra!==""&&s.jsxs(s.Fragment,{children:[s.jsx("div",{}),s.jsx("div",{children:s.jsx("strong",{children:e.extra})})]})]}),s.jsx(Ie,{children:s.jsx(ie,{component:"div",children:"This is how the column is stored in the database."})})]})]})},Zo=(e,t)=>{t===void 0&&(t=lr.getSelectors().selectMetaDataById(Rt.getState().metaData,e));const n=a.useMemo(()=>{var o,i;const r={};if(Array.isArray(t==null?void 0:t.columns)&&((o=t==null?void 0:t.columns)==null?void 0:o.length)>0)for(let l=0;l<t.columns.length;l++)r[t.columns[l].column_name]=t.columns[l];if(Array.isArray(t==null?void 0:t.relation_columns)&&((i=t==null?void 0:t.relation_columns)==null?void 0:i.length)>0)for(let l=0;l<t.relation_columns.length;l++)r[Et.relationTablePrefix+t.relation_columns[l].column_name]=t.relation_columns[l];return r},[t]);return L.debug(n),n};export{Ys as D,qo as I,go as L,Nn as M,zt as P,Jo as S,On as T,Qo as a,ho as b,Ur as c,yt as d,Kr as e,eo as f,co as g,Vo as h,Zo as u};
