import{j as e}from"./cm-1.0.35--NMEhA6K.js";import{r as B}from"./redux-1.0.35-xa1uZ5t4.js";import{bE as Z,aT as G,aU as te,l as p,bV as D,bJ as Y,bI as z,a9 as J,aY as S,bK as L,bW as ee,p as N,b as he}from"./lib-1.0.35-vCbYWOI3.js";import{a as de}from"./RestApi-1.0.35-Bt-tzntO.js";import{u as ue}from"./useStoreTable-1.0.35-BoSxKhPI.js";import{v as W,k as _,f as xe,B as se}from"./cjs-1.0.35-B75n3jry.js";import{u as ce}from"./useTableUpdater-1.0.35-Du0YkN1k.js";import{c as re}from"./index-1.0.35-ChYeyr_I.js";import{A as O,a as U}from"./AccordionSummary-1.0.35-Do5lpUEE.js";import{A as R}from"./AccordionDetails-1.0.35-CUwNn0VM.js";import{B as v}from"./Spinner-1.0.35-Dd1TcgqP.js";import{F as d,a as t}from"./FormHelperText-1.0.35-BubqYRHL.js";import{R as K}from"./RadioGroup-1.0.35-en0YSLOf.js";import{F as h}from"./FormControlLabel-1.0.35-DFi_cuDq.js";import{R as P}from"./Radio-1.0.35-Hf47vRci.js";import{S as m}from"./Switch-1.0.35-Z50HBuFJ.js";import{L as Q}from"./Link-1.0.35-CxbvVS8_.js";import{C as V}from"./CssUnitTextField-1.0.35-Bg0goXyi.js";import{D as pe,U as je,S as me}from"./SettingsFormRelationships-1.0.35-DSu2avTx.js";import{T as $,S as oe}from"./TextField-1.0.35-B1uB0pL3.js";import{p as fe,q as ge}from"./index-1.0.35-DHBDMhlb.js";import{M as q}from"./MenuItem-1.0.35-DJ1Zxsyh.js";import{I as we}from"./iconBase-1.0.35-CEh1aNes.js";import{M as Ce}from"./Menu-1.0.35-3APgaaPr.js";import{u as ve}from"./useFormStore-1.0.35-TLrcUzfK.js";import{P as X}from"./PremiumFeature-1.0.35-BMopEtPl.js";import{A as ye}from"./AdminTheme-1.0.35-BtyHaBRh.js";import{T as ae,a as I}from"./ToggleButtonGroup-1.0.35-D2jgODVu.js";import"./notistack-1.0.35-C7EWtXAA.js";import{L as ke}from"./ListItem-1.0.35-wFs78pI9.js";import{C as Ee}from"./Autocomplete-1.0.35-DKAFaob_.js";import{T as ne}from"./Tooltip-1.0.35-DvHLxZ2q.js";import{F as ie}from"./FormLabel-1.0.35-DqGGwQsT.js";import"./vendor-1.0.35-CN03Eozo.js";import"./loglevel-1.0.35-BZ7XahX3.js";import"./lodash-1.0.35-CNe2eGU5.js";import"./moment-1.0.35-C5S46NFB.js";import"./Typography-1.0.35-DmbWmVEH.js";import"./useEnhancedEffect-1.0.35-gtlBTowv.js";import"./useControlled-1.0.35-Cu7qahuZ.js";import"./Collapse-1.0.35-EVtTATBO.js";import"./useFormControl-1.0.35-gKEqvAy-.js";import"./SwitchBase-1.0.35-BN1QoK5P.js";import"./createSvgIcon-1.0.35-C47rBL-a.js";import"./ComponentColumn-1.0.35-UdBdi3SL.js";import"./ActionsExplorer-1.0.35-frLqGKOk.js";import"./ActionsApp-1.0.35-BVk_SN7N.js";import"./Checkbox-1.0.35-DB1d6Tfc.js";import"./useFormUpdater-1.0.35-Cr_Tlk6T.js";import"./Stepper-1.0.35-B-Cu3w2D.js";import"./StepContent-1.0.35-D2uWS0po.js";import"./useTheme-1.0.35-DvysJ9Pk.js";import"./index-1.0.35-CCys4hnd.js";import"./ConfirmDialog-1.0.35-5-r3Xts8.js";import"./DialogContent-1.0.35-B5TpMgZC.js";import"./Close-1.0.35-D-owgKS4.js";import"./Popper-1.0.35-BZjTWtMm.js";const Te=({appId:o,tableSettings:s,metaData:r,updateTableSettings:u})=>{var k,A,b,F,H,M;const i=de(),n=ce(o),a=(C,T)=>{const l=re(s);l.largeTableSupport.saved=C,l.largeTableSupport.actual=T,p.debug(l),i(D({appId:o,tableSettings:l})),n(!0)},f=C=>{const T=re(s);T.clientSideProcessing=C,p.debug(T),i(D({appId:o,tableSettings:T})),n(!0)},[w,E]=B.useState(!1),[y,j]=B.useState(!1),g=((k=r==null?void 0:r.src)==null?void 0:k.dbs)??((b=(A=r==null?void 0:r.app)==null?void 0:A.container[0])==null?void 0:b.cnt_dbs)??"DATABASE",x=((F=r==null?void 0:r.src)==null?void 0:F.tbl)??((M=(H=r==null?void 0:r.app)==null?void 0:H.container[0])==null?void 0:M.cnt_tbl)??"TABLE";return e.jsxs(O,{disableGutters:!0,children:[e.jsx(U,{expandIcon:e.jsx(W,{}),children:"Performance"}),e.jsxs(R,{children:[e.jsxs("fieldset",{className:"pp-fieldset",children:[e.jsx("legend",{children:"Large Table Support"}),e.jsxs(v,{children:[e.jsx(d,{children:e.jsxs(K,{sx:{flexDirection:"column"},children:[e.jsx(h,{control:e.jsx(P,{checked:(s==null?void 0:s.largeTableSupport.saved)===G.DISABLED,onChange:C=>{a(G.DISABLED,Z.DISABLED),C.stopPropagation()}}),value:"disable",label:"Disable large table support"},"disable"),e.jsx(h,{control:e.jsx(P,{checked:(s==null?void 0:s.largeTableSupport.saved)===G.ENABLED,onChange:C=>{a(G.ENABLED,Z.ENABLED),C.stopPropagation()}}),value:"enable",label:"Enable large table support"},"enable"),e.jsx(h,{control:e.jsx(P,{checked:(s==null?void 0:s.largeTableSupport.saved)===G.AUTO,onChange:C=>{const T=te(r);a(G.AUTO,T),C.stopPropagation()}}),value:"auto",label:"Let the server decide (default)"},"auto")]})}),s.largeTableSupport.saved===G.ENABLED&&e.jsxs("fieldset",{className:"pp-fieldset",style:{marginTop:"20px",marginBottom:"40px"},children:[e.jsx("legend",{children:"Additional settings"}),e.jsxs(d,{fullWidth:!0,children:[e.jsx(h,{control:e.jsx(m,{checked:s.largeTableSupport.skipCount,onChange:(C,T)=>{u("largeTableSupport.skipCount",T),C.stopPropagation()}}),label:"Skip row count on filter updates"}),e.jsx(t,{children:"Skips all SQL count statements. Can boost performance for large tables dramatically. Results in a poorer user feedback."})]})]}),e.jsxs(t,{component:"div",sx:{marginLeft:"20px",marginTop:"20px","& ul":{margin:0,padding:"0 0 0 20px"}},children:[e.jsx(v,{children:e.jsxs(Q,{sx:{textDecoration:"none",cursor:"pointer",display:"inline-flex","& svg":{fontSize:"1rem",marginRight:"2px"}},onClick:()=>E(!w),children:[e.jsx(_,{}),"What does large table support do?"]})}),w&&e.jsxs("ul",{style:{marginTop:"20px",marginBottom:"30px",listStyle:"disc",padding:"0 40px"},children:[e.jsx("li",{children:"Enables row count estimation"}),e.jsx("li",{children:"Requires the user to press enter on search"}),e.jsx("li",{children:"Sets pagination to compact"}),e.jsx("li",{children:"Removes the last page pagination button"}),e.jsx("li",{children:"Reduces network traffic and server load"})]})]}),e.jsxs(t,{component:"div",sx:{marginLeft:"20px",marginBottom:"20px","& ul":{margin:0,padding:"0 0 0 20px"}},children:[e.jsx(v,{children:e.jsxs(Q,{sx:{textDecoration:"none",cursor:"pointer",display:"inline-flex","& svg":{fontSize:"1rem",marginRight:"2px"}},onClick:()=>j(!y),children:[e.jsx(_,{}),"Experiencing a slow initial table load? Follow stese steps to improve performance..."]})}),y&&e.jsxs("ol",{style:{marginTop:"20px",marginBottom:"30px",padding:"0 40px"},children:[e.jsxs("li",{children:["Start the ",e.jsx("strong",{children:"Query Builder"})]}),e.jsxs("li",{children:["Select database ",e.jsx("strong",{children:g})]}),e.jsxs("li",{children:["Enter ",e.jsxs("strong",{children:["ANALYZE TABLE ",x]})]}),e.jsx("li",{children:"Press the Execute button"})]})]}),e.jsx(t,{sx:{marginRight:"20px",fontWeight:"bold"},children:"Requires a page reload!"})]})]}),e.jsxs("fieldset",{className:"pp-fieldset",style:{marginTop:"20px"},children:[e.jsx("legend",{children:"Server-Side versus Client-Side Processing"}),e.jsxs(v,{children:[e.jsx(d,{children:e.jsxs(K,{sx:{flexDirection:"column"},children:[e.jsx(h,{control:e.jsx(P,{checked:(s==null?void 0:s.clientSideProcessing)!==!0,onChange:C=>{f(!1),C.stopPropagation()}}),value:"disable",label:"Server-Side Processing"},"disable"),e.jsx(h,{control:e.jsx(P,{checked:(s==null?void 0:s.clientSideProcessing)===!0,onChange:C=>{f(!0),C.stopPropagation()}}),value:"enable",label:"Client-Side Processing"},"enable")]})}),e.jsx(t,{sx:{margin:"15px 20px 20px 20px"},children:"Server-side processing enhances performance for medium to large tables. Client-side processing loads all rows upfront, optimizing performance for smaller tables."}),e.jsx(t,{sx:{marginRight:"20px",fontWeight:"bold"},children:"Requires a page reload!"})]})]})]})]})},Ae=({tableSettings:o,updateTableSettings:s})=>{var r,u;return e.jsxs(O,{disableGutters:!0,defaultExpanded:!1,children:[e.jsx(U,{expandIcon:e.jsx(W,{}),children:"Layout & Responsiveness"}),e.jsxs(R,{children:[e.jsxs("fieldset",{className:"pp-fieldset",children:[e.jsx("legend",{children:"Responsiveness"}),e.jsxs(d,{children:[e.jsxs(K,{sx:{flexDirection:"row"},children:[e.jsx(h,{control:e.jsx(P,{checked:((r=o==null?void 0:o.design)==null?void 0:r.overflow)===Y.RESPONSIVE,onChange:i=>{s("design.overflow",Y.RESPONSIVE),i.stopPropagation()}}),value:"responsive",label:"Auto column hiding"},"responsive"),e.jsx(h,{control:e.jsx(P,{checked:((u=o==null?void 0:o.design)==null?void 0:u.overflow)!==Y.RESPONSIVE,onChange:i=>{s("design.overflow",Y.SCROLL),i.stopPropagation()}}),value:"scroll",label:"Horizontal scrollbar"},"scroll")]}),e.jsx(t,{children:"Behaviour when table content overflows available space."})]})]}),e.jsxs("fieldset",{className:"pp-fieldset",style:{marginTop:"30px"},children:[e.jsx("legend",{children:"Density"}),e.jsxs(d,{children:[e.jsxs(K,{sx:{display:"grid",gridTemplateColumns:"auto auto auto",alignItems:"center"},children:[e.jsx(h,{control:e.jsx(P,{checked:(o==null?void 0:o.design.density.default)===z.COMPACT,onChange:i=>{s("design.density.default",z.COMPACT),i.stopPropagation()}}),value:"compact",label:"Compact"},"compact"),e.jsx(h,{control:e.jsx(P,{checked:(o==null?void 0:o.design.density.default)===z.COMFORTABLE,onChange:i=>{s("design.density.default",z.COMFORTABLE),i.stopPropagation()}}),value:"comfortable",label:"Comfortable"},"comfortable"),e.jsx(h,{control:e.jsx(P,{checked:(o==null?void 0:o.design.density.default)===z.SPACIOUS,onChange:i=>{s("design.density.default",z.SPACIOUS),i.stopPropagation()}}),value:"spacious",label:"Spacious"},"spacious")]}),e.jsx(t,{children:"Default density on page load."})]}),e.jsx(d,{fullWidth:!0,sx:{marginTop:"20px"},children:e.jsx(h,{control:e.jsx(m,{checked:o==null?void 0:o.design.density.userCanChange,onChange:(i,n)=>{s("design.density.userCanChange",n),i.stopPropagation()}}),label:"Allow user to change density"})})]}),e.jsxs("fieldset",{className:"pp-fieldset",style:{marginTop:"30px"},children:[e.jsx("legend",{children:"Table Header"}),e.jsxs(d,{fullWidth:!0,children:[e.jsx(h,{control:e.jsx(m,{checked:o.showHeader,onChange:(i,n)=>{s("showHeader",n),i.stopPropagation()}}),label:"Show table header"}),e.jsx(t,{children:"Show | hide table header."})]}),e.jsxs(d,{fullWidth:!0,sx:{marginTop:"20px"},children:[e.jsx(h,{control:e.jsx(m,{checked:o.stickyHeader,disabled:!o.showHeader,onChange:(i,n)=>{s("stickyHeader",n),i.stopPropagation()}}),label:"Enable sticky header"}),e.jsx(t,{children:"Keeps the table header visible while scrolling through the table."})]})]}),e.jsxs("fieldset",{className:"pp-fieldset",style:{marginTop:"30px"},children:[e.jsx("legend",{children:"Table Footer"}),e.jsxs(d,{fullWidth:!0,children:[e.jsx(h,{control:e.jsx(m,{checked:o.showFooter,onChange:(i,n)=>{s("showFooter",n),i.stopPropagation()}}),label:"Show table footer"}),e.jsx(t,{children:"Show | hide table footer."})]}),e.jsxs(d,{fullWidth:!0,children:[e.jsx(h,{control:e.jsx(m,{checked:o.stickyFooter,disabled:!o.showFooter,onChange:(i,n)=>{s("stickyFooter",n),i.stopPropagation()}}),label:"Enable sticky footer"}),e.jsx(t,{children:"Keeps the table footer visible while scrolling through the table."})]})]})]})]})},Pe=({hasPrimaryKey:o,tableSettings:s,metaData:r,updateTableSettings:u})=>{var a,f,w,E,y,j,g,x,k,A,b,F,H,M,C,T;p.debug(o,s,r);const[i,n]=B.useState(!1);return e.jsxs(O,{disableGutters:!0,children:[e.jsx(U,{expandIcon:e.jsx(W,{}),children:"Row actions"}),e.jsxs(R,{children:[e.jsxs(v,{sx:{display:"grid"},children:[e.jsxs(d,{children:[e.jsx(h,{control:e.jsx(m,{disabled:!((a=r==null?void 0:r.privs)!=null&&a.insert)||!o,checked:(f=s==null?void 0:s.transactions)==null?void 0:f.insert,onChange:(l,c)=>{u("transactions.insert",c),l.stopPropagation()}}),label:"Allow insert"}),e.jsx(t,{children:"Adds an insert button to the table toolbar."})]}),e.jsxs(d,{children:[e.jsx(h,{control:e.jsx(m,{checked:s==null?void 0:s.viewLink,onChange:(l,c)=>{u("viewLink",c),l.stopPropagation()}}),label:"Allow viewing"}),e.jsx(t,{children:"Adds a view icon to each row."})]}),e.jsxs(v,{sx:{display:"grid",gridTemplateColumns:"auto auto",alignItems:"center"},children:[e.jsx(d,{children:e.jsx(h,{control:e.jsx(m,{checked:s==null?void 0:s.detailLink,disabled:((w=s==null?void 0:s.design)==null?void 0:w.overflow)!==Y.RESPONSIVE,onChange:(l,c)=>{u("detailLink",c),l.stopPropagation()}}),label:"Allow detail panel viewing"})}),e.jsx(d,{children:e.jsx(h,{control:e.jsx(m,{checked:!1,disabled:!0,onChange:(l,c)=>{u("detailPdf",c),l.stopPropagation()}}),label:"Add PDF export icon"})})]}),e.jsx(d,{children:e.jsxs(t,{children:["Adds an expand icon to each row, allowing users to view columns in a detail panel. This feature only functions when responsiveness is set to auto column hiding.",e.jsx(e.Fragment,{children:"The PDF export is a premium feature."})]})}),e.jsxs(d,{children:[e.jsx(h,{control:e.jsx(m,{disabled:!((E=r==null?void 0:r.privs)!=null&&E.update)||!o,checked:(y=s==null?void 0:s.transactions)==null?void 0:y.update,onChange:(l,c)=>{u("transactions.update",c),l.stopPropagation()}}),label:"Allow update"}),e.jsx(t,{children:"Adds an update icon to each table row."})]}),e.jsxs(d,{children:[e.jsx(h,{control:e.jsx(m,{disabled:!((j=r==null?void 0:r.privs)!=null&&j.delete)||!o,checked:(g=s==null?void 0:s.transactions)==null?void 0:g.delete,onChange:(l,c)=>{u("transactions.delete",c),l.stopPropagation()}}),label:"Allow delete"}),e.jsx(t,{children:"Adds a delete icon to each table row."})]})]}),e.jsx(v,{sx:{marginTop:"20px"},children:e.jsxs(d,{children:[e.jsx(h,{control:e.jsx(m,{disabled:!((x=r==null?void 0:r.privs)!=null&&x.delete)||!o,checked:s==null?void 0:s.formModal,onChange:(l,c)=>{u("formModal",c),l.stopPropagation()}}),label:"Modal forms"}),(s==null?void 0:s.formModal)===!0&&e.jsxs(v,{sx:{margin:"20px 0",display:"grid",gridTemplateColumns:"auto auto",justifyContent:"space-between",alignItems:"center",gap:"10px"},children:[e.jsx(V,{label:"Min width",textField:{cssValue:((k=s==null?void 0:s.modal)==null?void 0:k.minWidth)??60,cssUnit:((A=s==null?void 0:s.modal)==null?void 0:A.minWidthUnit)??"vw"},defaultValue:{cssValue:60,cssUnit:"vw"},updateSettings:l=>{const c={...s==null?void 0:s.modal};c.minWidth=l.cssValue,c.minWidthUnit=l.cssUnit,u("modal",c),p.debug(l)}}),e.jsx(V,{label:"Max width",textField:{cssValue:((b=s==null?void 0:s.modal)==null?void 0:b.maxWidth)??80,cssUnit:((F=s==null?void 0:s.modal)==null?void 0:F.maxWidthUnit)??"vw"},defaultValue:{cssValue:80,cssUnit:"vw"},updateSettings:l=>{const c={...s==null?void 0:s.modal};c.maxWidth=l.cssValue,c.maxWidthUnit=l.cssUnit,u("modal",c),p.debug(l)}}),e.jsx(V,{label:"Min height",textField:{cssValue:((H=s==null?void 0:s.modal)==null?void 0:H.minHeight)??0,cssUnit:((M=s==null?void 0:s.modal)==null?void 0:M.minHeightUnit)??"vh"},defaultValue:{cssValue:0,cssUnit:"vh"},updateSettings:l=>{const c={...s==null?void 0:s.modal};c.minHeight=l.cssValue,c.minHeightUnit=l.cssUnit,u("modal",c),p.debug(l)}}),e.jsx(V,{label:"Max height",textField:{cssValue:((C=s==null?void 0:s.modal)==null?void 0:C.maxHeight)??95,cssUnit:((T=s==null?void 0:s.modal)==null?void 0:T.maxHeightUnit)??"vh"},defaultValue:{cssValue:95,cssUnit:"vh"},updateSettings:l=>{const c={...s==null?void 0:s.modal};c.maxHeight=l.cssValue,c.maxHeightUnit=l.cssUnit,u("modal",c),p.debug(l)}})]}),e.jsx(t,{children:'Opens data entry forms in a modal window (applies to "allow viewing" and "allow update").'})]})}),e.jsxs(t,{component:"div",sx:{marginTop:"30px"},children:[e.jsxs(Q,{sx:{textDecoration:"none",cursor:"pointer",display:"inline-flex","& svg":{fontSize:"1rem",marginRight:"2px"}},onClick:()=>n(!i),children:[e.jsx(_,{}),"What are row actions?"]}),i&&e.jsxs(v,{sx:{marginTop:"20px"},children:["Row actions enable users to perform specific actions on individual rows. The ",e.jsx("strong",{children:"view"})," action is always available. To perform transactions such as ",e.jsx("strong",{children:"insert"}),", ",e.jsx("strong",{children:"update"}),", and ",e.jsx("strong",{children:"delete"}),", the server requires a valid primary key. If these actions are not selectable, ensure that your table has a primary key defined. Note that transactions are not available for views."]})]})]})]})},Be=({appId:o,tableSettings:s,metaData:r,updateTableSettings:u})=>{var a,f,w,E,y,j;const[i,n]=B.useState(!1);return e.jsxs(O,{disableGutters:!0,children:[e.jsx(U,{expandIcon:e.jsx(W,{}),children:"Bulk actions"}),e.jsxs(R,{children:[e.jsxs(v,{sx:{display:"grid"},children:[e.jsx(d,{children:e.jsx(h,{control:e.jsx(m,{checked:!1,disabled:!0,onChange:(g,x)=>{g.stopPropagation()}}),label:"Export to PDF (premium feature)"})}),e.jsx(d,{children:e.jsx(h,{control:e.jsx(m,{checked:(a=s==null?void 0:s.bulkActions)==null?void 0:a.csv,onChange:(g,x)=>{u("bulkActions.csv",x),g.stopPropagation()}}),label:"Export to CSV"})}),e.jsx(d,{children:e.jsx(h,{control:e.jsx(m,{checked:(f=s==null?void 0:s.bulkActions)==null?void 0:f.json,onChange:(g,x)=>{u("bulkActions.json",x),g.stopPropagation()}}),label:"Export to JSON"})}),e.jsx(d,{children:e.jsx(h,{control:e.jsx(m,{checked:!1,disabled:!0,onChange:(g,x)=>{g.stopPropagation()}}),label:"Export to Excel (premium feature)"})}),e.jsx(d,{children:e.jsx(h,{control:e.jsx(m,{checked:(w=s==null?void 0:s.bulkActions)==null?void 0:w.xml,onChange:(g,x)=>{u("bulkActions.xml",x),g.stopPropagation()}}),label:"Export to XML"})}),e.jsx(d,{children:e.jsx(h,{control:e.jsx(m,{checked:!J(o)&&!S(r)&&((E=s==null?void 0:s.bulkActions)==null?void 0:E.sql),disabled:J(o)||S(r),onChange:(g,x)=>{J(o)||u("bulkActions.sql",x),g.stopPropagation()}}),label:"Export to SQL"})}),e.jsx(d,{children:e.jsx(h,{control:e.jsx(m,{checked:(y=s==null?void 0:s.bulkActions)==null?void 0:y.delete,disabled:!((j=r==null?void 0:r.privs)!=null&&j.delete),onChange:(g,x)=>{u("bulkActions.delete",x),g.stopPropagation()}}),label:"Delete"})}),e.jsx(d,{children:e.jsx(t,{children:"Added to BULK ACTIONS button."})})]}),e.jsxs(t,{component:"div",sx:{marginTop:"30px"},children:[e.jsxs(Q,{sx:{textDecoration:"none",cursor:"pointer",display:"inline-flex","& svg":{fontSize:"1rem",marginRight:"2px"}},onClick:()=>n(!i),children:[e.jsx(_,{}),"What are bulk actions?"]}),i&&e.jsx(v,{sx:{marginTop:"20px"},children:"Bulk actions allow users to perform tasks on multiple rows simultaneously. Enabling this feature requires selecting at least one bulk action. Once enabled, row selection is added to the table, and a bulk actions button is included in the toolbar."})]})]})]})},be=({tableSettings:o,updateTableSettings:s})=>e.jsxs(O,{disableGutters:!0,children:[e.jsx(U,{expandIcon:e.jsx(W,{}),children:"Default where"}),e.jsx(R,{children:e.jsxs(d,{fullWidth:!0,children:[e.jsx($,{value:o==null?void 0:o.defaultWhere,multiline:!0,fullWidth:!0,minRows:5,variant:"outlined",onClick:r=>{r.stopPropagation()},onChange:r=>{s("defaultWhere",r.target.value)}}),e.jsx(pe,{})]})})]}),le=({tableColumns:o,orderByColumn:s,addActions:r,enableAddAction:u,onUpdate:i,onActions:n})=>{p.debug(o,s,r,u);const[a,f]=B.useState(null),w=!!a,E=j=>{f(j.currentTarget),j.stopPropagation()},y=()=>{f(null)};return e.jsxs(v,{sx:{display:"grid",gridTemplateColumns:r?"auto 100px 50px":"auto 100px",gridGap:"5px",marginBottom:"5px"},children:[e.jsxs(oe,{MenuProps:{id:"pp-select-menu"},value:s.columnName,onChange:j=>{i({...s,columnName:j.target.value})},children:[e.jsx(q,{value:"",children:" "}),...o.map(j=>j.computedField!==void 0?null:e.jsx(q,{value:j.columnName,children:j.columnName}))]}),e.jsxs(oe,{MenuProps:{id:"pp-select-menu"},value:s.order,onChange:j=>{i({...s,order:j.target.value==="desc"?"desc":"asc"})},children:[e.jsx(q,{value:"asc",children:"Asc"}),e.jsx(q,{value:"desc",children:"Desc"})]}),r&&e.jsxs(e.Fragment,{children:[e.jsx(we,{color:"primary",onClick:E,children:e.jsx(xe,{})}),e.jsxs(Ce,{anchorEl:a,open:w,onClose:y,sx:{zIndex:9999999999},anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},children:[u&&e.jsxs(q,{onClick:()=>{n("add"),y()},children:[e.jsx(fe,{}),e.jsx("span",{style:{marginLeft:"10px"},children:"Add column"})]}),e.jsxs(q,{onClick:()=>{n("delete"),y()},children:[e.jsx(ge,{}),e.jsx("span",{style:{marginLeft:"10px"},children:"Delete column"})]})]})]})]})},Fe=({tableSettings:o,tableColumns:s,updateTableSettings:r})=>{const[u,i]=B.useState(o.defaultOrderBy.length===0);return e.jsxs(O,{disableGutters:!0,children:[e.jsx(U,{expandIcon:e.jsx(W,{}),children:"Default order by"}),e.jsxs(R,{children:[Array.isArray(o.defaultOrderBy)&&e.jsxs(e.Fragment,{children:[...o.defaultOrderBy.map((n,a)=>e.jsx(le,{tableColumns:s,orderByColumn:o.defaultOrderBy[a],addActions:!0,enableAddAction:o.defaultOrderBy.length===a+1&&!u,onUpdate:f=>{const w=[...o.defaultOrderBy];w[a]=f,r("defaultOrderBy",w)},onActions:f=>{if(f==="add")i(!0);else if(f==="delete"){const w=[...o.defaultOrderBy];w.splice(a,1),r("defaultOrderBy",w),i(w.length===0)}}},a))]}),u&&e.jsx(le,{tableColumns:s,orderByColumn:{columnName:"",order:"asc"},addActions:o.defaultOrderBy.length>0,enableAddAction:!1,onUpdate:n=>{const a=[...o.defaultOrderBy];a.push({columnName:n.columnName,order:n.order}),r("defaultOrderBy",a),i(!1)},onActions:n=>{n==="delete"&&i(!1)}}),e.jsx(d,{fullWidth:!0,children:e.jsx(t,{children:"Defines the default ordering. The user can change the default ordering if sorting is enabled for one or more columns."})})]})]})},Le=({tableStore:o,updateTableSettings:s})=>{var E,y,j,g,x,k,A,b,F,H,M,C,T;const r=o.table,i=o.state.masterDetailConditions!==void 0,[n,a]=B.useState(!1),[f,w]=B.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs(O,{disableGutters:!0,defaultExpanded:!1,children:[e.jsx(U,{expandIcon:e.jsx(W,{}),children:"Global filter"}),e.jsxs(R,{children:[e.jsxs(v,{children:[e.jsxs(d,{fullWidth:!0,children:[e.jsx(h,{control:e.jsx(m,{checked:(E=r==null?void 0:r.searchSettings)==null?void 0:E.enableGlobalSearch,disabled:!0,onChange:(l,c)=>{p.debug(c),l.stopPropagation()}}),label:"Enable global filter"}),e.jsx(t,{children:"Adds a search box to the table header."})]}),e.jsxs(d,{fullWidth:!0,children:[e.jsx(h,{control:e.jsx(m,{checked:(y=r==null?void 0:r.searchSettings)==null?void 0:y.forceSearch,disabled:!0,onChange:(l,c)=>{p.debug(c),l.stopPropagation()}}),label:"Show empty table on startup"}),e.jsx(t,{children:"Forces user to perform a search on page load."})]}),e.jsxs(d,{fullWidth:!0,children:[e.jsx(h,{control:e.jsx(m,{checked:(j=r==null?void 0:r.searchSettings)==null?void 0:j.highlightMatches,disabled:!0,onChange:(l,c)=>{p.debug(c),l.stopPropagation()}}),label:"Highlight matches"}),e.jsx(t,{children:"Filter match highlighting."})]})]}),e.jsxs(t,{component:"div",sx:{marginTop:"30px"},children:[e.jsxs(Q,{sx:{textDecoration:"none",cursor:"pointer",display:"inline-flex","& svg":{fontSize:"1rem",marginRight:"2px"}},onClick:()=>a(!n),children:[e.jsx(_,{}),"What is a global filter?"]}),n&&e.jsx(v,{sx:{marginTop:"20px"},children:"The global filter enables users to perform wildcard searches across all searchable columns. It can be disabled entirely or selectively for specific columns. To disable the global filter for specific columns, navigate to the Table Builder's columns menu and deselect the searchable option."})]}),e.jsx(X,{single:!1})]})]}),e.jsxs(O,{disableGutters:!0,defaultExpanded:!1,children:[e.jsx(U,{expandIcon:e.jsx(W,{}),children:"Column filters"}),e.jsxs(R,{children:[e.jsxs(d,{fullWidth:!0,children:[e.jsx(h,{control:e.jsx(m,{checked:(g=r==null?void 0:r.searchSettings)==null?void 0:g.searchForm,disabled:!0,onChange:(l,c)=>{p.debug(c),l.stopPropagation()}}),label:"Enable column filters"}),e.jsx(t,{children:"Disable to hide all column filters."})]}),((x=r==null?void 0:r.searchSettings)==null?void 0:x.searchForm)===!0&&e.jsxs(e.Fragment,{children:[e.jsxs(d,{fullWidth:!0,children:[e.jsx(h,{control:e.jsx(m,{checked:((k=r==null?void 0:r.searchSettings)==null?void 0:k.searchFormAlwaysOpen)||((A=r==null?void 0:r.searchSettings)==null?void 0:A.forceInline),disabled:!0,onChange:(l,c)=>{p.debug(c),l.stopPropagation()}}),label:"Show column filters on startup"}),e.jsx(t,{children:"Effective after next page load."})]}),e.jsxs(d,{fullWidth:!0,children:[e.jsx(h,{control:e.jsx(m,{checked:(b=r==null?void 0:r.searchSettings)==null?void 0:b.searchFormAlwaysOpen,disabled:!0,onChange:(l,c)=>{p.debug(c),l.stopPropagation()}}),label:"Always show column filters"}),e.jsx(t,{children:"Disables the user's possibility to toggle column filtering."})]}),e.jsxs(d,{fullWidth:!0,children:[e.jsx(h,{control:e.jsx(m,{checked:(F=r==null?void 0:r.searchSettings)==null?void 0:F.cascade,disabled:!0,onChange:(l,c)=>{p.debug(c),l.stopPropagation()}}),label:"Cascade drop-down lists"}),e.jsxs(t,{children:["Automatically updates drop-down lists when search criteria change. This feature is enabled by default with ",e.jsx("strong",{children:"client-side processing"}),".",((H=r==null?void 0:r.searchSettings)==null?void 0:H.cascade)===!0&&e.jsx(e.Fragment,{children:e.jsxs("span",{style:{color:((C=(M=ye)==null?void 0:M.palette)==null?void 0:C.error.main)??"red"},children:[" When ",e.jsx("strong",{children:"server-side processing"})," is used, cascade drop-down lists may negatively impact performance, increase server load, and generate additional network traffic. "]})})]})]}),e.jsx(v,{sx:{marginTop:"20px"},children:e.jsxs(d,{fullWidth:!0,children:[e.jsxs(ae,{fullWidth:!0,color:"primary",exclusive:!0,value:i?L.HEADER:(T=r==null?void 0:r.searchSettings)==null?void 0:T.searchFormPosition,onChange:(l,c)=>{l.stopPropagation()},children:[e.jsx(I,{value:L.TOP,disabled:i,children:"Above"},L.TOP),e.jsx(I,{value:L.RIGHT,disabled:i,children:"Right"},L.RIGHT),e.jsx(I,{value:L.BOTTOM,disabled:i,children:"Below"},L.BOTTOM),e.jsx(I,{value:L.LEFT,disabled:i,children:"Left"},L.LEFT),e.jsx(I,{value:L.HEADER,children:"Header"},L.HEADER)]}),e.jsx(t,{children:"Position of the column filters relative to the data table."})]})}),e.jsxs(v,{sx:{marginTop:"30px","& .MuiFormControl-root":{width:"100%"}},children:[e.jsx(V,{label:"Column filters width",textField:{cssValue:r==null?void 0:r.searchSettings.searchFormWidth,cssUnit:r==null?void 0:r.searchSettings.searchFormWidthUnit},defaultValue:{cssValue:ee.searchFormWidth,cssUnit:ee.searchFormWidthUnit},updateSettings:l=>{p.debug(l)}}),e.jsx(d,{children:e.jsx(t,{children:"Exact filter width if column filters position is LEFT or RIGHT. Minimum filter width if column filters position is ABOVE or BELOW. Does not affect column filters width in HEADER."})})]})]}),e.jsxs(t,{component:"div",sx:{marginTop:"30px"},children:[e.jsxs(Q,{sx:{textDecoration:"none",cursor:"pointer",display:"inline-flex","& svg":{fontSize:"1rem",marginRight:"2px"}},onClick:()=>w(!f),children:[e.jsx(_,{}),"What are column filters?"]}),f&&e.jsx(v,{sx:{marginTop:"20px"},children:"Column filters empower users to search within specific columns. You can activate these filters from the Table Builder's columns menu. Click on a column, open column actions, enable column filtering, and choose your preferred filter type."})]}),e.jsx(X,{single:!1})]})]})]})},We=({tableSettings:o,updateTableSettings:s})=>{const[r,u]=B.useState(void 0),i=n=>()=>{const a=o.pagination.rowsPerPage.filter(f=>f!==n);s("pagination.rowsPerPage",a)};return e.jsxs(O,{disableGutters:!0,children:[e.jsx(U,{expandIcon:e.jsx(W,{}),children:"Pagination"}),e.jsxs(R,{children:[e.jsxs(d,{fullWidth:!0,sx:{marginBottom:"30px"},children:[e.jsxs(ae,{fullWidth:!0,color:"primary",exclusive:!0,value:o.pagination.position,onChange:(n,a)=>{a!==null&&s("pagination.position",a)},children:[e.jsx(I,{value:"bottom",children:"bottom"}),e.jsx(I,{value:"top",children:"top"}),e.jsx(I,{value:"both",children:"both"})]}),e.jsx(t,{children:"Pagination position."})]}),e.jsx($,{fullWidth:!0,type:"number",label:"Default page size",value:o.pagination.defaultPageSize,disabled:!0,onChange:n=>{p.debug(n)},sx:{marginBottom:"30px"},helperText:"Effective after next table load."}),e.jsxs("fieldset",{className:"pp-fieldset",style:{margin:0,marginBottom:"30px"},children:[e.jsx(d,{sx:{marginBottom:"10px"},children:e.jsx(t,{children:"Rows per page"})}),e.jsx(v,{sx:{width:"100%",display:"grid",gridTemplateColumns:"repeat(4, 25%)",justifyContent:"center",alignItems:"center",margin:0,padding:0,"& li":{margin:"0 10px 10px 10px",padding:0},"& li .MuiChip-label":{width:"40px",textAlign:"right",overflow:"visible"}},component:"ul",children:o.pagination.rowsPerPage.map((n,a)=>e.jsx(ke,{children:e.jsx(Ee,{disabled:!0,label:n,onDelete:i(n)})},a))}),e.jsx(d,{fullWidth:!0,children:e.jsx(t,{children:"Click the delete icon to remove a value or add a new values below."})}),e.jsxs(v,{sx:{margin:"30px 10px 10px 10px",display:"grid",gridTemplateColumns:"1fr auto auto",justifyContent:"space-between",gap:"5px"},children:[e.jsx($,{type:"number",label:"New value",value:r??"",disabled:!0,onChange:n=>{p.debug(n)},sx:{"& input":{padding:"7px"}}}),e.jsx(ne,{title:"Add new value to list",children:e.jsx("span",{children:e.jsx(se,{color:"primary",variant:"contained",disabled:!0,onClick:()=>{},sx:{height:"100%"},children:"Add"})})}),e.jsx(ne,{title:"Reset to default values",children:e.jsx("span",{children:e.jsx(se,{color:"primary",variant:"outlined",disabled:!0,onClick:()=>{},sx:{height:"100%"},children:"Reset"})})})]})]}),e.jsx(d,{fullWidth:!0,children:e.jsx(h,{control:e.jsx(m,{disabled:!0,checked:o.pagination.showFirstButton,onChange:(n,a)=>{p.debug(n,a)}}),label:"Show first button"})}),e.jsxs(d,{fullWidth:!0,children:[e.jsx(h,{control:e.jsx(m,{disabled:!0,checked:o.pagination.showLastButton&&(o.largeTableSupport.actual===Z.DISABLED||o.largeTableSupport.skipCount===!1),onChange:(n,a)=>{p.debug(n,a)}}),label:"Show last button"}),e.jsx(t,{children:"By default disabled with large table support and row count skipping."})]}),e.jsxs(d,{fullWidth:!0,children:[e.jsx(h,{control:e.jsx(m,{disabled:!0,checked:o.pagination.showCompactButtons||o.largeTableSupport.actual===Z.ENABLED,onChange:(n,a)=>{p.debug(n,a)}}),label:"Show compact buttons"}),e.jsx(t,{children:"By default enabled when large table support is enabled."})]}),e.jsx(X,{single:!1})]})]})},Oe=({tableSettings:o,tableColumns:s,metaData:r,updateTableSettings:u})=>{var i;return!((i=r==null?void 0:r.privs)!=null&&i.update)||r.primary_key.length===0||(s==null?void 0:s.filter(n=>n.inlineEditing===!0).length)===0?null:e.jsxs(O,{defaultExpanded:!1,disableGutters:!0,children:[e.jsx(U,{expandIcon:e.jsx(W,{}),children:"Inline editing settings"}),e.jsxs(R,{sx:{display:"grid"},children:[e.jsxs("fieldset",{className:"pp-fieldset",style:{marginBottom:"30px"},children:[e.jsx("legend",{children:"Save behavior"}),e.jsxs(K,{sx:{display:"grid",justifyContent:"start",alignItems:"center"},children:[e.jsxs(ie,{sx:{cursor:"pointer",whiteSpace:"nowrap"},children:[e.jsx(P,{checked:o.inlineEditing.addColumnButton===!0,onChange:n=>{u("inlineEditing.addColumnButton",!0),n.stopPropagation()}}),"Add inline icon buttons to columns"]}),e.jsxs(ie,{sx:{cursor:"pointer",whiteSpace:"nowrap"},children:[e.jsx(P,{checked:o.inlineEditing.addColumnButton!==!0,onChange:n=>{u("inlineEditing.addColumnButton",!1),n.stopPropagation()}}),"Add save button to table header"]})]})]}),e.jsxs(d,{children:[e.jsxs(v,{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"8px",marginBottom:"10px"},children:[e.jsx(V,{label:"Padding top",textField:{cssValue:o.inlineEditing.spacing.fieldTop,cssUnit:o.inlineEditing.spacing.fieldTopUnit},defaultValue:{cssValue:N.table.inlineEditing.spacing.fieldTop,cssUnit:N.table.inlineEditing.spacing.fieldTopUnit},updateSettings:n=>{p.debug(n)}}),e.jsx(V,{label:"Padding bottom",textField:{cssValue:o.inlineEditing.spacing.fieldBottom,cssUnit:o.inlineEditing.spacing.fieldBottomUnit},defaultValue:{cssValue:N.table.inlineEditing.spacing.fieldBottom,cssUnit:N.table.inlineEditing.spacing.fieldBottomUnit},updateSettings:n=>{p.debug(n)}}),e.jsx(V,{label:"Padding left",textField:{cssValue:o.inlineEditing.spacing.fieldLeft,cssUnit:o.inlineEditing.spacing.fieldLeftUnit},defaultValue:{cssValue:N.table.inlineEditing.spacing.fieldLeft,cssUnit:N.table.inlineEditing.spacing.fieldLeftUnit},updateSettings:n=>{p.debug(n)}}),e.jsx(V,{label:"Padding right",textField:{cssValue:o.inlineEditing.spacing.fieldRight,cssUnit:o.inlineEditing.spacing.fieldRightUnit},defaultValue:{cssValue:N.table.inlineEditing.spacing.fieldRight,cssUnit:N.table.inlineEditing.spacing.fieldRightUnit},updateSettings:n=>{p.debug(n)}})]}),e.jsx(t,{children:"Space added to inline fields."})]}),e.jsx(X,{single:!1})]})]})},Ue=({tableSettings:o,updateTableSettings:s})=>e.jsxs(O,{disableGutters:!0,children:[e.jsx(U,{expandIcon:e.jsx(W,{}),children:"Column actions"}),e.jsxs(R,{children:[e.jsxs(d,{fullWidth:!0,children:[e.jsx(h,{control:e.jsx(m,{checked:!1,disabled:!0,onChange:(r,u)=>{s("enableColumnHiding",u),r.stopPropagation()}}),label:"Enable column hiding"}),e.jsx(t,{children:"Allow user to show | hide columns."})]}),e.jsxs(d,{fullWidth:!0,sx:{marginTop:"20px"},children:[e.jsx(h,{control:e.jsx(m,{checked:!1,disabled:!0,onChange:(r,u)=>{s("enableColumnOrdering",u),r.stopPropagation()}}),label:"Enable column ordering"}),e.jsx(t,{children:"Allow user to change column order."}),e.jsx("br",{}),e.jsxs(t,{children:[e.jsx("strong",{children:"IMPORTANT"})," Column order changes made in the Table Builder are not applied when column ordering is enabled. A table reload is required to reflect the updates."]})]}),e.jsx(X,{})]})]}),Ms=({appId:o,metaData:s})=>{p.debug(o);const r=de(),u=ce(o),i=ue(o),n=i==null?void 0:i.table,a=i==null?void 0:i.columns,f=ve(o),w=B.useMemo(()=>a.filter(x=>x.computedField!==void 0),[a]);p.debug("storeColumnSettings",w);const E=B.useMemo(()=>{const x=a.map(k=>k.columnName);return p.debug(x),s.primary_key.length>0&&s.primary_key.filter(k=>x.includes(k)).length===s.primary_key.length},[a,s.primary_key]);p.debug("hasPrimaryKey",E);const y=(x,k,A)=>{const[b,...F]=k.split(".");return{...x,[b]:F.length?y(x[b],F.join("."),A):A}},j=(x,k)=>{p.debug(x,k);const A=y(n,x,k);p.debug(A),r(D({appId:o,tableSettings:A})),u(!0)},g=je(o);return B.useEffect(()=>{var x;(f.state.details===void 0||((x=f.state.details)==null?void 0:x.length)===0)&&J(o)&&g(s,()=>{p.error("Error updating detail containers from Table Builder"),p.error(he.contactSupport)})},[o]),e.jsxs(e.Fragment,{children:[e.jsx(Te,{appId:o,tableSettings:n,metaData:s,updateTableSettings:j}),e.jsx(me,{appId:o,updateSettings:()=>{u(!0)}}),e.jsx(Le,{tableStore:i,updateTableSettings:j}),e.jsx(Be,{appId:o,tableSettings:n,metaData:s,updateTableSettings:j}),e.jsx(Pe,{hasPrimaryKey:E,tableSettings:n,metaData:s,updateTableSettings:j}),e.jsx(Ue,{tableSettings:n,updateTableSettings:j}),J(o)&&e.jsxs(e.Fragment,{children:[e.jsx(be,{tableSettings:n,updateTableSettings:j}),e.jsx(Fe,{tableSettings:n,tableColumns:a,updateTableSettings:j})]}),e.jsx(We,{tableSettings:n,updateTableSettings:j}),e.jsx(Ae,{tableSettings:n,updateTableSettings:j}),e.jsx(Oe,{tableSettings:n,updateTableSettings:j,tableColumns:a,metaData:s})]})};export{Ms as default};
